<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://harriswilde.github.io</id>
    <title>TechZone</title>
    <updated>2020-02-17T09:00:52.300Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://harriswilde.github.io"/>
    <link rel="self" href="https://harriswilde.github.io/atom.xml"/>
    <subtitle>HarrisWildeç¥è¯¸å›å…ƒæ—¦å¿«ä¹ğŸ‰</subtitle>
    <logo>https://harriswilde.github.io/images/avatar.png</logo>
    <icon>https://harriswilde.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, TechZone</rights>
    <entry>
        <title type="html"><![CDATA[å¤±ä¼ çš„ç»“æ„ä½“æ‰“åŒ…è‰ºæœ¯]]></title>
        <id>https://harriswilde.github.io/post/qb0i5L7tn/</id>
        <link href="https://harriswilde.github.io/post/qb0i5L7tn/">
        </link>
        <updated>2020-02-17T08:38:35.000Z</updated>
        <summary type="html"><![CDATA[<p>ã€Šå¤±ä¼ çš„ç»“æ„ä½“æ‰“åŒ…è‰ºæœ¯ã€‹(ä¸­æ–‡ç‰ˆ)<br>
è½¬è½½è‡ªï¼š<a href="https://github.com/ludx/The-Lost-Art-of-C-Structure-Packing">https://github.com/ludx/The-Lost-Art-of-C-Structure-Packing</a><br>
ä½œè€…ï¼šEric S. Raymond<br>
åŸæ–‡é“¾æ¥ï¼š<a href="http://www.catb.org/esr/structure-packing/">http://www.catb.org/esr/structure-packing/</a></p>
]]></summary>
        <content type="html"><![CDATA[<p>ã€Šå¤±ä¼ çš„ç»“æ„ä½“æ‰“åŒ…è‰ºæœ¯ã€‹(ä¸­æ–‡ç‰ˆ)<br>
è½¬è½½è‡ªï¼š<a href="https://github.com/ludx/The-Lost-Art-of-C-Structure-Packing">https://github.com/ludx/The-Lost-Art-of-C-Structure-Packing</a><br>
ä½œè€…ï¼šEric S. Raymond<br>
åŸæ–‡é“¾æ¥ï¼š<a href="http://www.catb.org/esr/structure-packing/">http://www.catb.org/esr/structure-packing/</a></p>
<!-- more -->
<h1 id="è°åº”é˜…è¯»æœ¬æ–‡">è°åº”é˜…è¯»æœ¬æ–‡</h1>
<p>æœ¬æ–‡æ¢è®¨å¦‚ä½•é€šè¿‡æ‰‹å·¥é‡æ–°æ‰“åŒ…Cç»“æ„ä½“å£°æ˜ï¼Œæ¥å‡å°å†…å­˜ç©ºé—´å ç”¨ã€‚ä½ éœ€è¦æŒæ¡åŸºæœ¬çš„Cè¯­è¨€çŸ¥è¯†ï¼Œä»¥ç†è§£æœ¬æ–‡æ‰€è®²è¿°çš„å†…å®¹ã€‚</p>
<p>å¦‚æœä½ åœ¨å†…å­˜å®¹é‡å—é™çš„åµŒå…¥å¼ç³»ç»Ÿä¸­å†™ç¨‹åºï¼Œæˆ–è€…ç¼–å†™æ“ä½œç³»ç»Ÿå†…æ ¸ä»£ç ï¼Œå°±æœ‰å¿…è¦äº†è§£è¿™é¡¹æŠ€æœ¯ã€‚å¦‚æœæ•°æ®é›†å·¨å¤§ï¼Œåº”ç”¨æ—¶å¸¸é€¼è¿‘å†…å­˜æé™ï¼Œè¿™é¡¹æŠ€æœ¯ä¼šæœ‰æ‰€å¸®åŠ©ã€‚å€˜è‹¥ä½ éå¸¸éå¸¸å…³å¿ƒå¦‚ä½•æœ€å¤§é™åº¦åœ°å‡å°‘å¤„ç†å™¨ç¼“å­˜æ®µï¼ˆcache-lineï¼‰æœªå‘½ä¸­æƒ…å†µçš„å‘ç”Ÿï¼Œè¿™é¡¹æŠ€æœ¯ä¹Ÿæœ‰æ‰€è£¨ç›Šã€‚</p>
<p>æœ€åï¼Œç†è§£è¿™é¡¹æŠ€æœ¯æ˜¯é€šå¾€å…¶ä»–Cè¯­è¨€è‰°æ·±è¯é¢˜çš„é—¨å¾„ã€‚è‹¥ä¸æŒæ¡ï¼Œå°±ç®—ä¸ä¸Šé«˜çº§Cç¨‹åºå‘˜ã€‚å½“ä½ è‡ªå·±ä¹Ÿèƒ½å†™å‡ºè¿™æ ·çš„æ–‡æ¡£ï¼Œå¹¶ä¸”æœ‰èƒ½åŠ›æ˜æ™ºåœ°è¯„ä»·å®ƒä¹‹åï¼Œæ‰ç§°å¾—ä¸ŠCè¯­è¨€å¤§å¸ˆã€‚</p>
<h1 id="ç¼˜ä½•å†™ä½œæœ¬æ–‡">ç¼˜ä½•å†™ä½œæœ¬æ–‡</h1>
<p>2013å¹´åº•ï¼Œæˆ‘å¤§é‡åº”ç”¨äº†ä¸€é¡¹Cè¯­è¨€ä¼˜åŒ–æŠ€æœ¯ï¼Œè¿™é¡¹æŠ€æœ¯æ˜¯æˆ‘æ—©åœ¨äºŒåä½™å¹´å‰å°±å·²æŒæ¡çš„ï¼Œä½†å½¼æ—¶ä¹‹åï¼Œé²œæœ‰ä½¿ç”¨ã€‚</p>
<p>æˆ‘éœ€è¦å‡å°‘ä¸€ä¸ªç¨‹åºå¯¹å†…å­˜ç©ºé—´çš„å ç”¨ï¼Œå®ƒä½¿ç”¨äº†ä¸Šåƒï¼ˆæœ‰æ—¶ç”šè‡³å‡ åä¸‡ï¼‰Cç»“æ„ä½“å®ä¾‹ã€‚è¿™ä¸ªç¨‹åºæ˜¯cvs-fast-exportï¼Œåœ¨å°†å…¶åº”ç”¨äºå¤§è§„æ¨¡è½¯ä»¶ä»“åº“æ—¶ï¼Œç¨‹åºä¼šå‡ºç°å†…å­˜è€—å°½é”™è¯¯ã€‚</p>
<p>é€šè¿‡ç²¾å¿ƒè°ƒæ•´ç»“æ„æˆä½“å‘˜çš„é¡ºåºï¼Œå¯ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹å¤§å¹…å‡å°‘å†…å­˜å ç”¨ã€‚å…¶æ•ˆæœæ˜¾è‘—â€”â€”åœ¨ä¸Šè¿°æ¡ˆä¾‹ä¸­ï¼Œå¯ä»¥å‡å°‘40%çš„å†…å­˜ç©ºé—´ã€‚ç¨‹åºåº”ç”¨äºæ›´å¤§çš„è½¯ä»¶ä»“åº“ï¼Œä¹Ÿä¸ä¼šå› å†…å­˜è€—å°½è€Œå´©æºƒã€‚</p>
<p>ä½†éšç€å·¥ä½œå±•å¼€ï¼Œæˆ‘æ„è¯†åˆ°è¿™é¡¹æŠ€æœ¯åœ¨è¿‘äº›å¹´å‡ ä¹å·²è¢«é—å¿˜ã€‚Webæœç´¢è¯å®äº†æˆ‘çš„æƒ³æ³•ï¼Œç°ä»Šçš„Cç¨‹åºå‘˜ä»¬ä¼¼ä¹å·²ä¸å†è°ˆè®ºè¿™äº›è¯é¢˜ï¼Œè‡³å°‘ä»æœç´¢å¼•æ“ä¸­çœ‹ä¸åˆ°ã€‚ç»´åŸºç™¾ç§‘æœ‰äº›æ¡ç›®æ¶‰åŠè¿™ä¸€ä¸»é¢˜ï¼Œä½†æœªæ›¾æœ‰äººå®Œæ•´é˜è¿°ã€‚</p>
<p>äº‹å‡ºæœ‰å› ã€‚è®¡ç®—æœºç§‘å­¦è¯¾ç¨‹ï¼ˆæ­£ç¡®åœ°ï¼‰å¼•å¯¼äººä»¬è¿œç¦»å¾®è§‚ä¼˜åŒ–ï¼Œè½¬è€Œå¯»æ±‚æ›´ç†æƒ³çš„ç®—æ³•ã€‚è®¡ç®—æˆæœ¬ä¸€è·¯èµ°ä½ï¼Œä»¤å‹æ¦¨å†…å­˜çš„å¿…è¦æ€§å˜å¾—è¶Šæ¥è¶Šä½ã€‚æ—§æ—¥é‡Œï¼Œé»‘å®¢ä»¬é€šè¿‡åœ¨é™Œç”Ÿçš„ç¡¬ä»¶æ¶æ„ä¸­è·Œè·Œæ’æ’å­¦ä¹ â€”â€”å¦‚ä»Šå·²ä¸å¤šè§ã€‚</p>
<p>ç„¶è€Œè¿™é¡¹æŠ€æœ¯åœ¨å…³é”®æ—¶åˆ»ä»é¢‡å…·ä»·å€¼ï¼Œå¹¶ä¸”åªè¦å†…å­˜å®¹é‡æœ‰é™ï¼Œä»·å€¼å°±å§‹ç»ˆå­˜åœ¨ã€‚æœ¬æ–‡æ„åœ¨èŠ‚çœCç¨‹åºå‘˜é‡æ–°å‘æ˜è¿™é¡¹æŠ€æœ¯æ‰€éœ€çš„æ—¶é—´ï¼Œè®©ä»–ä»¬æœ‰ç²¾åŠ›å…³æ³¨æ›´é‡è¦ä»»åŠ¡ã€‚</p>
<h1 id="å¯¹é½è¦æ±‚">å¯¹é½è¦æ±‚</h1>
<p>é¦–å…ˆéœ€è¦äº†è§£çš„æ˜¯ï¼Œå¯¹äºç°ä»£å¤„ç†å™¨ï¼ŒCç¼–è¯‘å™¨åœ¨å†…å­˜ä¸­æ”¾ç½®åŸºæœ¬Cæ•°æ®ç±»å‹çš„æ–¹å¼å—åˆ°çº¦æŸï¼Œä»¥ä»¤å†…å­˜çš„è®¿é—®é€Ÿåº¦æ›´å¿«ã€‚</p>
<p>åœ¨x86æˆ–ARMå¤„ç†å™¨ä¸­ï¼ŒåŸºæœ¬Cæ•°æ®ç±»å‹é€šå¸¸å¹¶ä¸å­˜å‚¨äºå†…å­˜ä¸­çš„éšæœºå­—èŠ‚åœ°å€ã€‚å®é™…æƒ…å†µæ˜¯ï¼Œé™¤charå¤–ï¼Œæ‰€æœ‰å…¶ä»–ç±»å‹éƒ½æœ‰â€œå¯¹é½è¦æ±‚â€ï¼šcharå¯èµ·å§‹äºä»»æ„å­—èŠ‚åœ°å€ï¼Œ2å­—èŠ‚çš„shortå¿…é¡»ä»å¶æ•°å­—èŠ‚åœ°å€å¼€å§‹ï¼Œ4å­—èŠ‚çš„intæˆ–floatå¿…é¡»ä»èƒ½è¢«4æ•´é™¤çš„åœ°å€å¼€å§‹ï¼Œ8æ¯”ç‰¹çš„longå’Œdoubleå¿…é¡»ä»èƒ½è¢«8æ•´é™¤çš„åœ°å€å¼€å§‹ã€‚æ— è®ºsignedï¼ˆæœ‰ç¬¦å·ï¼‰è¿˜æ˜¯unsignedï¼ˆæ— ç¬¦å·ï¼‰éƒ½ä¸å—å½±å“ã€‚</p>
<p>ç”¨è¡Œè¯æ¥è¯´ï¼Œx86å’ŒARMä¸Šçš„åŸºæœ¬Cç±»å‹æ˜¯â€œè‡ªå¯¹é½ï¼ˆself-alignedï¼‰â€çš„ã€‚å…³äºæŒ‡é’ˆï¼Œæ— è®º32ä½ï¼ˆ4å­—èŠ‚ï¼‰è¿˜æ˜¯64ä½ï¼ˆ8å­—èŠ‚ï¼‰ä¹Ÿéƒ½æ˜¯è‡ªå¯¹é½çš„ã€‚</p>
<p>è‡ªå¯¹é½å¯ä»¤è®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œå› ä¸ºå®ƒæœ‰åˆ©äºç”Ÿæˆå•æŒ‡ä»¤ï¼ˆsingle-instructionï¼‰å­˜å–è¿™äº›ç±»å‹çš„æ•°æ®ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚è‹¥æ²¡æœ‰å¯¹é½çº¦æŸï¼Œå¯èƒ½æœ€ç»ˆä¸å¾—ä¸é€šè¿‡ä¸¤ä¸ªæˆ–æ›´å¤šæŒ‡ä»¤è®¿é—®è·¨è¶Šæœºå™¨å­—è¾¹ç•Œçš„æ•°æ®ã€‚å­—ç¬¦æ•°æ®æ˜¯ç§ç‰¹æ®Šæƒ…å†µï¼Œå› å…¶å§‹ç»ˆå¤„åœ¨å•ä¸€æœºå™¨å­—ä¸­ï¼Œæ‰€ä»¥æ— è®ºå­˜å–ä½•å¤„çš„å­—ç¬¦æ•°æ®ï¼Œå¼€é”€éƒ½æ˜¯ä¸€è‡´çš„ã€‚è¿™ä¹Ÿå°±æ˜¯å®ƒä¸éœ€è¦å¯¹é½çš„åŸå› ã€‚</p>
<p>æˆ‘æåˆ°â€œç°ä»£å¤„ç†å™¨â€ï¼Œæ˜¯å› ä¸ºæœ‰äº›è€å¹³å°å¼ºè¿«Cç¨‹åºè¿åå¯¹é½è§„åˆ™ï¼ˆä¾‹å¦‚ï¼Œä¸ºintæŒ‡é’ˆåˆ†é…ä¸€ä¸ªå¥‡æ€ªçš„åœ°å€å¹¶è¯•å›¾ä½¿ç”¨å®ƒï¼‰ï¼Œä¸ä»…ä»¤é€Ÿåº¦å‡æ…¢ï¼Œè¿˜ä¼šå¯¼è‡´éæ³•æŒ‡ä»¤é”™è¯¯ã€‚ä¾‹å¦‚Sun SPARCèŠ¯ç‰‡å°±æœ‰è¿™ç§é—®é¢˜ã€‚äº‹å®ä¸Šï¼Œå¦‚æœä½ ä¸‹å®šå†³å¿ƒï¼Œå¹¶æ°å½“åœ°åœ¨å¤„ç†å™¨ä¸­è®¾ç½®æ ‡å¿—ä½ï¼ˆe18ï¼‰ï¼Œåœ¨x86å¹³å°ä¸Šï¼Œä¹Ÿèƒ½å¼•å‘è¿™ç§é”™è¯¯ã€‚</p>
<p>å¦å¤–ï¼Œè‡ªå¯¹é½å¹¶éå”¯ä¸€è§„åˆ™ã€‚çºµè§‚å†å²ï¼Œæœ‰äº›å¤„ç†å™¨ï¼Œç”±å…¶æ˜¯é‚£äº›ç¼ºä¹æ¡¶å¼ç§»ä½å™¨ï¼ˆBarrel shifterï¼‰çš„å¤„ç†å™¨é™åˆ¶æ›´å¤šã€‚å¦‚æœä½ ä»äº‹åµŒå…¥å¼ç³»ç»Ÿé¢†åŸŸç¼–ç¨‹ï¼Œæœ‰å¯èƒ½æ‰è¿›è¿™äº›æ½œä¼äºè‰ä¸›ä¹‹ä¸­çš„é™·é˜±ã€‚å°å¿ƒè¿™ç§å¯èƒ½ã€‚</p>
<p>ä½ è¿˜å¯ä»¥é€šè¿‡pragmaæŒ‡ä»¤ï¼ˆé€šå¸¸ä¸º<code>#pragma pack</code>ï¼‰å¼ºè¿«ç¼–è¯‘å™¨ä¸é‡‡ç”¨å¤„ç†å™¨æƒ¯ç”¨çš„å¯¹é½è§„åˆ™ã€‚ä½†è¯·åˆ«éšæ„è¿ç”¨è¿™ç§æ–¹å¼ï¼Œå› ä¸ºå®ƒå¼ºåˆ¶ç”Ÿæˆå¼€é”€æ›´å¤§ã€é€Ÿåº¦æ›´æ…¢çš„ä»£ç ã€‚é€šå¸¸ï¼Œé‡‡ç”¨æˆ‘åœ¨ä¸‹æ–‡ä»‹ç»çš„æ–¹å¼ï¼Œå¯ä»¥èŠ‚çœç›¸åŒæˆ–ç›¸è¿‘çš„å†…å­˜ã€‚</p>
<p>ä½¿ç”¨#pragma packçš„å”¯ä¸€ç†ç”±æ˜¯â€”â€”å‡å¦‚ä½ éœ€è®©Cè¯­è¨€çš„æ•°æ®åˆ†å¸ƒï¼Œä¸æŸç§ä½çº§åˆ«çš„ç¡¬ä»¶æˆ–åè®®å®Œå…¨åŒ¹é…ï¼ˆä¾‹å¦‚å†…å­˜æ˜ å°„ç¡¬ä»¶ç«¯å£ï¼‰ï¼Œè€Œè¿åé€šç”¨å¯¹é½è§„åˆ™åˆä¸å¯é¿å…ã€‚å¦‚æœä½ å¤„äºè¿™ç§å›°å¢ƒï¼Œä¸”ä¸äº†è§£æˆ‘æ‰€è®²è¿°çš„å†…å®¹ï¼Œé‚£ä½ å·²æ·±é™·æ³¥æ½­ï¼Œç¥å›å¥½è¿ã€‚</p>
<h1 id="å¡«å……">å¡«å……</h1>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…³äºå˜é‡åœ¨å†…å­˜ä¸­åˆ†å¸ƒçš„ç®€å•æ¡ˆä¾‹ã€‚æ€è€ƒå½¢å¼å¦‚ä¸‹çš„ä¸€ç³»åˆ—å˜é‡å£°æ˜ï¼Œå®ƒä»¬å¤„åœ¨ä¸€ä¸ªCæ¨¡å—çš„é¡¶å±‚ã€‚</p>
<pre><code class="language-C">char *p;
char c;
int x;
</code></pre>
<p>å‡å¦‚ä½ å¯¹æ•°æ®å¯¹é½ä¸€æ— æ‰€çŸ¥ï¼Œä¹Ÿè®¸ä»¥ä¸ºè¿™3ä¸ªå˜é‡å°†åœ¨å†…å­˜ä¸­å æ®ä¸€æ®µè¿ç»­ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨32ä½ç³»ç»Ÿä¸Šï¼Œä¸€ä¸ª4å­—èŠ‚æŒ‡é’ˆä¹‹åç´§è·Ÿç€1å­—èŠ‚çš„charï¼Œå…¶ååˆç´§è·Ÿç€4å­—èŠ‚intã€‚åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºæŒ‡é’ˆå°†å ç”¨8å­—èŠ‚ã€‚</p>
<p>ç„¶è€Œå®é™…æƒ…å†µï¼ˆåœ¨x86ã€ARMæˆ–å…¶ä»–é‡‡ç”¨è‡ªå¯¹é½ç±»å‹çš„å¹³å°ä¸Šï¼‰å¦‚ä¸‹ã€‚å­˜å‚¨péœ€è¦è‡ªå¯¹é½çš„4æˆ–8å­—èŠ‚ç©ºé—´ï¼Œè¿™å–å†³äºæœºå™¨å­—çš„å¤§å°ã€‚è¿™æ˜¯æŒ‡é’ˆå¯¹é½â€”â€”æå…¶ä¸¥æ ¼ã€‚</p>
<p>cç´§éšå…¶åï¼Œä½†æ¥ä¸‹æ¥xçš„4å­—èŠ‚å¯¹é½è¦æ±‚ï¼Œå°†å¼ºåˆ¶åœ¨åˆ†å¸ƒä¸­ç”Ÿæˆäº†ä¸€æ®µç©ºç™½ï¼Œä»¿ä½›åœ¨è¿™æ®µä»£ç ä¸­æ’å…¥äº†ç¬¬å››ä¸ªå˜é‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="language-C">char *p;      /* 4 or 8 bytes */
char c;       /* 1 byte */
char pad[3];  /* 3 bytes */
int x;        /* 4 bytes */
</code></pre>
<p>å­—ç¬¦æ•°ç»„<code>pad[3]</code>æ„å‘³ç€åœ¨è¿™ä¸ªç»“æ„ä½“ä¸­ï¼Œæœ‰3ä¸ªå­—èŠ‚çš„ç©ºé—´è¢«æµªè´¹æ‰äº†ã€‚è€æ´¾æœ¯è¯­å°†å…¶ç§°ä¹‹ä¸ºâ€œåºŸæ¶²ï¼ˆslopï¼‰â€ã€‚</p>
<p>å¦‚æœxä¸º2å­—èŠ‚shortï¼š</p>
<pre><code class="language-C">char *p;
char c;
short x;
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®é™…åˆ†å¸ƒå°†ä¼šæ˜¯ï¼š</p>
<pre><code class="language-C">char *p;      /* 4 or 8 bytes */
char c;       /* 1 byte */
char pad[1];  /* 1 byte */
short x;      /* 2 bytes */
</code></pre>
<p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœxä¸º64ä½ç³»ç»Ÿä¸­çš„longï¼š</p>
<pre><code class="language-C">char *p;
char c;
long x;
</code></pre>
<p>æˆ‘ä»¬å°†å¾—åˆ°ï¼š</p>
<pre><code class="language-C">char *p;     /* 8 bytes */
char c;      /* 1 byte */
char pad[7]; /* 7 bytes */
long x;      /* 8 bytes */
</code></pre>
<p>è‹¥ä½ ä¸€è·¯ä»”ç»†è¯»ä¸‹æ¥ï¼Œç°åœ¨å¯èƒ½ä¼šæ€ç´¢ï¼Œä½•ä¸é¦–å…ˆå£°æ˜è¾ƒçŸ­çš„å˜é‡ï¼Ÿ</p>
<pre><code class="language-C">char c;
char *p;
int x;
</code></pre>
<p>å‡å¦‚å®é™…å†…å­˜åˆ†å¸ƒå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼š</p>
<pre><code class="language-C">char c;
char pad1[M];
char *p;
char pad2[N];
int x;
</code></pre>
<p>é‚£<code>M</code>ä¸<code>N</code>åˆ†åˆ«ä¸ºå‡ ä½•ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œåœ¨æ­¤ä¾‹ä¸­ï¼Œ<code>N</code>å°†ä¸º0ï¼Œ<code>x</code>çš„åœ°å€ç´§éš<code>p</code>ä¹‹åï¼Œèƒ½ç¡®ä¿æ˜¯ä¸æŒ‡é’ˆå¯¹é½çš„ï¼Œå› ä¸ºæŒ‡é’ˆçš„å¯¹é½è¦æ±‚æ€»æ¯”intä¸¥æ ¼ã€‚</p>
<p><code>M</code>çš„å€¼å°±ä¸æ˜“é¢„æµ‹äº†ã€‚ç¼–è¯‘å™¨è‹¥æ˜¯æ°å¥½å°†<code>c</code>æ˜ å°„ä¸ºæœºå™¨å­—çš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªå­—èŠ‚ï¼ˆ<code>p</code>çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰å°†æ°å¥½ç”±æ­¤å¼€å§‹ï¼Œå¹¶æ°å¥½ä¸æŒ‡é’ˆå¯¹é½ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>M</code>å°†ä¸º0ã€‚</p>
<p>ä¸è¿‡æ›´æœ‰å¯èƒ½çš„æƒ…å†µæ˜¯ï¼Œ<code>c</code>å°†è¢«æ˜ å°„ä¸ºæœºå™¨å­—çš„é¦–å­—èŠ‚ã€‚äºæ˜¯ä¹<code>M</code>å°†ä¼šç”¨äºå¡«å……ï¼Œä»¥ä½¿<code>p</code>æŒ‡é’ˆå¯¹é½â€”â€”32ä½ç³»ç»Ÿä¸­ä¸º3å­—èŠ‚ï¼Œ64ä½ç³»ç»Ÿä¸­ä¸º7å­—èŠ‚ã€‚</p>
<p>ä¸­é—´æƒ…å†µä¹Ÿæœ‰å¯èƒ½å‘ç”Ÿã€‚Mçš„å€¼æœ‰å¯èƒ½åœ¨0åˆ°7ä¹‹é—´ï¼ˆ32ä½ç³»ç»Ÿä¸º0åˆ°3ï¼‰ï¼Œå› ä¸ºcharå¯ä»¥ä»æœºå™¨å­—çš„ä»»ä½•ä½ç½®èµ·å§‹ã€‚</p>
<p>å€˜è‹¥ä½ å¸Œæœ›è¿™äº›å˜é‡å ç”¨çš„ç©ºé—´æ›´å°‘ï¼Œé‚£ä¹ˆå¯ä»¥äº¤æ¢<code>x</code>ä¸<code>c</code>çš„æ¬¡åºã€‚</p>
<pre><code class="language-C">char *p;     /* 8 bytes */
long x;      /* 8 bytes */
char c;      /* 1 byte */
</code></pre>
<p>é€šå¸¸ï¼Œå¯¹äºCä»£ç ä¸­çš„å°‘æ•°æ ‡é‡å˜é‡ï¼ˆscalar variableï¼‰ï¼Œé‡‡ç”¨è°ƒæ¢å£°æ˜æ¬¡åºçš„æ–¹å¼èƒ½èŠ‚çœå‡ ä¸ªæœ‰é™çš„å­—èŠ‚ï¼Œæ•ˆæœä¸ç®—æ˜æ˜¾ã€‚è€Œå°†è¿™ç§æŠ€æœ¯åº”ç”¨äºéæ ‡é‡å˜é‡ï¼ˆnonscalar variableï¼‰â€”â€”å°¤å…¶æ˜¯ç»“æ„ä½“ï¼Œåˆ™è¦æœ‰è¶£å¤šäº†ã€‚</p>
<p>åœ¨è®²è¿°è¿™éƒ¨åˆ†å†…å®¹å‰ï¼Œæˆ‘ä»¬å…ˆå¯¹æ ‡é‡æ•°ç»„åšä¸ªè¯´æ˜ã€‚åœ¨å…·æœ‰è‡ªå¯¹é½ç±»å‹çš„å¹³å°ä¸Šï¼Œcharã€shortã€intã€longå’ŒæŒ‡é’ˆæ•°ç»„éƒ½æ²¡æœ‰å†…éƒ¨å¡«å……ï¼Œæ¯ä¸ªæˆå‘˜éƒ½ä¸ä¸‹ä¸€ä¸ªæˆå‘˜è‡ªåŠ¨å¯¹é½ã€‚</p>
<p>åœ¨ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œè¿™ç§æƒ…å†µå¯¹ç»“æ„ä½“æ•°ç»„å¹¶ä¸é€‚ç”¨ã€‚</p>
<h1 id="ç»“æ„ä½“çš„å¯¹é½å’Œå¡«å……">ç»“æ„ä½“çš„å¯¹é½å’Œå¡«å……</h1>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç»“æ„ä½“å®ä¾‹ä»¥å…¶æœ€å®½çš„æ ‡é‡æˆå‘˜ä¸ºåŸºå‡†è¿›è¡Œå¯¹é½ã€‚ç¼–è¯‘å™¨ä¹‹æ‰€ä»¥å¦‚æ­¤ï¼Œæ˜¯å› ä¸ºæ­¤ä¹ƒç¡®ä¿æ‰€æœ‰æˆå‘˜è‡ªå¯¹é½ï¼Œå®ç°å¿«é€Ÿè®¿é—®æœ€ç®€ä¾¿çš„æ–¹æ³•ã€‚</p>
<p>æ­¤å¤–ï¼Œåœ¨Cè¯­è¨€ä¸­ï¼Œç»“æ„ä½“çš„åœ°å€ï¼Œä¸å…¶ç¬¬ä¸€ä¸ªæˆå‘˜çš„åœ°å€ä¸€è‡´â€”â€”ä¸å­˜åœ¨å¤´å¡«å……ï¼ˆleading paddingï¼‰ã€‚å°å¿ƒï¼šåœ¨C++ä¸­ï¼Œä¸ç»“æ„ä½“ç›¸ä¼¼çš„ç±»ï¼Œå¯èƒ½ä¼šæ‰“ç ´è¿™æ¡è§„åˆ™ï¼ï¼ˆæ˜¯å¦çœŸçš„å¦‚æ­¤ï¼Œè¦çœ‹åŸºç±»å’Œè™šæ‹Ÿæˆå‘˜å‡½æ•°æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä¸ä¸åŒçš„ç¼–è¯‘å™¨ä¹Ÿæœ‰å…³è”ã€‚ï¼‰</p>
<p>å‡å¦‚ä½ å¯¹æ­¤æœ‰ç–‘æƒ‘ï¼ŒANSI Cæä¾›äº†ä¸€ä¸ª<code>offsetof()</code>å®ï¼Œå¯ç”¨äºè¯»å–ç»“æ„ä½“æˆå‘˜ä½ç§»ã€‚</p>
<p>è€ƒè™‘è¿™ä¸ªç»“æ„ä½“ï¼š</p>
<pre><code class="language-C">struct foo1 {
    char *p;
    char c;
    long x;
};
</code></pre>
<p>å‡å®šå¤„åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œä»»ä½•<code>struct fool</code>çš„å®ä¾‹éƒ½é‡‡ç”¨8å­—èŠ‚å¯¹é½ã€‚ä¸å‡ºæ‰€æ–™ï¼Œå…¶å†…å­˜åˆ†å¸ƒå°†ä¼šåƒä¸‹é¢è¿™æ ·ï¼š</p>
<pre><code class="language-C">struct foo1 {
    char *p;     /* 8 bytes */
    char c;      /* 1 byte */
    char pad[7]; /* 7 bytes */
    long x;      /* 8 bytes */
};
</code></pre>
<p>çœ‹èµ·æ¥ä»¿ä½›ä¸è¿™äº›ç±»å‹çš„å˜é‡å•ç‹¬å£°æ˜åˆ«æ— äºŒè‡´ã€‚ä½†å‡å¦‚æˆ‘ä»¬å°†<code>c</code>æ”¾åœ¨é¦–ä½ï¼Œå°±ä¼šå‘ç°æƒ…å†µå¹¶éå¦‚æ­¤ã€‚</p>
<pre><code class="language-C">struct foo2 {
    char c;      /* 1 byte */
    char pad[7]; /* 7 bytes */
    char *p;     /* 8 bytes */
    long x;      /* 8 bytes */
};
</code></pre>
<p>å¦‚æœæˆå‘˜æ˜¯äº’ä¸å…³è”çš„å˜é‡ï¼Œ<code>c</code>ä¾¿å¯èƒ½ä»ä»»æ„ä½ç½®èµ·å§‹ï¼Œ<code>pad</code>çš„å¤§å°åˆ™ä¸å†å›ºå®šã€‚å› ä¸º<code>struct foo2</code>çš„æŒ‡é’ˆéœ€è¦ä¸å…¶æœ€å®½çš„æˆå‘˜ä¸ºåŸºå‡†å¯¹é½ï¼Œè¿™å˜å¾—ä¸å†å¯èƒ½ã€‚ç°åœ¨<code>c</code>éœ€è¦æŒ‡é’ˆå¯¹é½ï¼Œæ¥ä¸‹æ¥å¡«å……çš„7ä¸ªå­—èŠ‚è¢«é”å®šäº†ã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆç»“æ„ä½“çš„å°¾å¡«å……ï¼ˆtrailing paddingï¼‰ã€‚ä¸ºäº†è§£é‡Šå®ƒï¼Œéœ€è¦å¼•å…¥ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µï¼Œæˆ‘å°†å…¶ç§°ä¸ºç»“æ„ä½“çš„â€œè·¨æ­¥åœ°å€ï¼ˆstride addressï¼‰â€ã€‚å®ƒæ˜¯åœ¨ç»“æ„ä½“æ•°æ®ä¹‹åï¼Œä¸ç»“æ„ä½“å¯¹é½ä¸€è‡´çš„é¦–ä¸ªåœ°å€ã€‚</p>
<p>ç»“æ„ä½“å°¾å¡«å……çš„é€šç”¨æ³•åˆ™æ˜¯ï¼šç¼–è¯‘å™¨å°†ä¼šå¯¹ç»“æ„ä½“è¿›è¡Œå°¾å¡«å……ï¼Œç›´è‡³å®ƒçš„è·¨æ­¥åœ°å€ã€‚è¿™æ¡æ³•åˆ™å†³å®šäº†<code>sizeof()</code>çš„è¿”å›å€¼ã€‚</p>
<p>è€ƒè™‘64ä½x86æˆ–ARMç³»ç»Ÿä¸­çš„è¿™ä¸ªä¾‹å­ï¼š</p>
<pre><code class="language-C">struct foo3 {
    char *p;     /* 8 bytes */
    char c;      /* 1 byte */
};

struct foo3 singleton;
struct foo3 quad[4];
</code></pre>
<p>ä½ ä»¥ä¸º<code>sizeof(struct foo3)</code>çš„å€¼æ˜¯9ï¼Œä½†å®é™…æ˜¯16ã€‚å®ƒçš„è·¨æ­¥åœ°å€æ˜¯<code>(&amp;p)[2]</code>ã€‚äºæ˜¯ï¼Œåœ¨<code>quad</code>æ•°ç»„ä¸­ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æœ‰7å­—èŠ‚çš„å°¾å¡«å……ï¼Œå› ä¸ºä¸‹ä¸ªç»“æ„ä½“çš„é¦–ä¸ªæˆå‘˜éœ€è¦åœ¨ï¼˜å­—èŠ‚è¾¹ç•Œä¸Šå¯¹é½ã€‚å†…å­˜åˆ†å¸ƒå°±å¥½åƒè¿™ä¸ªç»“æ„æ˜¯è¿™æ ·å£°æ˜çš„ï¼š</p>
<pre><code class="language-C">struct foo3 {
    char *p;     /* 8 bytes */
    char c;      /* 1 byte */
    char pad[7];
};
</code></pre>
<p>ä½œä¸ºå¯¹æ¯”ï¼Œæ€è€ƒä¸‹é¢çš„ä¾‹å­ï¼š</p>
<pre><code class="language-C">struct foo4 {
    short s;     /* 2 bytes */
    char c;      /* 1 byte */
};
</code></pre>
<p>å› ä¸º<code>s</code>åªéœ€è¦2å­—èŠ‚å¯¹é½ï¼Œè·¨æ­¥åœ°å€ä»…åœ¨<code>c</code>çš„1å­—èŠ‚ä¹‹åï¼Œæ•´ä¸ª<code>struct foo4</code>ä¹Ÿåªéœ€è¦1å­—èŠ‚çš„å°¾å¡«å……ã€‚å½¢å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="language-C">struct foo4 {
    short s;     /* 2 bytes */
    char c;      /* 1 byte */
    char pad[1];
};
</code></pre>
<p><code>sizeof(struct foo4)</code>çš„è¿”å›å€¼å°†ä¸º4ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬è€ƒè™‘ä½åŸŸï¼ˆbitfieldsï¼‰ã€‚åˆ©ç”¨ä½åŸŸï¼Œä½ èƒ½å£°æ˜æ¯”å­—ç¬¦å®½åº¦æ›´å°çš„æˆå‘˜ï¼Œä½è‡³ï¼‘ä½ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="language-C">struct foo5 {
    short s;
    char c;
    int flip:1;
    int nybble:4;
    int septet:7;
};
</code></pre>
<p>å…³äºä½åŸŸéœ€è¦äº†è§£çš„æ˜¯ï¼Œå®ƒä»¬æ˜¯ç”±å­—ï¼ˆæˆ–å­—èŠ‚ï¼‰å±‚é¢çš„æ©ç å’Œç§»ä½æŒ‡ä»¤å®ç°çš„ã€‚ä»ç¼–è¯‘å™¨çš„è§’åº¦æ¥çœ‹ï¼Œ<code>struct foo5</code>ä¸­çš„ä½åŸŸå°±åƒï¼’å­—èŠ‚ã€16ä½çš„å­—ç¬¦æ•°ç»„ï¼Œåªç”¨åˆ°äº†å…¶ä¸­12ä½ã€‚ä¸ºäº†ä½¿ç»“æ„ä½“çš„é•¿åº¦æ˜¯å…¶æœ€å®½æˆå‘˜é•¿åº¦<code>sizeof(short)</code>çš„æ•´æ•°å€ï¼Œæ¥ä¸‹æ¥è¿›è¡Œäº†å¡«å……ã€‚</p>
<pre><code class="language-C">struct foo5 {
    short s;       /* 2 bytes */
    char c;        /* 1 byte */
    int flip:1;    /* total 1 bit */
    int nybble:4;  /* total 5 bits */
    int septet:7;  /* total 12 bits */
    int pad1:4;    /* total 16 bits = 2 bytes */
    char pad2;     /* 1 byte */
};
</code></pre>
<p>è¿™æ˜¯æœ€åä¸€ä¸ªé‡è¦ç»†èŠ‚ï¼šå¦‚æœä½ çš„ç»“æ„ä½“ä¸­å«æœ‰ç»“æ„ä½“æˆå‘˜ï¼Œå†…å±‚ç»“æ„ä½“ä¹Ÿè¦å’Œæœ€é•¿çš„æ ‡é‡æœ‰ç›¸åŒçš„å¯¹é½ã€‚å‡å¦‚ä½ å†™ä¸‹äº†è¿™æ®µä»£ç ï¼š</p>
<pre><code class="language-C">struct foo6 {
    char c;
    struct foo5 {
        char *p;
        short x;
    } inner;
};
</code></pre>
<p>å†…å±‚ç»“æ„ä½“æˆå‘˜<code>char *p</code>å¼ºè¿«å¤–å±‚ç»“æ„ä½“ä¸å†…å±‚ç»“æ„ä½“æŒ‡é’ˆå¯¹é½ä¸€è‡´ã€‚åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œå®é™…çš„å†…å­˜åˆ†å¸ƒå°†ç±»ä¼¼è¿™æ ·ï¼š</p>
<pre><code class="language-C">struct foo6 {
    char c;           /* 1 byte */
    char pad1[7];     /* 7 bytes */
    struct foo6_inner {
        char *p;      /* 8 bytes */
        short x;      /* 2 bytes */
        char pad2[6]; /* 6 bytes */
    } inner;
};
</code></pre>
<p>å®ƒå¯ç¤ºæˆ‘ä»¬ï¼Œèƒ½é€šè¿‡é‡æ–°æ‰“åŒ…èŠ‚çœç©ºé—´ã€‚24ä¸ªå­—èŠ‚ä¸­ï¼Œæœ‰13ä¸ªä¸ºå¡«å……ï¼Œæµªè´¹äº†è¶…è¿‡50%çš„ç©ºé—´ï¼</p>
<h1 id="ç»“æ„ä½“æˆå‘˜é‡æ’">ç»“æ„ä½“æˆå‘˜é‡æ’</h1>
<p>ç†è§£äº†ç¼–è¯‘å™¨åœ¨ç»“æ„ä½“ä¸­é—´å’Œå°¾éƒ¨æ’å…¥å¡«å……çš„åŸå› ä¸æ–¹å¼åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ¦¨å‡ºè¿™äº›åºŸæ¶²ã€‚æ­¤å³ç»“æ„ä½“æ‰“åŒ…çš„æŠ€è‰ºã€‚</p>
<p>é¦–å…ˆæ³¨æ„ï¼ŒåºŸæ¶²åªå­˜åœ¨äºä¸¤å¤„ã€‚å…¶ä¸€æ˜¯è¾ƒå¤§çš„æ•°æ®ç±»å‹ï¼ˆéœ€è¦æ›´ä¸¥æ ¼çš„å¯¹é½ï¼‰è·Ÿåœ¨è¾ƒå°çš„æ•°æ®ç±»å‹ä¹‹åã€‚å…¶äºŒæ˜¯ç»“æ„ä½“è‡ªç„¶ç»“æŸçš„ä½ç½®åœ¨è·¨æ­¥åœ°å€ä¹‹å‰ï¼Œè¿™é‡Œéœ€è¦å¡«å……ï¼Œä»¥ä½¿ä¸‹ä¸ªç»“æ„ä½“èƒ½æ­£ç¡®åœ°å¯¹é½ã€‚</p>
<p>æ¶ˆé™¤åºŸæ¶²æœ€ç®€å•çš„æ–¹å¼ï¼Œæ˜¯æŒ‰å¯¹é½å€¼é€’å‡é‡æ–°å¯¹ç»“æ„ä½“æˆå‘˜æ’åºã€‚å³è®©æ‰€æœ‰æŒ‡é’ˆå¯¹é½æˆå‘˜æ’åœ¨æœ€å‰é¢ï¼Œå› ä¸ºåœ¨64ä½ç³»ç»Ÿä¸­å®ƒä»¬å ç”¨8å­—èŠ‚ï¼›ç„¶åæ˜¯4å­—èŠ‚çš„intï¼›å†ç„¶åæ˜¯2å­—èŠ‚çš„shortï¼Œæœ€åæ˜¯å­—ç¬¦ã€‚</p>
<p>å› æ­¤ï¼Œä»¥ç®€å•çš„é“¾è¡¨ç»“æ„ä½“ä¸ºä¾‹ï¼š</p>
<pre><code class="language-C">struct foo7 {
    char c;
    struct foo7 *p;
    short x;
};
</code></pre>
<p>å°†éšå«çš„åºŸæ¶²å†™æ˜ï¼Œå½¢å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="language-C">struct foo7 {
    char c;         /* 1 byte */
    char pad1[7];   /* 7 bytes */
    struct foo7 *p; /* 8 bytes */
    short x;        /* 2 bytes */
    char pad2[6];   /* 6 bytes */
};
</code></pre>
<p>æ€»å…±æ˜¯24å­—èŠ‚ã€‚å¦‚æœæŒ‰é•¿åº¦é‡æ’ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<pre><code class="language-C">struct foo8 {
    struct foo8 *p;
    short x;
    char c;
};
</code></pre>
<p>è€ƒè™‘åˆ°è‡ªå¯¹é½ï¼Œæˆ‘ä»¬çœ‹åˆ°æ‰€æœ‰æ•°æ®åŸŸä¹‹é—´éƒ½ä¸éœ€å¡«å……ã€‚å› ä¸ºæœ‰è¾ƒä¸¥å¯¹é½è¦æ±‚ï¼ˆæ›´é•¿ï¼‰æˆå‘˜çš„è·¨æ­¥åœ°å€å¯¹ä¸å¤ªä¸¥å¯¹é½è¦æ±‚çš„ï¼ˆæ›´çŸ­ï¼‰æˆå‘˜æ¥è¯´ï¼Œæ€»æ˜¯åˆæ³•çš„å¯¹é½åœ°å€ã€‚é‡æ‰“åŒ…è¿‡çš„ç»“æ„ä½“åªéœ€è¦å°¾å¡«å……ï¼š</p>
<pre><code class="language-C">struct foo8 {
    struct foo8 *p; /* 8 bytes */
    short x;        /* 2 bytes */
    char c;         /* 1 byte */
    char pad[5];    /* 5 bytes */
};
</code></pre>
<p>é‡æ–°æ‰“åŒ…å°†ç©ºé—´é™ä¸º16å­—èŠ‚ã€‚ä¹Ÿè®¸çœ‹èµ·æ¥ä¸ç®—å¾ˆå¤šï¼Œä½†å‡å¦‚è¿™ä¸ªé“¾è¡¨çš„é•¿åº¦æœ‰20ä¸‡å‘¢ï¼Ÿå°†ä¼šç§¯å°‘æˆå¤šã€‚</p>
<p>æ³¨æ„ï¼Œé‡æ–°æ‰“åŒ…ä¸èƒ½ç¡®ä¿åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½èƒ½èŠ‚çœç©ºé—´ã€‚å°†è¿™é¡¹æŠ€æœ¯åº”ç”¨äºæ›´é å‰<code>struct foo6</code>çš„é‚£ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<pre><code class="language-C">struct foo9 {
    struct foo9_inner {
        char *p;      /* 8 bytes */
        int x;        /* 4 bytes */
    } inner;
    char c;           /* 1 byte */
};
</code></pre>
<p>å°†å¡«å……å†™æ˜ï¼š</p>
<pre><code class="language-C">struct foo9 {
    struct foo9_inner {
        char *p;      /* 8 bytes */
        int x;        /* 4 bytes */
        char pad[4];  /* 4 bytes */
    } inner;
    char c;           /* 1 byte */
    char pad[7];      /* 7 bytes */
};
</code></pre>
<p>ç»“æœè¿˜æ˜¯24å­—èŠ‚ï¼Œå› ä¸º<code>c</code>æ— æ³•ä½œä¸ºå†…å±‚ç»“æ„ä½“çš„å°¾å¡«å……ã€‚è¦æƒ³èŠ‚çœç©ºé—´ï¼Œä½ éœ€è¦å¾—æ–°è®¾è®¡æ•°æ®ç»“æ„ã€‚</p>
<h1 id="æ£˜æ‰‹çš„æ ‡é‡æ¡ˆä¾‹">æ£˜æ‰‹çš„æ ‡é‡æ¡ˆä¾‹</h1>
<p>åªæœ‰åœ¨ç¬¦å·è°ƒè¯•å™¨èƒ½æ˜¾ç¤ºæšä¸¾ç±»å‹çš„åç§°è€ŒéåŸå§‹æ•´å‹æ•°å­—æ—¶ï¼Œä½¿ç”¨æšä¸¾æ¥ä»£æ›¿<code>#define</code>æ‰æ˜¯ä¸ªå¥½åŠæ³•ã€‚ç„¶è€Œï¼Œå°½ç®¡æšä¸¾å¿…å®šä¸æŸç§æ•´å‹å…¼å®¹ï¼Œä½†ï¼£æ ‡å‡†å´æ²¡æœ‰æŒ‡æ˜ç©¶ç«Ÿæ˜¯ä½•ç§åº•å±‚æ•´å‹ã€‚</p>
<p>è¯·å½“å¿ƒï¼Œé‡æ‰“åŒ…ç»“æ„ä½“æ—¶ï¼Œæšä¸¾å‹å˜é‡é€šå¸¸æ˜¯intï¼Œè¿™ä¸ç¼–è¯‘å™¨ç›¸å…³ï¼›ä½†ä¹Ÿå¯èƒ½æ˜¯shortã€longã€ç”šè‡³é»˜è®¤ä¸ºcharã€‚ç¼–è¯‘å™¨å¯èƒ½ä¼šæœ‰progmaé¢„å¤„ç†æŒ‡ä»¤æˆ–å‘½ä»¤è¡Œé€‰é¡¹æŒ‡å®šæšä¸¾çš„å°ºå¯¸ã€‚</p>
<p><code>long double</code>æ˜¯ä¸ªç±»ä¼¼çš„æ•…éšœç‚¹ã€‚æœ‰äº›Cå¹³å°ä»¥80ä½å®ç°ï¼Œæœ‰äº›æ˜¯128ä½ï¼Œè¿˜æœ‰äº›80ä½å¹³å°å°†å…¶å¡«å……åˆ°96æˆ–128ä½ã€‚</p>
<p>ä»¥ä¸Šä¸¤ç§æƒ…å†µï¼Œæœ€å¥½ç”¨<code>sizeof()</code>æ¥æ£€æŸ¥å­˜å‚¨å°ºå¯¸ã€‚</p>
<p>æœ€åï¼Œåœ¨x86 Linuxç³»ç»Ÿä¸­ï¼Œdoubleæœ‰æ—¶ä¼šç ´è‡ªå¯¹é½è§„åˆ™çš„ä¾‹ï¼›åœ¨ç»“æ„ä½“å†…ï¼Œ8å­—èŠ‚çš„doubleå¯èƒ½åªè¦æ±‚4å­—èŠ‚å¯¹é½ï¼Œè€Œåœ¨ç»“æ„ä½“å¤–ï¼Œç‹¬ç«‹çš„doubleå˜é‡åˆæ˜¯8å­—èŠ‚è‡ªå¯¹é½ã€‚è¿™ä¸ç¼–è¯‘å™¨å’Œé€‰é¡¹æœ‰å…³ã€‚</p>
<h1 id="å¯è¯»æ€§ä¸ç¼“å­˜å±€éƒ¨æ€§">å¯è¯»æ€§ä¸ç¼“å­˜å±€éƒ¨æ€§</h1>
<p>å°½ç®¡æŒ‰å°ºå¯¸é‡æ’æ˜¯æœ€ç®€å•çš„æ¶ˆé™¤åºŸæ¶²çš„æ–¹å¼ï¼Œå´ä¸ä¸€å®šæ˜¯æ­£ç¡®çš„æ–¹å¼ã€‚è¿˜æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦è€ƒé‡ï¼šå¯è¯»æ€§ä¸ç¼“å­˜å±€éƒ¨æ€§ã€‚</p>
<p>ç¨‹åºä¸ä»…ä¸è®¡ç®—æœºäº¤æµï¼Œè¿˜ä¸å…¶ä»–äººäº¤æµã€‚ç”šè‡³ï¼ˆå°¤å…¶æ˜¯ï¼ï¼‰äº¤æµçš„å¯¹è±¡åªæœ‰å°†æ¥ä½ è‡ªå·±æ—¶ï¼Œä»£ç å¯è¯»æ€§ä¾ç„¶é‡è¦ã€‚</p>
<p>ç¬¨æ‹™åœ°ã€æœºæ¢°åœ°é‡æ’ç»“æ„ä½“å¯èƒ½æœ‰æŸå¯è¯»æ€§ã€‚å€˜è‹¥æœ‰å¯èƒ½ï¼Œæœ€å¥½è¿™æ ·é‡æ’æˆå‘˜ï¼šå°†è¯­ä¹‰ç›¸å…³çš„æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼Œå½¢æˆè¿è´¯çš„ç»„ã€‚æœ€ç†æƒ³çš„æƒ…å†µæ˜¯ï¼Œç»“æ„ä½“çš„è®¾è®¡åº”ä¸ç¨‹åºçš„è®¾è®¡ç›¸é€šã€‚</p>
<p>å½“ç¨‹åºé¢‘ç¹è®¿é—®æŸä¸€ç»“æ„ä½“æˆ–å…¶ä¸€éƒ¨åˆ†æ—¶ï¼Œè‹¥èƒ½å°†å…¶æ”¾å…¥ä¸€ä¸ªç¼“å­˜æ®µï¼Œå¯¹æé«˜æ€§èƒ½é¢‡æœ‰å¸®åŠ©ã€‚ç¼“å­˜æ®µæ˜¯è¿™æ ·çš„å†…å­˜å—â€”â€”å½“å¤„ç†å™¨è·å–å†…å­˜ä¸­çš„ä»»ä½•å•ä¸ªåœ°å€æ—¶ï¼Œä¼šæŠŠæ•´å—æ•°æ®éƒ½å–å‡ºæ¥ã€‚ã€€åœ¨64ä½x86ä¸Šï¼Œä¸€ä¸ªç¼“å­˜æ®µä¸º64å­—èŠ‚ï¼Œå®ƒå¼€å§‹äºè‡ªå¯¹é½çš„åœ°å€ã€‚å…¶ä»–å¹³å°é€šå¸¸ä¸º32å­—èŠ‚ã€‚</p>
<p>ä¸ºä¿æŒå¯è¯»æ€§æ‰€åšçš„å·¥ä½œï¼ˆå°†ç›¸å…³å’ŒåŒæ—¶è®¿é—®çš„æ•°æ®æ”¾åœ¨ä¸´è¿‘ä½ç½®ï¼‰ä¹Ÿä¼šæé«˜ç¼“å­˜æ®µçš„å±€éƒ¨æ€§ã€‚è¿™äº›éƒ½æ˜¯éœ€è¦æ˜æ™ºåœ°é‡æ’ï¼Œå¹¶å¯¹æ•°æ®çš„å­˜å–æ¨¡å¼äº†ç„¶äºå¿ƒçš„åŸå› ã€‚</p>
<p>å¦‚æœä»£ç ä»å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®åŒä¸€ç»“æ„ä½“ï¼Œè¿˜å­˜åœ¨ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼šç¼“å­˜æ®µå¼¹è·³ï¼ˆcache line bouncingï¼‰ã€‚ä¸ºäº†å°½é‡å‡å°‘æ˜‚è´µçš„æ€»çº¿é€šä¿¡ï¼Œåº”å½“è¿™æ ·å®‰æ’æ•°æ®â€”â€”åœ¨ä¸€ä¸ªæ›´ç´§å‡‘çš„å¾ªç¯é‡Œï¼Œä»ä¸€ä¸ªç¼“å­˜æ®µä¸­è¯»æ•°æ®ï¼Œè€Œå‘å¦ä¸€ä¸ªå†™å…¥æ•°æ®ã€‚</p>
<p>æ˜¯çš„ï¼ŒæŸäº›æ—¶å€™ï¼Œè¿™ç§åšæ³•ä¸å‰æ–‡å°†ç›¸å…³æ•°æ®æ”¾å…¥ä¸ç¼“å­˜æ®µé•¿åº¦ç›¸åŒå—çš„åšæ³•çŸ›ç›¾ã€‚å¤šçº¿ç¨‹çš„ç¡®æ˜¯ä¸ªéš¾é¢˜ã€‚ç¼“å­˜æ®µå¼¹è·³å’Œå…¶ä»–å¤šçº¿ç¨‹ä¼˜åŒ–é—®é¢˜æ˜¯å¾ˆé«˜çº§çš„è¯é¢˜ï¼Œå€¼å¾—å•ç‹¬ä¸ºå®ƒä»¬å†™ä»½æŒ‡å¯¼ã€‚è¿™é‡Œæˆ‘æ‰€èƒ½åšçš„ï¼Œåªæ˜¯è®©ä½ äº†è§£æœ‰è¿™äº›é—®é¢˜å­˜åœ¨ã€‚</p>
<h1 id="å…¶ä»–æ‰“åŒ…æŠ€æœ¯">å…¶ä»–æ‰“åŒ…æŠ€æœ¯</h1>
<p>åœ¨ä¸ºç»“æ„ä½“ç˜¦èº«æ—¶ï¼Œé‡æ’åºä¸å…¶ä»–æŠ€æœ¯ç»“åˆåœ¨ä¸€èµ·æ•ˆæœæœ€å¥½ã€‚ä¾‹å¦‚ç»“æ„ä½“ä¸­æœ‰å‡ ä¸ªå¸ƒå°”æ ‡å¿—ï¼Œå¯ä»¥è€ƒè™‘å°†å…¶å‹ç¼©æˆ1ä½çš„ä½åŸŸï¼Œç„¶åæŠŠå®ƒä»¬æ‰“åŒ…æ”¾åœ¨åŸæœ¬å¯èƒ½æˆä¸ºåºŸæ¶²çš„åœ°æ–¹ã€‚</p>
<p>ä½ å¯èƒ½ä¼šæœ‰ä¸€ç‚¹å„¿å­˜å–æ—¶é—´çš„æŸå¤±ï¼Œä½†åªè¦å°†å·¥ä½œé›†åˆå‹ç¼©å¾—è¶³å¤Ÿå°ï¼Œé‚£ç‚¹æŸå¤±å¯ä»¥é é¿å…ç¼“å­˜æœªå‘½ä¸­è¡¥å¿ã€‚</p>
<p>æ›´é€šç”¨çš„åŸåˆ™æ˜¯ï¼Œé€‰æ‹©èƒ½æŠŠæ•°æ®ç±»å‹ç¼©çŸ­çš„æ–¹æ³•ã€‚ä»¥cvs-fast-exportä¸ºä¾‹ï¼Œæˆ‘ä½¿ç”¨çš„ä¸€ä¸ªå‹ç¼©æ–¹æ³•æ˜¯ï¼šåˆ©ç”¨RCSå’ŒCVSåœ¨1982å¹´å‰è¿˜ä¸å­˜åœ¨è¿™ä¸ªäº‹å®ï¼Œæˆ‘å¼ƒç”¨äº†64ä½çš„Unix<code>time_t</code>ï¼ˆåœ¨1970å¹´å¼€å§‹ä¸ºé›¶ï¼‰ï¼Œè½¬è€Œç”¨äº†ä¸€ä¸ª32ä½çš„ã€ä»1982-01-01T00:00:00å¼€å§‹çš„åç§»é‡ï¼›è¿™æ ·æ—¥æœŸä¼šè¦†ç›–åˆ°2118å¹´ã€‚ï¼ˆæ³¨æ„ï¼šè‹¥ä½¿ç”¨è¿™ç±»æŠ€å·§ï¼Œè¦ç”¨è¾¹ç•Œæ¡ä»¶æ£€æŸ¥ä»¥é˜²è®¨åŒçš„Bugï¼ï¼‰</p>
<p>è¿™ä¸ä»…å‡å°äº†ç»“æ„ä½“çš„å¯è§å°ºå¯¸ï¼Œè¿˜å¯ä»¥æ¶ˆé™¤åºŸæ¶²å’Œ/æˆ–åˆ›é€ é¢å¤–çš„æœºä¼šæ¥è¿›è¡Œé‡æ–°æ’åºã€‚è¿™ç§è‰¯æ€§ä¸²è¿çš„æ•ˆæœä¸éš¾è¢«è§¦å‘ã€‚</p>
<p>æœ€å†’é™©çš„æ‰“åŒ…æ–¹æ³•æ˜¯ä½¿ç”¨unionã€‚å‡å¦‚ä½ çŸ¥é“ç»“æ„ä½“ä¸­çš„æŸäº›åŸŸæ°¸è¿œä¸ä¼šè·Ÿå¦ä¸€äº›åŸŸå…±åŒä½¿ç”¨ï¼Œå¯ä»¥è€ƒè™‘ç”¨unionå…±äº«å®ƒä»¬å­˜å‚¨ç©ºé—´ã€‚ä¸è¿‡è¯·ç‰¹åˆ«å°å¿ƒå¹¶ç”¨å›å½’æµ‹è¯•éªŒè¯ã€‚å› ä¸ºå¦‚æœåˆ†æå‡ºç°ä¸€ä¸ç‚¹å„¿é”™è¯¯ï¼Œå°±ä¼šå¼•å‘ä»ç¨‹åºå´©æºƒåˆ°å¾®å¦™æ•°æ®æŸåï¼ˆè¿™ç§æƒ…å†µç³Ÿå¾—å¤šï¼‰é—´çš„å„ç§é”™è¯¯ã€‚</p>
<h1 id="å·¥å…·">å·¥å…·</h1>
<p>clangç¼–è¯‘å™¨æœ‰ä¸ªWpaddedé€‰é¡¹ï¼Œå¯ä»¥ç”Ÿæˆæœ‰å…³å¯¹é½å’Œå¡«å……çš„ä¿¡æ¯ã€‚</p>
<p>è¿˜æœ‰ä¸ªå«paholeçš„å·¥å…·ï¼Œæˆ‘è‡ªå·±æ²¡ç”¨è¿‡ï¼Œä½†æ®è¯´å£ç¢‘å¾ˆå¥½ã€‚è¯¥å·¥å…·ä¸ç¼–è¯‘å™¨ååŒå·¥ä½œï¼Œç”Ÿæˆå…³äºç»“æ„ä½“å¡«å……ã€å¯¹é½å’Œç¼“å­˜æ®µè¾¹ç•ŒæŠ¥å‘Šã€‚</p>
<h1 id="è¯æ˜å’Œä¾‹å¤–">è¯æ˜å’Œä¾‹å¤–</h1>
<p>è¯»è€…å¯ä»¥ä¸‹è½½ä¸€æ®µç¨‹åºæºä»£ç <a href="http://www.catb.org/esr/structure-packing/packtest.c">packtest.c</a>ï¼ŒéªŒè¯ä¸Šæ–‡æœ‰å…³æ ‡é‡å’Œç»“æ„ä½“å°ºå¯¸çš„ç»“è®ºã€‚</p>
<p>å¦‚æœä½ ä»”ç»†æ£€æŸ¥å„ç§ç¼–è¯‘å™¨ã€é€‰é¡¹å’Œç½•è§ç¡¬ä»¶çš„ç¨€å¥‡ç»„åˆï¼Œä¼šå‘ç°æˆ‘å‰é¢æåˆ°çš„éƒ¨åˆ†è§„åˆ™å­˜åœ¨ä¾‹å¤–ã€‚è¶Šæ—©æœŸçš„å¤„ç†å™¨è®¾è®¡ä¾‹å¤–è¶Šå¸¸è§ã€‚</p>
<p>ç†è§£è¿™äº›è§„åˆ™çš„ç¬¬äºŒä¸ªå±‚æ¬¡æ˜¯ï¼ŒçŸ¥å…¶ä½•æ—¶åŠå¦‚ä½•ä¼šè¢«æ‰“ç ´ã€‚åœ¨æˆ‘å­¦ä¹ å®ƒä»¬çš„æ—¥å­é‡Œï¼ˆ1980å¹´ä»£æ—©æœŸï¼‰ï¼Œæˆ‘ä»¬æŠŠä¸ç†è§£è¿™äº›è§„åˆ™çš„äººç§°ä¸ºâ€œæ‰€æœ‰æœºå™¨éƒ½æ˜¯VAXç»¼åˆç—‡â€çš„ç‰ºç‰²å“ã€‚è®°ä½ï¼Œä¸–ä¸Šæ‰€æœ‰ç”µè„‘å¹¶ééƒ½æ˜¯PCã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[The Lost Art of Structure Packing]]></title>
        <id>https://harriswilde.github.io/post/LUjp1bkYi/</id>
        <link href="https://harriswilde.github.io/post/LUjp1bkYi/">
        </link>
        <updated>2020-02-17T08:02:49.000Z</updated>
        <summary type="html"><![CDATA[<p>ã€Šå¤±ä¼ çš„ç»“æ„ä½“æ‰“åŒ…è‰ºæœ¯ã€‹(è‹±æ–‡åŸç‰ˆ)<br>
ä½œè€…ï¼šEric S. Raymond<br>
åŸæ–‡é“¾æ¥ï¼š<a href="http://www.catb.org/esr/structure-packing/">http://www.catb.org/esr/structure-packing/</a></p>
]]></summary>
        <content type="html"><![CDATA[<p>ã€Šå¤±ä¼ çš„ç»“æ„ä½“æ‰“åŒ…è‰ºæœ¯ã€‹(è‹±æ–‡åŸç‰ˆ)<br>
ä½œè€…ï¼šEric S. Raymond<br>
åŸæ–‡é“¾æ¥ï¼š<a href="http://www.catb.org/esr/structure-packing/">http://www.catb.org/esr/structure-packing/</a></p>
<!-- more -->
<h1 id="who-should-read-this">Who should read this</h1>
<p>This page is about a technique for reducing the memory footprint of programs in compiled languages with C-like structures - manually repacking these declarations for reduced size. To read it, you will require basic knowledge of the C programming language.</p>
<p>You need to know this technique if you intend to write code for memory-constrained embedded systems, or operating-system kernels. It is useful if you are working with application data sets so large that your programs routinely hit memory limits. It is good to know in any application where you really, really care about optimizing your use of memory bandwidth and minimizing cache-line misses.</p>
<p>Finally, knowing this technique is a gateway to other esoteric C topics. You are not an advanced C programmer until you have grasped these rules. You are not a master of C until you could have written this document yourself and can criticize it intelligently.</p>
<p>This document originated with &quot;C&quot; in the title, but many of the techniques discussed here also apply to the Go language - and should generalize to any compiled language with C-like structures. There is a note discussing Go and Rust towards the end.</p>
<h1 id="why-i-wrote-it">Why I wrote it</h1>
<p>This webpage exists because in late 2013 I found myself heavily applying an optimization technique that I had learned more than two decades previously and not used much since.</p>
<p>I needed to reduce the memory footprint of a program that used thousands - sometimes hundreds of thousands - of C struct instances. The program was cvs-fast-export and the problem was that it was dying with out-of-memory errors on large repositories.</p>
<p>There are ways to reduce memory usage significantly in situations like this, by rearranging the order of structure members in careful ways. This can lead to dramatic gains - in my case I was able to cut the working-set size by around 40%, enabling the program to handle much larger repositories without dying.</p>
<p>But as I worked, and thought about what I was doing, it began to dawn on me that the technique I was using has been more than half forgotten in these latter days. A little web research confirmed that programmers donâ€™t seem to talk about it much any more, at least not where a search engine can see them. A couple of Wikipedia entries touch the topic, but I found nobody who covered it comprehensively.</p>
<p>There are actually reasons for this that arenâ€™t stupid. CS courses (rightly) steer people away from micro-optimization towards finding better algorithms. The plunging price of machine resources has made squeezing memory usage less necessary. And the way hackers used to learn how to do it back in the day was by bumping their noses on strange hardware architectures - a less common experience now.</p>
<p>But the technique still has value in important situations, and will as long as memory is finite. This document is intended to save programmers from having to rediscover the technique, so they can concentrate effort on more important things.</p>
<h1 id="alignment-requirements">Alignment requirements</h1>
<p>The first thing to understand is that, on modern processors, the way your compiler lays out basic datatypes in memory is constrained in order to make memory accesses faster. Our examples are in C, but any compiled language generates code under the same constraints.</p>
<p>Storage for the basic C datatypes on an x86 or ARM processor doesnâ€™t normally start at arbitrary byte addresses in memory. Rather, each type except char has an alignment requirement; chars can start on any byte address, but 2-byte shorts must start on an even address, 4-byte ints or floats must start on an address divisible by 4, and 8-byte longs or doubles must start on an address divisible by 8. Signed or unsigned makes no difference.</p>
<p>The jargon for this is that basic C types on x86 and ARM are self-aligned. Pointers, whether 32-bit (4-byte) or 64-bit (8-byte) are self-aligned too.</p>
<p>Self-alignment makes access faster because it facilitates generating single-instruction fetches and puts of the typed data. Without alignment constraints, on the other hand, the code might end up having to do two or more accesses spanning machine-word boundaries. Characters are a special case; theyâ€™re equally expensive from anywhere they live inside a single machine word. Thatâ€™s why they donâ€™t have a preferred alignment.</p>
<p>I said &quot;on modern processors&quot; because on some older ones forcing your C program to violate alignment rules (say, by casting an odd address into an int pointer and trying to use it) didnâ€™t just slow your code down, it caused an illegal instruction fault. This was the behavior, for example, on Sun SPARC chips. In fact, with sufficient determination and the right (e18) hardware flag set on the processor, you can still trigger this on x86.</p>
<p>Also, self-alignment is not the only possible rule. Historically, some processors (especially those lacking <a href="https://en.wikipedia.org/wiki/Barrel_shifter">barrel shifters</a>) have had more restrictive ones. If you do embedded systems, you might trip over one of these lurking in the underbrush. Be aware this is possible.</p>
<p>From when it was first written at the beginning of 2014 until late 2016, this section ended with the last paragraph. During that period Iâ€™ve learned something rather reassuring from working with the source code for the reference implementation of NTP. It does packet analysis by reading packets off the wire directly into memory that the rest of the code sees as a struct, relying on the assumption of minimal self-aligned padding.</p>
<p>The interesting news is that NTP has apparently being getting away with this for decades across a very wide span of hardware, operating systems, and compilers, including not just Unixes but under Windows variants as well. This suggests that platforms with padding rules other than self-alignment are either nonexistent or confined to such specialized niches that theyâ€™re never either NTP servers or clients.</p>
<h1 id="padding">Padding</h1>
<p>Now weâ€™ll look at a simple example of variable layout in memory. Consider the following series of variable declarations in the top level of a C module:</p>
<pre><code class="language-c">char *p;
char c;
int x;
</code></pre>
<p>If you didnâ€™t know anything about data alignment, you might assume that these three variables would occupy a continuous span of bytes in memory. That is, on a 32-bit machine 4 bytes of pointer would be immediately followed by 1 byte of char and that immediately followed by 4 bytes of int. And a 64-bit machine would be different only in that the pointer would be 8 bytes.</p>
<p>In fact, the hidden assumption that the allocated order of static variables is their source order is not necessarily valid; the C standards donâ€™t mandate it. Iâ€™m going to ignore this detail because (a) that hidden assumption is usually correct anyway, and (b) the actual purpose of talking about padding and packing outside structures is to prepare you for what happens inside them.</p>
<p>Hereâ€™s what actually happens (on an x86 or ARM or anything else with self-aligned types). The storage for p starts on a self-aligned 4- or 8-byte boundary depending on the machine word size. This is pointer alignment - the strictest possible.</p>
<p>The storage for c follows immediately. But the 4-byte alignment requirement of x forces a gap in the layout; it comes out as though there were a fourth intervening variable, like this:</p>
<pre><code class="language-c">char *p;      /* 4 or 8 bytes */
char c;       /* 1 byte */
char pad[3];  /* 3 bytes */
int x;        /* 4 bytes */
</code></pre>
<p>The <code>pad[3]</code> character array represents the fact that there are three bytes of waste space in the structure. The old-school term for this was &quot;slop&quot;. The value of the padding bits is undefined; in particular it is not guaranteed that they will be zeroed.</p>
<p>Compare what happens if <code>x</code> is a 2-byte short:</p>
<pre><code class="language-c">char *p;
char c;
short x;
</code></pre>
<p>In that case, the actual layout will be this:</p>
<pre><code class="language-c">char *p;      /* 4 or 8 bytes */
char c;       /* 1 byte */
char pad[1];  /* 1 byte */
short x;      /* 2 bytes */
</code></pre>
<p>On the other hand, if x is a long on a 64-bit machine</p>
<pre><code class="language-c">char *p;
char c;
long x;
</code></pre>
<p>we end up with this:</p>
<pre><code class="language-c">char *p;     /* 8 bytes */
char c;      /* 1 byte */
char pad[7]; /* 7 bytes */
long x;      /* 8 bytes */
</code></pre>
<p>If you have been following carefully, you are probably now wondering about the case where the shorter variable declaration comes first:</p>
<pre><code class="language-c">char c;
char *p;
int x;
</code></pre>
<p>If the actual memory layout were written like this</p>
<pre><code class="language-c">char c;
char pad1[M];
char *p;
char pad2[N];
int x;
</code></pre>
<p>what can we say about <code>M</code> and <code>N</code>?</p>
<p>First, in this case <code>N</code> will be zero. The address of <code>x</code>, coming right after <code>p</code>, is guaranteed to be pointer-aligned, which is never less strict than int-aligned.</p>
<p>The value of <code>M</code> is less predictable. If the compiler happened to map <code>c</code> to the last byte of a machine word, the next byte (the first of <code>p</code>) would be the first byte of the next one and properly pointer-aligned. M would be zero.</p>
<p>It is more likely that <code>c</code> will be mapped to the <em>first</em> byte of a machine word. In that case M will be whatever padding is needed to ensure that <code>p</code> has pointer alignment - 3 on a 32-bit machine, 7 on a 64-bit machine.</p>
<p>Intermediate cases are possible. M can be anything from 0 to 7 (0 to 3 on 32-bit) because a char can start on any byte boundary in a machine word.</p>
<p>If you wanted to make those variables take up less space, you could get that effect by swapping <code>x</code> with <code>c</code> in the original sequence.</p>
<pre><code class="language-c">char *p;     /* 8 bytes */
long x;      /* 8 bytes */
char c;      /* 1 byte
</code></pre>
<p>Usually, for the small number of scalar variables in your C programs, bumming out the few bytes you can get by changing the order of declaration wonâ€™t save you enough to be significant. The technique becomes more interesting when applied to nonscalar variables - especially structs.</p>
<p>Before we get to those, letâ€™s dispose of arrays of scalars. On a platform with self-aligned types, arrays of char/short/int/long/pointer have no internal padding; each member is automatically self-aligned at the end of the next one.</p>
<p>All these rules and examples map over to Go with only syntactic changes.</p>
<p>In the next section we will see that the same is <strong>not</strong> necessarily true of structure arrays.</p>
<h1 id="structure-alignment-and-padding">Structure alignment and padding</h1>
<p>In general, a struct instance will have the alignment of its widest scalar member. Compilers do this as the easiest way to ensure that all the members are self-aligned for fast access.</p>
<p>Also, in C (and Go, and Rust) the address of a struct is the same as the address of its first member - there is no leading padding. Beware: in C++, classes that look like structs may break this rule! (Whether they do or not depends on how base classes and virtual member functions are implemented, and varies by compiler.)</p>
<p>(When youâ€™re in doubt about this sort of thing, ANSI C provides an offsetof() macro which can be used to read out structure member offsets.)</p>
<p>Consider this struct:</p>
<pre><code class="language-c">struct foo1 {
    char *p;
    char c;
    long x;
};
</code></pre>
<p>Assuming a 64-bit machine, any instance of <code>struct foo1</code> will have 8-byte alignment. The memory layout of one of these looks unsurprising, like this:</p>
<pre><code class="language-c">struct foo1 {
    char *p;     /* 8 bytes */
    char c;      /* 1 byte
    char pad[7]; /* 7 bytes */
    long x;      /* 8 bytes */
};
</code></pre>
<p>It's laid out exactly as though variables of these types has been separately declared. But if we put <code>c</code> first, that's no longer true.</p>
<pre><code class="language-c">struct foo2 {
    char c;      /* 1 byte */
    char pad[7]; /* 7 bytes */
    char *p;     /* 8 bytes */
    long x;      /* 8 bytes */
};
</code></pre>
<p>If the members were separate variables, <code>c</code> could start at any byte boundary and the size of <code>pad</code> might vary. Because <code>struct foo2</code> has the pointer alignment of its widest member, thatâ€™s no longer possible. Now <code>c</code> has to be pointer-aligned, and following padding of 7 bytes is locked in.</p>
<p>Now letâ€™s talk about trailing padding on structures. To explain this, I need to introduce a basic concept which Iâ€™ll call the <em>stride address</em> of a structure. It is the first address following the structure data that has the <strong>same alignment as the structure.</strong></p>
<p>The general rule of trailing structure padding is this: the compiler will behave as though the structure has trailing padding out to its stride address. This rule controls what <code>sizeof()</code> will return.</p>
<p>Consider this example on a 64-bit x86 or ARM machine:</p>
<pre><code class="language-c">struct foo3 {
    char *p;     /* 8 bytes */
    char c;      /* 1 byte */
};

struct foo3 singleton;
struct foo3 quad[4];
</code></pre>
<p>You might think that <code>sizeof(struct foo3)</code> should be 9, but itâ€™s actually 16. The stride address is that of <code>(&amp;p)[2]</code>. Thus, in the <code>quad</code> array, each member has 7 bytes of trailing padding, because the first member of each following struct wants to be self-aligned on an 8-byte boundary. The memory layout is as though the structure had been declared like this:</p>
<pre><code class="language-c">struct foo3 {
    char *p;     /* 8 bytes */
    char c;      /* 1 byte */
    char pad[7];
};
</code></pre>
<p>For contrast, consider the following example:</p>
<pre><code class="language-c">struct foo4 {
    short s;     /* 2 bytes */
    char c;      /* 1 byte */
};
</code></pre>
<p>Because <code>s</code> only needs to be 2-byte aligned, the stride address is just one byte after <code>c</code>, and <code>struct foo4</code> as a whole only needs one byte of trailing padding. It will be laid out like this:</p>
<pre><code class="language-c">struct foo4 {
    short s;     /* 2 bytes */
    char c;      /* 1 byte */
    char pad[1];
};
</code></pre>
<p>and <code>sizeof(struct foo4)</code> will return 4.</p>
<p>Here's a last important detail: If your structure has structure members, the inner structs want to have the alignment of longest scalar too. Suppose you write this:</p>
<pre><code class="language-c">struct foo5 {
    char c;
    struct foo5_inner {
        char *p;
        short x;
    } inner;
};
</code></pre>
<p>The <code>char *p</code> member in the inner struct forces the outer struct to be pointer-aligned as well as the inner. Actual layout will be like this on a 64-bit machine:</p>
<pre><code class="language-c">struct foo5 {
    char c;           /* 1 byte*/
    char pad1[7];     /* 7 bytes */
    struct foo5_inner {
        char *p;      /* 8 bytes */
        short x;      /* 2 bytes */
        char pad2[6]; /* 6 bytes */
    } inner;
};
</code></pre>
<p>This structure gives us a hint of the savings that might be possible from repacking structures. Of 24 bytes, 13 of them are padding. Thatâ€™s more than 50% waste space!</p>
<h1 id="bitfields">Bitfields</h1>
<p>Now letâ€™s consider C bitfields. What they give you the ability to do is declare structure fields of smaller than character width, down to 1 bit, like this:</p>
<pre><code class="language-c">struct foo6 {
    short s;
    char c;
    int flip:1;
    int nybble:4;
    int septet:7;
};
</code></pre>
<p>The thing to know about bitfields is that they are implemented with word- and byte-level mask and rotate instructions operating on machine words, and cannot cross word boundaries. C99 guarentees that bit-fields will be packed as tightly as possible, provided they donâ€™t cross storage unit boundaries (6.7.2.1 #10).</p>
<p>This restriction is relaxed in C11 (6.7.2.1p11) and C++14 ([class.bit]p1); these revisions do not actually require <code>struct foo9</code> to be 64 bits instead of 32; a bit-field can span multiple allocation units instead of starting a new one. Itâ€™s up to the implementation to decide; GCC leaves it up to the ABI, which for x64 does prevent them from sharing an allocation unit.</p>
<p>Assuming weâ€™re on a 32-bit machine, the C99 rules imply that the layout may look like this:</p>
<pre><code class="language-c">struct foo6 {
    short s;       /* 2 bytes */
    char c;        /* 1 byte */
    int flip:1;    /* total 1 bit */
    int nybble:4;  /* total 5 bits */
    int pad1:3;    /* pad to an 8-bit boundary */
    int septet:7;  /* 7 bits */
    int pad2:25;   /* pad to 32 bits */
};
</code></pre>
<p>But this isnâ€™t the only possibility, because the C standard does not specify that bits are allocated low-to-high. So the layout could look like this:</p>
<pre><code class="language-c">struct foo6 {
    short s;       /* 2 bytes */
    char c;        /* 1 byte */
    int pad1:3;    /* pad to an 8-bit boundary */
    int flip:1;    /* total 1 bit */
    int nybble:4;  /* total 5 bits */
    int pad2:25;   /* pad to 32 bits */
    int septet:7;  /* 7 bits */
};
</code></pre>
<p>That is, the padding could precede rather than following the payload bits.</p>
<p>Note also that, as with normal structure padding, the padding bits are not guaranteed to be zero; C99 mentions this.</p>
<p>Note that the base type of a bit field is interpreted for signedness but not necessarily for size. It is up to implementors whether &quot;short flip:1&quot; or &quot;long flip:1&quot; are supported, and whether those base types change the size of the storage unit the field is packed into.</p>
<p>Proceed with caution and check with -Wpadded if you have it available (e.g. under clang). Compilers on exotic hardware might interpret the C99 rules in surprising ways; older compilers might not quite follow them.</p>
<p>The restriction that bitfields cannot cross machine word boundaries means that, while the first two of the following structures pack into one and two 32-bit words as youâ€™d expect, the third (<code>struct foo9</code>) takes up three 32-bit words in C99, in the last of which only one bit is used.</p>
<pre><code class="language-c">struct foo7 {
    int bigfield:31;      /* 32-bit word 1 begins */
    int littlefield:1;
};

struct foo8 {
    int bigfield1:31;     /* 32-bit word 1 begins /*
    int littlefield1:1;
    int bigfield2:31;     /* 32-bit word 2 begins */
    int littlefield2:1;
};

struct foo9 {
    int bigfield1:31;     /* 32-bit word 1 begins */
    int bigfield2:31;     /* 32-bit word 2 begins */
    int littlefield1:1;
    int littlefield2:1;   /* 32-bit word 3 begins */
};
</code></pre>
<p>Again, C11 and C++14 may pack foo9 tighter, but it would perhaps be unwise to count on this.</p>
<p>On the other hand, <code>struct foo8</code> would fit into a single 64-bit word if the machine has those.</p>
<h1 id="structure-reordering">Structure reordering</h1>
<p>Now that you know how and why compilers insert padding in and after your structures weâ€™ll examine what you can do to squeeze out the slop. This is the art of structure packing.</p>
<p>The first thing to notice is that slop only happens in two places. One is where storage bound to a larger data type (with stricter alignment requirements) follows storage bound to a smaller one. The other is where a struct naturally ends before its stride address, requiring padding so the next one will be properly aligned.</p>
<p>The simplest way to eliminate slop is to reorder the structure members by decreasing alignment. That is: make all the pointer-aligned subfields come first, because on a 64-bit machine they will be 8 bytes. Then the 4-byte ints; then the 2-byte shorts; then the character fields.</p>
<p>So, for example, consider this simple linked-list structure:</p>
<pre><code class="language-c">struct foo10 {
    char c;
    struct foo10 *p;
    short x;
};
</code></pre>
<p>With the implied slop made explicit, here it is:</p>
<pre><code class="language-c">struct foo10 {
    char c;          /* 1 byte */
    char pad1[7];    /* 7 bytes */
    struct foo10 *p; /* 8 bytes */
    short x;         /* 2 bytes */
    char pad2[6];    /* 6 bytes */
};
</code></pre>
<p>Thatâ€™s 24 bytes. If we reorder by size, we get this:</p>
<pre><code class="language-c">struct foo11 {
    struct foo11 *p;
    short x;
    char c;
};
</code></pre>
<p>Considering self-alignment, we see that none of the data fields need padding. This is because the stride address for a (longer) field with stricter alignment is always a validly-aligned start address for a (shorter) field with less strict requirements. All the repacked struct actually requires is trailing padding:</p>
<pre><code class="language-c">struct foo11 {
    struct foo11 *p; /* 8 bytes */
    short x;         /* 2 bytes */
    char c;          /* 1 byte */
    char pad[5];     /* 5 bytes */
};
</code></pre>
<p>Our repack transformation drops the size from 24 to 16 bytes. This might not seem like a lot, but suppose you have a linked list of 200K of these? The savings add up fast - especially on memory-constrained embedded systems or in the core part of an OS kernel that has to stay resident.</p>
<p>Note that reordering is not guaranteed to produce savings. Applying this technique to an earlier example, <code>struct foo5</code>, we get this:</p>
<pre><code class="language-c">struct foo12 {
    struct foo5 {
        char *p;      /* 8 bytes */
        short x;      /* 2 bytes */
    } inner;
    char c;           /* 1 byte*/
};
</code></pre>
<p>With padding written out, this is</p>
<pre><code class="language-c">struct foo12 {
    struct foo5 {
        char *p;      /* 8 bytes */
        short x;      /* 2 bytes */
        char pad[6];  /* 6 bytes */
    } inner;
    char c;           /* 1 byte*/
    char pad[7];      /* 7 bytes */
};
</code></pre>
<p>Itâ€™s still 24 bytes because <code>c</code> cannot back into the inner structâ€™s trailing padding. To collect that gain you would need to redesign your data structures.</p>
<p>Curiously, strictly ordering your structure fields by <em>increasing</em> size also works to mimimize padding. You can minimize padding with any order in which (a) all fields of any one size are in a continuous span (completely eliminating padding between them), and (b) the gaps between those spans are such that the sizes on either side have as few doubling steps of difference from each other as possible. Usually this means no padding at all on one side.</p>
<p>Even more general minimal-padding orders are possible. Example:</p>
<pre><code class="language-c">struct foo13 {
    int32_t i;
    int32_t i2;
    char octet[8];
    int32_t i3;
    int32_t i4;
    int64_t l;
    int32_t i5;
    int32_t i6;
};
</code></pre>
<p>This struct has zero padding under self-alignment rules. Working out why is a useful exercise to develop your understanding.</p>
<p>Since shipping the first version of this guide I have been asked why, if reordering for minimal slop is so simple, C compilers donâ€™t do it automatically. The answer: C is a language originally designed for writing operating systems and other code close to the hardware. Automatic reordering would interfere with a systems programmerâ€™s ability to lay out structures that exactly match the byte and bit-level layout of memory-mapped device control blocks.</p>
<p>Go hews to the C philosophy and does not reorder fields. Rust makes the opposite choice; by default, its compiler may reorder structure fields.</p>
<h1 id="awkward-scalar-cases">Awkward scalar cases</h1>
<p>Using enumerated types instead of #defines is a good idea, if only because symbolic debuggers have those symbols available and can show them rather than raw integers. But, while enums are guaranteed to be compatible with an integral type, the C standard does not specify which underlying integral type is to be used for them.</p>
<p>Be aware when repacking your structs that while enumerated-type variables are usually ints, this is compiler-dependent; they could be shorts, longs, or even chars by default. Your compiler may have a pragma or command-line option to force the size.</p>
<p>The <code>long double</code> type is a similar trouble spot. Some C platforms implement this in 80 bits, some in 128, and some of the 80-bit platforms pad it to 96 or 128 bits.</p>
<p>In both cases it's best to use <code>sizeof()</code> to check the storage size.</p>
<p>Finally, under x86 Linux doubles are sometimes an exception to the self-alignment rule; an 8-byte double may require only 4-byte alignment within a struct even though standalone doubles variables have 8-byte self-alignment. This depends on compiler and options.</p>
<h1 id="readability-and-cache-locality">Readability and cache locality</h1>
<p>While reordering by size is the simplest way to eliminate slop, itâ€™s not necessarily the right thing. There are two more issues: readability and cache locality.</p>
<p>Programs are not just communications to a computer, they are communications to other human beings. Code readability is important even (or especially!) when the audience of the communication is only your future self.</p>
<p>A clumsy, mechanical reordering of your structure can harm readability. When possible, it is better to reorder fields so they remain in coherent groups with semantically related pieces of data kept close together. Ideally, the design of your structure should communicate the design of your program.</p>
<p>When your program frequently accesses a structure, or parts of a structure, it is helpful for performance if the accesses tend to fit within a cache line - the memory block fetched by your processor when it is told to get any single address within the block. On 64-bit x86 a cache line is 64 bytes beginning on a self-aligned address; on other platforms it is often 32 bytes.</p>
<p>The things you should do to preserve readability - grouping related and co-accessed data in adjacent fields - also improve cache-line locality. These are both reasons to reorder intelligently, with awareness of your codeâ€™s data-access patterns.</p>
<p>If your code does concurrent access to a structure from multiple threads, thereâ€™s a third issue: cache line bouncing. To minimize expensive bus traffic, you should arrange your data so that reads come from one cache line and writes go to another in your tighter loops.</p>
<p>And yes, this sometimes contradicts the previous guidance about grouping related data in the same cache-line-sized block. Multithreading is hard. Cache-line bouncing and other multithread optimization issues are very advanced topics which deserve an entire tutorial of their own. The best I can do here is make you aware that these issues exist.</p>
<h1 id="other-packing-techniques">Other packing techniques</h1>
<p>Reordering works best when combined with other techniques for slimming your structures. If you have several boolean flags in a struct, for example, consider reducing them to 1-bit bitfields and packing them into a place in the structure that would otherwise be slop.</p>
<p>Youâ€™ll take a small access-time penalty for this - but if it squeezes the working set enough smaller, that penalty will be swamped by your gains from avoided cache misses.</p>
<p>More generally, look for ways to shorten data field sizes. In cvs-fast-export, for example, one squeeze I applied was to use the knowledge that RCS and CVS repositories didn't exist before 1982. I dropped a 64-bit Unix <code>time_t</code> (zero date at the beginning of 1970) for a 32-bit time offset from 1982-01-01T00:00:00; this will cover dates to 2118. (Note: if you pull a trick like this, do a bounds check whenever you set the field to prevent nasty bugs!)</p>
<p>Each such field shortening not only decreases the explicit size of your structure, it may remove slop and/or create additional opportunities for gains from field reordering. Virtuous cascades of such effects are not very hard to trigger.</p>
<p>The riskiest form of packing is to use unions. If you know that certain fields in your structure are never used in combination with certain other fields, consider using a union to make them share storage. But be extra careful and verify your work with regression testing, because if your lifetime analysis is even slightly wrong you will get bugs ranging from crashes to (much worse) subtle data corruption.</p>
<h1 id="overriding-alignment-rules">Overriding alignment rules</h1>
<p>Sometimes you can coerce your compiler into not using the processorâ€™s normal alignment rules by using a pragma, usually <code>#pragma pack</code>. GCC and clang have a &quot;packed&quot; attribute you can attach to individual structure declarations; GCC has an -fpack-struct option for entire compilations.</p>
<p>Do not do this casually, as it forces the generation of more expensive and slower code. Usually you can save as much memory, or almost as much, with the techniques I describe here.</p>
<p>The only good reason for <code>#pragma pack</code> is if you have to exactly match your C data layout to some kind of bit-level hardware or protocol requirement, like a memory-mapped hardware port, and violating normal alignment is required for that to work. If youâ€™re in that situation, and you donâ€™t already know everything else Iâ€™m writing about here, youâ€™re in deep trouble and I wish you luck.</p>
<h1 id="tools">Tools</h1>
<p>The clang compiler has a -Wpadded option that causes it to generate messages about alignment holes and padding. Some versions also have an undocumented -fdump-record-layouts option that yields <a href="http://lists.cs.uiuc.edu/pipermail/cfe-dev/2014-July/037778.html">more information</a>.</p>
<p>If you're using C11, you can deploy static_assert to check your assumptions about type and structure sizes. Example:</p>
<pre><code class="language-c">#include &lt;assert.h&gt;
struct foo4 {
    short s;     /* 2 bytes */
    char c;      /* 1 byte */
};
static_assert(sizeof(struct foo4) == 4, &quot;Check your assumptions&quot;);
</code></pre>
<p>I have not used it myself, but several respondents speak well of a program called pahole. This tool cooperates with a compiler to produce reports on your structures that describe padding, alignment, and cache line boundaries. This was at one time a standalone C program, but that is now unmaintained; s script with the name pahole now ships with gdb and that is what you should use.</p>
<p>Iâ€™ve received a report that a proprietary code auditing tool called &quot;PVS Studio&quot; can detect structure-packing opportunities.</p>
<h1 id="proof-and-exceptional-cases">Proof and exceptional cases</h1>
<p>You can download sourcecode for a little program that demonstrates the assertions about scalar and structure sizes made above. It is <a href="http://www.catb.org/esr/structure-packing/packtest.c">packtest.c</a>.</p>
<p>If you look through enough strange combinations of compilers, options, and unusual hardware, you will find exceptions to some of the rules I have described. They get more common as you go back in time to older processor designs.</p>
<p>The next level beyond knowing these rules is knowing how and when to expect that they will be broken. In the years when I learned them (the early 1980s) we spoke of people who didnâ€™t get this as victims of &quot;all-the-worldâ€™s-a-VAX syndrome&quot;. Remember that not all the world is a PC.</p>
<h1 id="go-and-rust">Go and Rust</h1>
<p>The Go language is in many respects similar to C. It has structures and arrays, though not bitfields or unions. Go compilers have the same optimization and alignment issues as C compilers. One important difference is that the Go specification <strong>requires</strong> structure fields to be self-aligned. As in C, array elements are padded up to the following stride address.</p>
<p>Therefore, if you know the implications of self-aligment in C, you can apply them directly to calculating sizes and offsets in Go and to space-optimizing Go structures. The obvious correspondence mostly works.</p>
<p>I say &quot;mostly&quot; because Go has one odd quirk. Since Go 1.5, a zero-length field at the end of a struct (that is, a zero-length array or empty struct) is sized and aligned as though it is one byte. The reasons for this are discussed in an essay <a href="https://dave.cheney.net/2015/10/09/padding-is-hard">Padding is Hard</a> by one of the Go developers.</p>
<p>Rust follows C-like field alignment rules if a structure is annotated with &quot;repr(C)&quot;. Otherwise (by default) all bets are off: padding rules are (deliberately) unspecified and the compiler may even reorder structure members. It is probably best to let the Rust compiler do space optimization rather than forcing it.</p>
<h1 id="supporting-this-work">Supporting this work</h1>
<p>If you were educated or entertained by this document, please sign up for my <a href="https://www.patreon.com/esr">Patreon feed</a>. The time needed to write and maintain documents like this one is not free, and while I enjoying giving them to the world my bills wonâ€™t pay themselves. Even a few dollars a month - from enough of you - helps a lot.</p>
<h1 id="related-reading">Related Reading</h1>
<p>This section exists to collect pointers to essays which I judge to be good companions to this one.</p>
<p><a href="http://blog.regehr.org/archives/213">A Guide to Undefined Behavior in C and C++</a></p>
<p><a href="http://www.catb.org/esr/time-programming/">Time, Clock, and Calendar Programming In C</a></p>
<p><a href="http://www.catb.org/esr/faqs/things-every-hacker-once-knew/">Things Every Hacker Once Knew</a></p>
<h1 id="version-history">Version history</h1>
<p>2.2 @ 2019-12-19 Minor markup fix.</p>
<p>2.1 @ 2019-02-14 Correct a minor error in one of the examples pointed out by Luis Emilio Moreno DurÃ¡n.</p>
<p>2.0 @ 2018-08-06 Drop &quot;C&quot; out of the title as these techniques are applicable to Go and Rust as well. More coverage of Go and Rust. The pahole tool has been replaced by a script in the gdb distribution.</p>
<p>1.19 @ 2018-02-12 Describe usefulness of static_assert() in C11. Added Go and Rust coverage.</p>
<p>1.18 @ 2017-06-01 More general zero-padding orders. C11 and C14 relax a constraint on bitfield packing.</p>
<p>1.17 @ 2016-11-14 Typo fixes.</p>
<p>1.16 @ 2016-10-21 Answer an objection about allocation order being unrelated to source order.</p>
<p>1.15 @ 2016-10-20 Note the field evidence from NTP.</p>
<p>1.14 @ 2015-12-19 Typo correction: -Wpadding â†’ -Wpadded.</p>
<p>1.13 @ 2015-11-23 Be explicit about padding bits being undefined. More about bitfields.</p>
<p>1.12 @ 2015-11-11 Major revision of section on bitfields reflecting C99 rules.</p>
<p>1.11 @ 2015-07-23 Mention the clang -fdump-record-layouts option.</p>
<p>1.10 @ 2015-02-20 Mention attributepacked, -fpack-struct, and PVS Studio.</p>
<p>1.9 @ 2014-10-01 Added link to &quot;Time, Clock, and Calendar Programming In C&quot;.</p>
<p>1.8 @ 2014-05-20 Improved explanation for the bitfield examples,</p>
<p>1.7 @ 2014-05-17 Correct a minor error in the description of the layout of struct foo8.</p>
<p>1.6 @ 2014-05-14 Emphasize that bitfields cannot cross word boundaries. Idea from Dale Gulledge.</p>
<p>1.5 @ 2014-01-13 Explain why structure member reordering is not done automatically.</p>
<p>1.4 @ 2014-01-04 A note about double under x86 Linux.</p>
<p>1.3 @ 2014-01-03 New sections on awkward scalar cases, readability and cache locality, and tools.</p>
<p>1.2 @ 2014-01-02 Correct an erroneous address calculation.</p>
<p>1.1 @ 2014-01-01Explain why aligned accesses are faster. Mention offsetof. Various minor fixes, including the packtest.c download link.</p>
<p>1.0 @ 2014-01-01 Initial release.</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ’åºç®—æ³•ï¼šæ’å…¥æ’åºå’Œå¸Œå°”æ’åº]]></title>
        <id>https://harriswilde.github.io/post/nTjkYzZnf/</id>
        <link href="https://harriswilde.github.io/post/nTjkYzZnf/">
        </link>
        <updated>2020-02-14T08:57:50.000Z</updated>
        <content type="html"><![CDATA[<h1 id="æ’å…¥æ’åº">æ’å…¥æ’åº</h1>
<p>ç–«æƒ…æœŸé—´ï¼Œå¤§å®¶éƒ½é—²åäº†å§ï¼Ÿåº”è¯¥æ²¡å°‘æ‰“æ‰‘å…‹ç‰Œå§ã€‚è®¾æƒ³ä¸€ä¸‹ï¼Œä½ ä»ç‰Œå †ä¸­æ‘¸ç‰Œçš„æ—¶å€™ï¼Œå¤§æ¦‚ç‡æ˜¯ä¹±åºçš„ã€‚é‚£ä¹ˆä½ æ˜¯æ€ä¹ˆæ ·æŠŠä¹±åºçš„ç‰Œæ•´ç†æˆæœ‰åºçš„å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆä½ ä¼šå‡å®šç¬¬ä¸€å¼ ç‰Œæ˜¯æœ‰åºçš„ï¼Œç„¶åæŠŠåé¢çš„ç‰Œä¸æ–­åœ°æ’åˆ°å‰é¢çš„æœ‰åºç‰Œé‡Œçš„åˆé€‚ä½ç½®ï¼Œæœ€åï¼Œç‰Œå°±ä»æ— åºçš„å˜æˆæœ‰åºçš„äº†ã€‚</p>
<p>é‚£ä¹ˆï¼Œæ’å…¥æ’åºä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œçœ‹ä¸‹é¢åŠ¨ç”»ï¼Œ<strong>è“è‰²çš„ä»£è¡¨ä¹±åºï¼Œç»¿è‰²ä»£è¡¨æœ‰åºï¼Œæ©™è‰²çš„ä»£è¡¨æ­£åœ¨æ¯”è¾ƒ</strong>ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://s2.ax1x.com/2020/02/14/1XmBB4.gif" alt="æ’å…¥æ’åº" loading="lazy"></figure>
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="language-c">//C
void sort(int arr[])
{
    for (int i = 1; i &lt; sizeof(arr)/sizeof(arr[0]); i++)
    {
        int value = arr[i];
        for (j = i - 1; j &gt;= 0; j--)
        {
            if (arr[j] &gt; value)
            {
                arr[j+1] = arr[j]; //ç§»åŠ¨æ•°æ®
            }
            else
            {
                break;
            }
        }
        arr[j+1] = value; //æ’å…¥æ•°æ®
    }
}
</code></pre>
<pre><code class="language-java">//Java
public static void sort(int[] arr) {
    int n = arr.length;
    for (int i = 1; i &lt; n; ++i) {
        int value = arr[i];
        int j = 0;//æ’å…¥çš„ä½ç½®
        for (j = i-1; j &gt;= 0; j--) {
            if (arr[j] &gt; value) {
                arr[j+1] = arr[j];//ç§»åŠ¨æ•°æ®
            } else {
                break;
            }
        }
        arr[j+1] = value; //æ’å…¥æ•°æ®
    }
}
</code></pre>
<pre><code class="language-python">#Python
def sort(arr):
    for i in range(1, len(arr)):
        value = arr[i]
        for j in range(0, i-1, -1):
            if arr[j] &gt; value:
                arr[j+1] = arr[j];
            else:
                break
        arr[j+1] = value
</code></pre>
<p>æ’å…¥æ’åºæ˜¯<strong>ç¨³å®šæ’åº</strong>ã€‚</p>
<p>è¿™ç§ç®—æ³•æ„Ÿè§‰æ¯”å†’æ³¡ä»€ä¹ˆçš„å¿«ä¸€äº›ï¼ˆå®é™…ä¸Šæ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>O</mi><mrow><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">O_{(n^2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä½†å—æ•°æ®å½±å“è¾ƒå¤§ï¼‰ï¼Œä½†æ˜¯å¦‚æœæ•°æ®é‡å¾ˆå¤§çš„è¯ï¼Œé‚£ä¹ˆè¿™æ ·æŒ¨ä¸ªæ¯”è¾ƒçš„è¯ï¼Œæ•ˆç‡å°±éå¸¸ä½äº†ã€‚</p>
<p>å› æ­¤ï¼Œäººä»¬å°±æƒ³å‡ºä¸€ä¸ªåŠæ³•ï¼šä½¿ç”¨äºŒåˆ†æ³•æ¥æŸ¥æ‰¾ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“åé¢çš„æ•°æ®æƒ³è¦æ’å…¥å‰é¢çš„æœ‰åºæ•°åˆ—çš„æ—¶å€™ï¼Œä¸æ˜¯æŒ¨ä¸ªæŒ¨ä¸ªæ¯”è¾ƒï¼Œè€Œæ˜¯ç›´æ¥å’Œæœ‰åºæ•°åˆ—çš„ä¸­é—´å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå‡è®¾å¤§äºä¸­é—´å€¼ï¼Œå°±å’Œä¸­é—´å€¼åˆ°æœ«å°¾çš„ä¸€æ®µçš„æ•°åˆ—çš„ä¸­é—´å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€ç›´æŒç»­ä¸‹å»ç›´åˆ°æ‰¾åˆ°æ­£ç¡®çš„ä½ç½®ã€‚è¿™æ ·åœ¨ç†æƒ³æƒ…å†µä¸‹å¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚</p>
<p>ä½†æ˜¯åœ¨æ•°æ®åˆ†å¸ƒæ¯”è¾ƒæ•£çš„æƒ…å†µä¸‹ï¼Œæœ‰æ—¶å€™è¿˜æ˜¯éœ€è¦ç§»åŠ¨å¾ˆå¤šä½ã€‚é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œäººä»¬å°±å¼€å§‹ç€æ‰‹æ”¹è¿›æ’å…¥æ’åºï¼Œå…¶ä¸­å¸Œå°”æ”¹è¿›çš„æ’å…¥æ’åºæœ€ä¸ºå‡ºåï¼Œä¹Ÿå°±æ˜¯<strong>å¸Œå°”æ’åº</strong>ã€‚</p>
<h1 id="å¸Œå°”æ’åº">å¸Œå°”æ’åº</h1>
<p>å¸Œå°”æ’åºæ”¹è¿›äº†æ’å…¥æ’åºçš„ç¼ºç‚¹ï¼Œå¯ä»¥å®ç°å…ƒç´ çš„è·³è·ƒç§»åŠ¨ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://s2.ax1x.com/2020/02/14/1jcQdU.gif" alt="å¸Œå°”æ’åº" loading="lazy"></figure>
<p>å¸Œå°”æ’åºåˆå«åš<strong>ç¼©å°å¢é‡æ’åº</strong>ï¼Œå›¾ä¸­çš„<strong>Gap</strong>å°±æ˜¯å¢é‡çš„æ„æ€ã€‚æ‰€è°“å¢é‡ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè·¨åº¦ã€‚æ’å…¥æ’åºä¸­å¹¿ä¸ºè¯Ÿç—…çš„ä¾æ¬¡ç§»åŠ¨ï¼Œå½“åŠ ä¸Šäº†è·¨åº¦ä¹‹åå°±å¯ä»¥å®ç°è·³è·ƒç§»åŠ¨ã€‚è€Œæ¯ä¸€è½®æ’å®Œä¹‹åè·¨åº¦éƒ½ä¼šå‡å°ï¼Œç›´åˆ°è·¨åº¦ä¸º1ï¼Œå°±å®Œæˆäº†æ’åºã€‚å®é™…ä¸Šï¼Œè·¨åº¦ä¸º1çš„æ—¶å€™å°±æ˜¯æ™®é€šçš„æ’å…¥æ’åºã€‚åªä¸è¿‡ç»è¿‡äº†å‰é¢çš„æ´—ç¤¼ä¹‹åï¼Œæ•°æ®å·²ç»åŸºæœ¬å˜å¾—æœ‰åºäº†ï¼Œæœ€åä¸€è½®çš„æ’å…¥åªæ˜¯å¾ˆç®€å•åœ°å®Œå–„ä¸€ä¸‹è€Œå·²ã€‚</p>
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="language-c">void shellSort( long int array[], int length)
{
    int i;
    int j;
    int k;
    int gap;    //gapæ˜¯åˆ†ç»„çš„æ­¥é•¿
    long int temp;   //å¸Œå°”æ’åºæ˜¯åœ¨ç›´æ¥æ’å…¥æ’åºçš„åŸºç¡€ä¸Šå®ç°çš„,æ‰€ä»¥ä»ç„¶éœ€è¦å“¨å…µ
    for(gap=length/2; gap&gt;0; gap=gap/2)
    {
        //ä»¥GAPä¸ºé—´éš”åˆ†ç»„
        for(i=0; i&lt;gap; i++)
        {
            /*
             æ¯ä¸€ç»„åšæ’å…¥æ’åº
             */
            for(j=i+gap; j&lt;length; j=j+gap)
            {
                //å¦‚æœå½“å‰å…ƒç´ æ¯”è¿™ä¸€ç»„ä¸­çš„å‰ä¸€ä¸ªå…ƒç´ è¦å°
                if(array[j] &lt; array[j - gap])
                {
                    //è®°å½•å½“å‰è¿™ä¸ªæ›´å°çš„å…ƒç´  temp
                    temp = array[j];    //å“¨å…µ
                    k = j - gap;
                    //æŠŠè¿™ä¸€ç»„ä¸­ä¹‹å‰æ‰€æœ‰æ¯”tempå°çš„å…ƒç´ éƒ½å¾€åæŒªä¸€ä¸ªä½ç½®
                    while(k&gt;=0 &amp;&amp; array[k]&gt;temp)
                    {
                        array[k + gap] = array[k];
                        k = k - gap;
                    }
                    //æŠŠæŒªå‡ºæ¥çš„ç©ºä½ï¼Œæ”¾å…¥temp
                    array[k + gap] = temp;
                }
            }
        }
    }
}
</code></pre>
<pre><code class="language-java">//Java
public static void shell_sort(int[] arr) {
    int length = arr.length;
    //åŒºé—´
    int gap = 1;
    while (gap &lt; length) {
        gap = gap * 3 + 1;
    }
    while (gap &gt; 0) {
        for (int i = gap; i &lt; length; i++) {
            int tmp = arr[i];
            int j = i - gap;
            //è·¨åŒºé—´æ’åº
            while (j &gt;= 0 &amp;&amp; arr[j] &gt; tmp) {
                arr[j + gap] = arr[j];
                j -= gap;
            }
            arr[j + gap] = tmp;
        }
        gap = gap / 3;
    }
}
</code></pre>
<pre><code class="language-python">#Python
def shell_sort(arr):
	gap = len(arr)//3 + 1
	while gap &gt; 0:
		for i in range(gap):
			for j in range(i + gap, len(arr), gap):
				if arr[j] &lt; arr[j - gap]:
					temp = arr[j]
					k = j - gap
					while k &gt;= 0 and arr[k] &gt; temp:
						arr[k + gap] = arr[k]
						k -= gap
					arr[k + gap] = temp
		if gap == 1:
			break
		gap = gap//3 + 1
</code></pre>
<p>è‡³äºè¿™ä¸ªå¢é‡gapåˆ°åº•è¯¥å–å¤šå°‘ï¼Œç›®å‰æ²¡æœ‰å®šè®ºã€‚æœ€åˆshellæå‡ºå–<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>a</mi><mi>p</mi><mo>=</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">gap=\frac{n}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>å‘ä¸‹å–æ•´ï¼Œ<code>gap /= 2</code>å‘ä¸‹å–æ•´ï¼Œç›´åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>a</mi><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">gap=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ã€‚ä½†ç”±äºç›´åˆ°æœ€åä¸€æ­¥ï¼Œåœ¨å¥‡æ•°ä½ç½®çš„å…ƒç´ æ‰ä¼šä¸å¶æ•°ä½ç½®çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ ·ä½¿ç”¨è¿™ä¸ªåºåˆ—çš„æ•ˆç‡ä¼šå¾ˆä½ã€‚åæ¥Knuthæå‡ºå–<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>a</mi><mi>p</mi><mo>=</mo><mi>n</mi><mo>âˆ£</mo><mn>3</mn><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">gap = n\mid 3 +1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>è¿˜æœ‰äººæå‡ºéƒ½å–å¥‡æ•°ä¸ºå¥½ï¼Œä¹Ÿæœ‰äººæå‡ºgapäº’è´¨ä¸ºå¥½ã€‚åº”ç”¨ä¸åŒçš„åºåˆ—ä¼šä½¿å¸Œå°”æ’åºç®—æ³•çš„æ€§èƒ½æœ‰å¾ˆå¤§çš„å·®å¼‚ã€‚</p>
<p>æœ€åï¼Œå¸Œå°”æ’åºæ˜¯ä¸€ä¸ªä¸ç¨³å®šæ’åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>O</mi><mrow><mo>(</mo><msup><mi>n</mi><mn>1.3</mn></msup><mo>)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">O_{(n^{1.3})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">.</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ’åºç®—æ³•ï¼šé€‰æ‹©æ’åº]]></title>
        <id>https://harriswilde.github.io/post/FojWe45tS/</id>
        <link href="https://harriswilde.github.io/post/FojWe45tS/">
        </link>
        <updated>2020-02-13T08:02:58.000Z</updated>
        <content type="html"><![CDATA[<p>æ‰€è°“é€‰æ‹©æ’åºï¼Œå°±æ˜¯æ¯æ¬¡å°†å‰©ä½™åŒºé—´å†…æœ€å¤§ï¼ˆæˆ–è€…æœ€å°ï¼‰çš„æ•°æ”¾åœ¨æœ€å³è¾¹ï¼ˆæˆ–è€…æœ€å·¦è¾¹ï¼‰ï¼Œä»è€Œè¾¾åˆ°æ’åºçš„ç®—æ³•ã€‚ä¹‹æ‰€ä»¥å«åš<strong>é€‰æ‹©æ’åº</strong>ï¼Œæ˜¯å› ä¸ºæ¯ä¸€æ¬¡éƒ½é€‰å‡ºå‰©ä¸‹çš„æœ€å¤§æˆ–è€…æœ€å°å€¼æ¥è¾¾åˆ°æ’åºã€‚</p>
<p>çœ‹åŠ¨ç”»ï¼š</p>
<img src="https://s2.ax1x.com/2020/02/13/1L9TK0.gif" alt="é€‰æ‹©æ’åº" style="zoom:67%;" />
<p>å¦‚å›¾ï¼Œæ¯æ¬¡å°†æœ€å¤§çš„æ”¾åœ¨å³è¾¹ï¼Œéå†å®Œæˆä¹‹åå°±æ˜¯ä¸€ä¸ªæœ‰åºæ•°åˆ—äº†ã€‚</p>
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="language-c">//C
#include &lt;stdio.h&gt;
void sort(int arr[])
{
    for (int i = sizeof(arr)/sizeof(arr[0]) - 1; i &gt;= 0; i--)
    {
        for(int j = 0; j &lt; i; j++)
        {
            int temp = 0;
            if (arr[j] &gt; arr[i])
            {
                temp = arr[j];
                arr[j] = arr[i];
                arr[i] = temp;
            }
        }
    }
}

</code></pre>
<pre><code class="language-java">//Java
public class SelectionSort implements IArraySort {

    @Override
    public int[] sort(int[] sourceArray) throws Exception {
        int[] arr = Arrays.copyOf(sourceArray, sourceArray.length);

        // æ€»å…±è¦ç»è¿‡ N-1 è½®æ¯”è¾ƒ
        for (int i = 0; i &lt; arr.length - 1; i++) {
            int min = i;

            // æ¯è½®éœ€è¦æ¯”è¾ƒçš„æ¬¡æ•° N-i
            for (int j = i + 1; j &lt; arr.length; j++) {
                if (arr[j] &lt; arr[min]) {
                    // è®°å½•ç›®å‰èƒ½æ‰¾åˆ°çš„æœ€å°å€¼å…ƒç´ çš„ä¸‹æ ‡
                    min = j;
                }
            }

            // å°†æ‰¾åˆ°çš„æœ€å°å€¼å’Œiä½ç½®æ‰€åœ¨çš„å€¼è¿›è¡Œäº¤æ¢
            if (i != min) {
                int tmp = arr[i];
                arr[i] = arr[min];
                arr[min] = tmp;
            }

        }
        return arr;
    }
}
</code></pre>
<pre><code class="language-python">#Python
def sort(arr):
    for i in range(0, len(arr), -1):
        for j in range(0, i):
            if arr[j] &gt; arr[i]:
                arr[j], arr[i] = arr[i], arr[j]
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ’åºç®—æ³•ï¼šå†’æ³¡æ’åºåŠå…¶ä¼˜åŒ–]]></title>
        <id>https://harriswilde.github.io/post/wi0begzME/</id>
        <link href="https://harriswilde.github.io/post/wi0begzME/">
        </link>
        <updated>2020-02-13T04:21:33.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å†’æ³¡æ’åº">å†’æ³¡æ’åº</h1>
<p>å†’æ³¡æ’åºå±äºå‡ ç§æ’åºç®—æ³•é‡Œé¢çš„æœ€ç®€å•çš„ä¸€ç§ï¼Œä¸éœ€è¦ä»€ä¹ˆé«˜æ·±çš„æ€ç»´ï¼Œå°±å¯ä»¥å¾ˆå¿«ç†è§£ã€‚</p>
<p>å†’æ³¡æ’åºå®é™…ä¸Šå°±æ˜¯æŠŠç›¸é‚»çš„æ•°ç›¸äº’æ¯”è¾ƒï¼ŒæŠŠå¤§çš„æ”¾å³è¾¹ï¼ˆæˆ–è€…å·¦è¾¹ï¼Œè¿™å–å†³äºä½ æƒ³é¡ºåºæ’è¿˜æ˜¯å€’åºæ’ï¼‰ã€‚å¦‚æœæŠŠå¤§çš„æ”¾å³è¾¹ï¼Œé‚£ä¹ˆç¬¬ä¸€è½®éå†ä¹‹åï¼Œå°±ä¼šæŠŠè¿™ç»„æ•°æ®ä¸­æœ€å¤§çš„æ”¾åˆ°æœ€åè¾¹ã€‚</p>
<p>æ­¤æ—¶ï¼Œæœ€åä¸€ä¸ªå·²ç»æ˜¯å›ºå®šçš„äº†ï¼Œä¾æ¬¡æŠŠå‰é¢çš„æŒ‰ç…§è¿™æ ·çš„å¥—è·¯æ’åºä¸‹å»å°±è¡Œäº†ã€‚</p>
<p>ä¸‹é¢è¿™ä¸ªåŠ¨ç”»å¯èƒ½ä¼šæ›´ç›´è§‚åœ°å¸®åŠ©ä½ ç†è§£ï¼š</p>
<img src="https://s2.ax1x.com/2020/02/13/1qJg2R.gif" alt="å†’æ³¡æ’åº" style="zoom:67%;" />
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<p>C:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
void sort(int arr[])
{
    for (int i = 0; i &lt; sizeof(arr)/sizeof(arr[0]) - 1; i++)
    {
        for(int j = 0; j &lt; sizeof(arr)/sizeof(arr[0]) - 1 - i; j++)
        {
            int temp = 0;
            if (arr[j] &gt; arr[j + 1])
            {
                temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }
}
</code></pre>
<p>Java:</p>
<pre><code class="language-java">public static void sort(int arr[]){
    for( int i = 0 ; i &lt; arr.length - 1 ; i++ ){
        for(int j = 0;j &lt; arr.length - 1 - i ; j++){
            int temp = 0;
            if(arr[j] &gt; arr[j + 1]){
                temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }
}
</code></pre>
<p>Python:</p>
<pre><code class="language-python">def sort(arr):
    for i in range(len(arr)):
        for j in range(len(arr) - i):
            if arr[j] &gt; arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
</code></pre>
<p>æˆ‘ä»¬çœ‹åˆ°åŒå±‚å¾ªç¯ï¼Œå°±ä¸éš¾æ¨å‡ºè¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>O</mi><mrow><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">O_{(n^2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä¸”ä¸ºç¨³å®šæ’åºã€‚</p>
<p>å…¶å®é€šè¿‡æˆ‘ä»¬ä¸Šé¢çš„åŠ¨å›¾å‘ç°ï¼Œå½“æ’åˆ°ç¬¬4è½®çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ•´ä¸ªåˆ—è¡¨å°±å·²ç»æ˜¯æœ‰åºçš„äº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„å‡ è½®ï¼Œå°±æ˜¯åœ¨æµªè´¹æ—¶é—´å’Œèµ„æºã€‚é‚£ä¹ˆæ—¢ç„¶å¦‚æ­¤ï¼Œæœ‰æ²¡æœ‰ä¼˜åŒ–çš„æ–¹æ¡ˆå‘¢ï¼Ÿ</p>
<p>å½“ç„¶æ˜¯æœ‰çš„ã€‚</p>
<h1 id="å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆé¸¡å°¾é…’æ’åº">å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆï¼šé¸¡å°¾é…’æ’åº</h1>
<p>æˆ‘ä»¬æ‰€è®¾æƒ³çš„ï¼Œåº”è¯¥æ˜¯è¿™æ ·ï¼š</p>
<img src="https://s2.ax1x.com/2020/02/13/1qGs1I.gif" alt="å†’æ³¡ä¼˜åŒ–" style="zoom:67%;" />
<p>è¿™ä¸ªæ€è·¯ä¹Ÿå¾ˆå¥½å®ç°ã€‚åªéœ€è¦è®¾ä¸€ä¸ªå˜é‡ç”¨æ¥åšæ ‡è®°ï¼Œå½“æŸä¸€æ¬¡éå†çš„æ—¶å€™ï¼Œä¸€ä¸ªå…ƒç´ éƒ½æ²¡æœ‰æ›¿æ¢ï¼Œé‚£ä¹ˆå°±å¯ä»¥è§†ä¸ºå·²ç»æœ‰åºï¼Œåé¢çš„éå†å°±å…¨çœäº†ã€‚</p>
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<p>C:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
void sort(int arr[])
{
    for (int i = 0; i &lt; sizeof(arr)/sizeof(arr[0]) - 1; i++)
    {
        int flag = 1;//è®¾ç½®æ ‡è®°ï¼Œæ¯è½®å¾ªç¯éƒ½åˆå§‹åŒ–ä¸º1
        for(int j = 0; j &lt; sizeof(arr)/sizeof(arr[0]) - 1 - i; j++)
        {
            int temp = 0;
            if (arr[j] &gt; arr[j + 1])
            {
                temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
                flag = 0;//å½“å‘ç”Ÿå…ƒç´ äº¤æ¢çš„æ—¶å€™ï¼Œå°†å…¶æ”¹å˜ä¸º0
            }
        }
        if (flag)//å½“æ ‡è®°ä¸ºçœŸã€‚å³ä¸º1çš„æ—¶å€™ï¼Œè·³å‡ºå¾ªç¯
        {
            break;
        }
    }
}
</code></pre>
<p>Java:</p>
<pre><code class="language-java">public static void sort(int arr[]){
    for( int i = 0;i &lt; arr.length - 1 ; i++ ){
        boolean flag = true;//è®¾ç½®å¸ƒå°”å˜é‡ï¼Œæ¯è½®å¾ªç¯åˆå§‹åŒ–ä¸ºçœŸ
        for( int j = 0;j &lt; arr.length - 1 - i ; j++ ){
            int temp = 0;
            if(arr[j] &lt; arr[j + 1]){
                temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
                flag = false;//æœ‰å˜é‡äº¤æ¢ï¼Œå°±æ›´æ”¹ä¸ºå‡
            }
        }
        if(flag){//è‹¥ä¸€è½®å¾ªç¯ä¸­æ²¡æœ‰æ”¹å˜å˜é‡ï¼Œåˆ™è·³å‡ºå¾ªç¯
            break;
        }
    }
}
</code></pre>
<p>Python:</p>
<pre><code class="language-python">def sort(arr):
    for i in range(len(arr)):
        flag = True #æ­¤å¤„è®¾ç½®æ ‡è®°
        for j in range(len(arr) - i):
            if arr[j] &gt; arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
                flag = False #è‹¥æœ‰å…ƒç´ è¢«äº¤æ¢ï¼Œåˆ™æ›´æ”¹æ ‡è®°
        if flag: #è‹¥ä¸€è½®ä¸­æ²¡æœ‰ä»»ä½•å˜é‡è¢«äº¤æ¢ï¼Œåˆ™è·³å‡ºå¾ªç¯
            break
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Pythonåºåˆ—ã€åˆ—è¡¨åŠå…¶æ–¹æ³•]]></title>
        <id>https://harriswilde.github.io/post/NEar5wUsO/</id>
        <link href="https://harriswilde.github.io/post/NEar5wUsO/">
        </link>
        <updated>2020-02-11T13:40:02.000Z</updated>
        <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€èŠ‚é‡Œé¢æˆ‘ä»¬è®²åˆ°äº†å˜é‡ã€‚ä½†æ˜¯ï¼Œç”Ÿæ´»ä¸­ä¹Ÿå¹¶ä¸æ˜¯å“ªé‡Œçš„æ•°æ®éƒ½é€‚åˆä½¿ç”¨å˜é‡æ¥å­˜å‚¨ã€‚æ¯”å¦‚ï¼Œä¸€äº›æˆå †å‡ºç°çš„æ•°æ®ã€‚é‚£ä¹ˆï¼Œæœ¬èŠ‚å°±è¦å¼•å…¥ä¸€ä¸ªæ–°çš„æ¦‚å¿µï¼š<strong>æ•°æ®ç»“æ„</strong>ã€‚</p>
<p>æ‰€è°“æ•°æ®ç»“æ„ï¼Œå®é™…ä¸Šå°±æ˜¯é€šè¿‡æŸç§æ–¹å¼ï¼ˆæ¯”å¦‚ç»™å…ƒç´ ç¼–å·ï¼‰ï¼Œç»„ç»‡åœ¨ä¸€èµ·çš„æ•°æ®é›†åˆã€‚åœ¨Pythonä¸­ï¼Œæœ€åŸºæœ¬çš„æ•°æ®ç»“æ„å°±æ˜¯<strong>åºåˆ—(sequence)</strong>ã€‚åºåˆ—ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½è¢«åˆ†é…ä¸€ä¸ªåºå·ï¼Œä¹Ÿå°±æ˜¯å…ƒç´ çš„ä½ç½®ï¼Œç§°ä¹‹ä¸º<strong>ç´¢å¼•</strong>ã€‚ä½†æ˜¯ï¼ŒPythonçš„ç´¢å¼•æ˜¯<strong>ä»0å¼€å§‹</strong>ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ä¹ æƒ¯çš„ä»1å¼€å§‹ã€‚</p>
<p>PythonåŒ…æ‹¬6ä¸­å†…å»ºåºåˆ—ï¼šåˆ—è¡¨(list)ï¼Œå…ƒç»„(tuple)ï¼Œå­—ç¬¦ä¸²(string)ï¼ŒUnicodeå­—ç¬¦ä¸²(Unicode string)ï¼Œbufferå¯¹è±¡å’Œxrangeå¯¹è±¡ã€‚æœ¬èŠ‚åªè®¨è®º<strong>åˆ—è¡¨</strong>å’Œ<strong>å…ƒç»„</strong>ã€‚</p>
<p>å¦å¤–ï¼Œåºåˆ—ä¸­çš„å…ƒç´ ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œå¦‚ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; edward = ['Edward Gumby', 42]
&gt;&gt;&gt; john = ['John Smith', 50]
&gt;&gt;&gt; database = [edward, john]
&gt;&gt;&gt; database
[['Edward Gumby', 42], ['John Smith', 50]]
</code></pre>
<h1 id="é€šç”¨åºåˆ—æ“ä½œ">é€šç”¨åºåˆ—æ“ä½œ</h1>
<p>æ‰€æœ‰ä¸‹åºåˆ—ç±»å‹éƒ½å¯ä»¥è¿›è¡ŒæŸäº›ç‰¹å®šçš„æ“ä½œã€‚åŒ…æ‹¬<strong>ç´¢å¼•(indexing)</strong>ï¼Œ<strong>åˆ†ç‰‡(slicing)</strong>ï¼Œ<strong>åŠ (adding)</strong>ï¼Œ<strong>ä¹˜(multiplying)</strong>ï¼Œ<strong>æˆå‘˜èµ„æ ¼</strong>ä»¥åŠ<strong>è¿­ä»£(iterationï¼Œæœ¬èŠ‚ä¸è®²)</strong>ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒPythonè¿˜æœ‰è®¡ç®—åºåˆ—é•¿åº¦ï¼Œæ‰¾å‡ºæœ€å¤§æœ€å°å…ƒç´ ç­‰å†…å»ºå‡½æ•°ã€‚</p>
<h2 id="ç´¢å¼•">ç´¢å¼•</h2>
<p>é€šè¿‡å…ƒç´ çš„ç¼–å·æ¥è®¿é—®å…ƒç´ (<strong>ä»0å¼€å§‹ï¼Œè°¨è®°ï¼</strong>)ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name = 'TechZone'
&gt;&gt;&gt; name[0]
'T'
&gt;&gt;&gt; name[5]
'o'
</code></pre>
<p>ç”±äºæ˜¯ä»0å¼€å§‹ï¼Œäºæ˜¯ç´¢å¼•0å¯¹åº”çš„å°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç´¢å¼•6å°±æ˜¯ç¬¬äº”ä¸ªå…ƒç´ ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœä½ ä¸å¸Œæœ›æŠŠè¿™ä¸ªåºåˆ—èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œæ“ä½œï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; 'TechZone'[5]
'o'
</code></pre>
<p>äº¦æˆ–è®¸ï¼Œä½ æƒ³æŠŠåºåˆ—ä¸­æŸä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; letter = 'TechZone'[5]
&gt;&gt;&gt; letter
'o'
</code></pre>
<p>å¦‚æœè¿™ä¸ªåºåˆ—å¾ˆé•¿ï¼Œä¹Ÿå¯ä»¥å€’ç€æ•°ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; 'Hello'[-1] #ä»£è¡¨ä»ç»“å°¾å¼€å§‹æ•°çš„ç¬¬ä¸€ä¸ª
'o'
</code></pre>
<h2 id="åˆ†ç‰‡">åˆ†ç‰‡</h2>
<p>å’Œç´¢å¼•ä¸€æ ·ï¼Œåˆ†ç‰‡æ˜¯ç”¨æ¥è®¿é—®ä¸€æ®µå…ƒç´ çš„ã€‚æ¯”å¦‚æˆ‘æƒ³ä¸€æ¬¡æ€§è®¿é—®åºåˆ—çš„ç¬¬3åˆ°ç¬¬6ä¸ªå…ƒç´ ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name = 'TechZone'
&gt;&gt;&gt; name[2:6]
'chZo'
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œèµ·å§‹å…ƒç´ ï¼ˆå†’å·å·¦è¾¹ï¼‰æ˜¯åŒ…å«åœ¨å†…çš„ï¼Œè€Œç»ˆæ­¢å…ƒç´ ï¼ˆå†’å·å³è¾¹ï¼‰æ˜¯ä¸åŒ…å«åœ¨å†…çš„ã€‚å› æ­¤<code>name[2:6]</code>å®é™…ä¸Šç­‰ä»·äº<code>name[2] + name[3] + name[4] + name[5]</code> ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è¦è®¿é—®æœ€åçš„ä¸‰ä¸ªå…ƒç´ æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>å½“ç„¶å¯ä»¥ä½¿ç”¨å¸¸è§„çš„æ–¹æ³•ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name[5:8]
'one'
</code></pre>
<p>å¦‚æœæˆ‘ä»¬è¦ä»ç»“å°¾å¼€å§‹è®¿é—®å‘¢ï¼Ÿ</p>
<pre><code class="language-python">&gt;&gt;&gt; name[-3:-1]
'on'
</code></pre>
<p>ç”±äºç»ˆæ­¢å…ƒç´ ä¸åŒ…å«åœ¨åˆ†ç‰‡é‡Œé¢ï¼Œäºæ˜¯åé¢æˆ‘ä»¬å°±è®¿é—®ä¸åˆ°ã€‚</p>
<p>æ”¹æ”¹è¯•è¯•ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name[-3:0]
''
</code></pre>
<p>ä»€ä¹ˆéƒ½æ²¡æœ‰è¿”å›ï¼ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿ</p>
<p>å› ä¸º<code>[0]</code>å…¶å®æ¯”<code>[-3]</code>æ›´å…ˆå‡ºç°ã€‚é‚£ä¹ˆèµ·å§‹å…ƒç´ æ¯”ç»ˆæ­¢å…ƒç´ è¿˜å¤§ï¼Œä»æ•°å­¦çš„è§’åº¦æ¥è¯´ï¼Œå°±æ˜¯<strong>ç©ºé›†</strong>äº†ã€‚</p>
<p>éš¾é“çœŸçš„æ²¡æœ‰åŠæ³•è¿™æ ·è®¿é—®å—ï¼Ÿ</p>
<p>å¹¶ä¸æ˜¯ï¼Œçœ‹çœ‹è¿™æ ·ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name[-3:]
'one'
</code></pre>
<p>æŠŠç»ˆæ­¢å…ƒç´ çš„ä½ç½®ç•™ç©ºï¼Œé‚£ä¹ˆPythonå°±ä¼šè‡ªåŠ¨è®¤ä¸ºä½ è¦ä¸€ç›´è®¿é—®åˆ°æœ€åå…ƒç´ ï¼Œäºæ˜¯å°±æŠŠè¿™ä¸ªé—®é¢˜å·§å¦™è§£å†³äº†ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿå¯ä»¥è¿™ä¹ˆç”¨ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name[:3]
'Tec'
&gt;&gt;&gt; name[:]
'TechZone'
</code></pre>
<p>å¾ˆå¥½ç†è§£å§ã€‚</p>
<h2 id="åˆ†ç‰‡çš„æ­¥é•¿">åˆ†ç‰‡çš„æ­¥é•¿</h2>
<p>å…¶å®åˆ†ç‰‡è¿˜æœ‰ä¸€ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬åˆšåˆšå¹¶æ²¡æœ‰ç”¨ï¼Œå°±æ˜¯æ­¥é•¿ã€‚æ­¥é•¿çš„é»˜è®¤è®¾ç½®ä¸º1ï¼Œæ„æ€å°±æ˜¯æŒ¨ä¸ªè®¿é—®ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name[1:4]
'ech'
</code></pre>
<p>å®é™…ä¸Šç­‰ä»·äºï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name[1:4:1]
'ech'
</code></pre>
<p>å¦‚æœæ­¥é•¿æ”¹æˆ2ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name[1:4:2]
'eh'
</code></pre>
<p>ä½ ä¼šå‘ç°æ£€ç´¢çš„å•ä½å˜æˆäº†2ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œä¸­é—´ä¼šè·³è¿‡ä¸€ä¸ªå…ƒç´ ï¼‰</p>
<p>ä¹Ÿè®¸è¿™ä¹ˆçœ‹ï¼Œå°±å¥½ç†è§£äº†ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; nums = [1,2,3,4,5,6,7,8,9,10]
&gt;&gt;&gt; nums[::1]
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; nums[::2]
[1, 3, 5, 7, 9]
&gt;&gt;&gt; nums[::3]
[1, 4, 7, 10]
&gt;&gt;&gt; nums[::4]
[1, 5, 9]
</code></pre>
<p>å½“ç„¶ï¼Œæ­¥é•¿ä¸èƒ½å¤Ÿä¸º0ï¼Œä½†æ˜¯å¯ä»¥ä¸ºè´Ÿæ•°ï¼ˆå€’è¿‡æ¥æ£€ç´¢ï¼‰ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; nums[::-1]
[10, 9, 8, 7, 6, 5, 4, 3, 2, 1]
&gt;&gt;&gt; nums[::-2]
[10, 8, 6, 4, 2]
&gt;&gt;&gt; nums[::-3]
[10, 7, 4, 1]
&gt;&gt;&gt; nums[::-4]
[10, 6, 2]
</code></pre>
<h2 id="åºåˆ—è¿ç®—">åºåˆ—è¿ç®—</h2>
<h3 id="ç›¸åŠ ">ç›¸åŠ </h3>
<pre><code class="language-python">&gt;&gt;&gt; [1,2,3]+[4,5,6]
[1, 2, 3, 4, 5, 6]
&gt;&gt;&gt; 'TechZone'+'Harris'
'TechZoneHarris'
&gt;&gt;&gt; [1,2,3]+'Harris'
'''
Traceback (most recent call last):
  File &quot;&lt;pyshell#35&gt;&quot;, line 1, in &lt;module&gt;
    [1,2,3]+'Harris'
TypeError: can only concatenate list (not &quot;str&quot;) to list
'''
</code></pre>
<p>ç›¸åŒç±»å‹çš„åºåˆ—ç›¸åŠ ï¼Œå®é™…ä¸Šå°±æ˜¯æ‹¼æ¥èµ·æ¥ã€‚ä½†æ˜¯ä¸åŒç±»å‹çš„åºåˆ—æ˜¯ä¸èƒ½å¤Ÿç›¸åŠ çš„ã€‚</p>
<h3 id="ä¹˜æ³•">ä¹˜æ³•</h3>
<pre><code class="language-python">&gt;&gt;&gt; 'Harris' * 5
'HarrisHarrisHarrisHarrisHarris'
&gt;&gt;&gt; [1,2] * 10
[1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2]
</code></pre>
<p>ä¹Ÿå¾ˆå¥½ç†è§£ã€‚</p>
<h2 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h2>
<p>å¦‚æœæˆ‘æƒ³åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ï¼Œä½œä¸ºå ä½ç¬¦ï¼ˆæš‚æ—¶ä¸ç”¨ï¼Œä½†æ˜¯ä»¥åè¦ç”¨çš„ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ä¸€å¯¹æ–¹æ‹¬å·<code>[]</code>æ¥è¡¨ç¤ºã€‚å¦‚æœæƒ³åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰10ä¸ªå…ƒç´ çš„åˆ—è¡¨å ä½ç¬¦ï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›å¯¹äºä½ æ¥è¯´æ²¡æœ‰æ„ä¹‰çš„å­—ç¬¦ï¼Œæ¯”å¦‚0ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; space = [0] * 10
&gt;&gt;&gt; space
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</code></pre>
<p>ä¸è¿‡è¿™æ ·çš„ä½œæ³•å…¶å®å¹¶ä¸æ˜¯ååˆ†ç¨³å¦¥ï¼Œå› ä¸ºæ²¡å‡†ä½ æ‰¾ä¸å‡ºæ¥è¿™æ ·çš„ç‰¹æ®Šçš„æ•°å­—ã€‚é‚£ä¹ˆè¿™é‡Œä»‹ç»ä¸€ä¸ªPythonå†…å»ºå€¼ï¼š<code>None</code>ï¼Œè¡¨ç¤ºä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„å ä½ç¬¦å°±å¯ä»¥è¿™æ ·åˆ›å»ºï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; space = [None] * 10
&gt;&gt;&gt; space
[None, None, None, None, None, None, None, None, None, None]
</code></pre>
<h2 id="æˆå‘˜èµ„æ ¼">æˆå‘˜èµ„æ ¼</h2>
<p>åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦åœ¨åºåˆ—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>in</code>è¿ç®—ç¬¦ã€‚è¿™ç§è¿ç®—ç¬¦ä¸åŒäºåŠ å‡ä¹˜é™¤ï¼Œå®ƒä¼šå»æ£€æŸ¥æˆ‘ä»¬çš„æ¡ä»¶æ˜¯å¦ä¸ºçœŸï¼Œè‹¥æ˜¯ï¼Œåˆ™è¿”å›<code>True</code>ï¼Œåä¹‹åˆ™è¿”å›<code>False</code>ã€‚è¿™æ ·çš„è¿ç®—ç¬¦æˆ‘ä»¬å«åš<strong>å¸ƒå°”è¿ç®—ç¬¦</strong>ï¼Œè¿”å›çš„è¿™ä¸ªå€¼ç§°ä¹‹ä¸º<strong>å¸ƒå°”å€¼</strong>ã€‚</p>
<pre><code class="language-python">&gt;&gt;&gt; user = ['Harris', 'Mary','Scott']
&gt;&gt;&gt; 'Harris' in user
True
&gt;&gt;&gt; 'Jack' in user
False
</code></pre>
<h2 id="é•¿åº¦-æœ€å€¼">é•¿åº¦ã€æœ€å€¼</h2>
<pre><code class="language-python">&gt;&gt;&gt; name = 'HarrisWilde'
&gt;&gt;&gt; len(name) #åºåˆ—é•¿åº¦
11
&gt;&gt;&gt; len([1,2,3,4])
4
&gt;&gt;&gt; max([1,3,2,13,6,5,8]) #æœ€å¤§å€¼
13
&gt;&gt;&gt; min([0.01, 0.02, 0.009, 0.015]) #æœ€å°å€¼
0.009
</code></pre>
<h1 id="åˆ—è¡¨">åˆ—è¡¨</h1>
<p>ä½¿ç”¨<code>[]</code>æ‹¬èµ·æ¥çš„åºåˆ—é›†åˆå°±æ˜¯åˆ—è¡¨ã€‚</p>
<h2 id="listå‡½æ•°">listå‡½æ•°</h2>
<p>ä½¿ç”¨<code>list</code>å‡½æ•°æ¥å°†åºåˆ—è½¬æ¢ä¸ºåˆ—è¡¨ã€‚</p>
<pre><code class="language-python">&gt;&gt;&gt; list(&quot;TechZone&quot;)
['T', 'e', 'c', 'h', 'Z', 'o', 'n', 'e']
</code></pre>
<p>ä½ è¿˜å¯ä»¥ä½¿ç”¨<code>join</code>å‡½æ•°æ¥æŠŠåºåˆ—ä¸­æ‰€æœ‰çš„å…ƒç´ (çš„å­—ç¬¦ä¸²è¡¨ç¤º)åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; seq = list(&quot;TechZone&quot;)
&gt;&gt;&gt; '-'.join(seq)
'T-e-c-h-Z-o-n-e'
</code></pre>
<h2 id="åŸºæœ¬åˆ—è¡¨æ“ä½œ">åŸºæœ¬åˆ—è¡¨æ“ä½œ</h2>
<h3 id="å…ƒç´ èµ‹å€¼">å…ƒç´ èµ‹å€¼</h3>
<p>ä¸ºå•ä¸ªå…ƒç´ èµ‹å€¼ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [0] * 3
&gt;&gt;&gt; x[1] = 1
&gt;&gt;&gt; x
[0, 1, 0]
</code></pre>
<h3 id="åˆ é™¤å…ƒç´ ">åˆ é™¤å…ƒç´ </h3>
<p>ä½¿ç”¨<code>del</code>å‡½æ•°ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x
[0, 1, 0]
&gt;&gt;&gt; del x[2]
&gt;&gt;&gt; x
[0, 1]
</code></pre>
<h3 id="åˆ†ç‰‡èµ‹å€¼">åˆ†ç‰‡èµ‹å€¼</h3>
<p>åˆ†ç‰‡èµ‹å€¼å¯ä»¥å®ç°ä¸€æ¬¡æ€§çš„æ‰¹é‡èµ‹å€¼ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x = list(&quot;python&quot;)
&gt;&gt;&gt; x
['p', 'y', 't', 'h', 'o', 'n']
&gt;&gt;&gt; x[4:] = '12'
&gt;&gt;&gt; x
['p', 'y', 't', 'h', '1', '2']
</code></pre>
<p>è€Œä¸”è¿˜å¯ä»¥éç­‰é•¿æ›¿æ¢ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x
['p', 'y', 't', 'h', '1', '2']
&gt;&gt;&gt; x[4:] = 'Lang'
&gt;&gt;&gt; x
['p', 'y', 't', 'h', 'L', 'a', 'n', 'g']
</code></pre>
<p>å› æ­¤ï¼Œä¹Ÿå¯ä»¥é—´æ¥åœ°å¢åŠ æˆ–åˆ é™¤å…ƒç´ ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x[8:8] = '12' #åœ¨æœ€åçš„ä¸å­˜åœ¨çš„ä½ç½®å¢åŠ 
&gt;&gt;&gt; x
['p', 'y', 't', 'h', 'L', 'a', 'n', 'g', '1', '2']
&gt;&gt;&gt; x[4:8] = []
&gt;&gt;&gt; x
['p', 'y', 't', 'h', '1', '2']
</code></pre>
<h2 id="åˆ—è¡¨æ–¹æ³•">åˆ—è¡¨æ–¹æ³•</h2>
<h3 id="append">append</h3>
<p>æ­¤æ–¹æ³•ç”¨äºåœ¨åˆ—è¡¨åé¢è¿½åŠ å…ƒç´ ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; nums = [1,2,3]
&gt;&gt;&gt; nums.append(4)
&gt;&gt;&gt; nums
[1, 2, 3, 4]
</code></pre>
<h3 id="count">count</h3>
<p>æ­¤æ–¹æ³•ç»Ÿè®¡æŸä¸ªå…ƒç´ åœ¨åˆ—è¡¨ä¸­å‡ºç°çš„æ¬¡æ•°ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name = 'TechZone'
&gt;&gt;&gt; name.count('e')
2
</code></pre>
<h3 id="extend">extend</h3>
<p>æ­¤æ–¹æ³•å¯ä»¥åœ¨æœ«å°¾ä¸€æ¬¡æ€§è¿½åŠ å¤šä¸ªå€¼ï¼Œå¹¶ä¸”æ›´æ”¹åŸæ¥çš„åˆ—è¡¨ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; a = [1,2,3]
&gt;&gt;&gt; b = [4,5,6]
&gt;&gt;&gt; a.extend(b)
&gt;&gt;&gt; a
[1, 2, 3, 4, 5, 6]
&gt;&gt;&gt; b
[4, 5, 6]
</code></pre>
<h3 id="index">index</h3>
<p>æ­¤æ–¹æ³•ç”¨äºæ‰¾å‡ºåˆ—è¡¨ä¸­æŸä¸ªå€¼çš„ç¬¬ä¸€ä¸ªåŒ¹é…å…ƒç´ çš„ç´¢å¼•ï¼Œè‹¥æ‰¾ä¸åˆ°åˆ™ä¼šè¿”å›é”™è¯¯ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; name = 'TechZone'
&gt;&gt;&gt; name.index('e')
1
&gt;&gt;&gt; name.index('a')
'''
Traceback (most recent call last):
  File &quot;&lt;pyshell#13&gt;&quot;, line 1, in &lt;module&gt;
    name.index('a')
ValueError: substring not found
'''
</code></pre>
<h3 id="insert">insert</h3>
<p>æ­¤æ–¹æ³•ç”¨äºå°†å¯¹è±¡æ’å…¥åˆ°åˆ—è¡¨ä¸­ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; nums = [1,2,3,5]
&gt;&gt;&gt; nums.insert(3, 'four')
&gt;&gt;&gt; nums
[1, 2, 3, 'four', 5]
</code></pre>
<h3 id="pop">pop</h3>
<p>æ­¤æ–¹æ³•ç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”è¿”å›è¢«ç§»é™¤å…ƒç´ çš„å€¼ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; nums = [1,2,3,4]
&gt;&gt;&gt; nums.pop()
4
&gt;&gt;&gt; nums
[1, 2, 3]
</code></pre>
<blockquote>
<p>popæ–¹æ³•æ˜¯å”¯ä¸€ä¸€ä¸ªæ—¢èƒ½ä¿®æ”¹åˆ—è¡¨åˆèƒ½è¿”å›å…ƒç´ å€¼ï¼ˆé™¤äº†Noneï¼‰çš„åˆ—è¡¨æ–¹æ³•</p>
</blockquote>
<h3 id="remove">remove</h3>
<p>removeæ–¹æ³•ç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„æŸä¸ªå€¼çš„é¦–ä¸ªåŒ¹é…é¡¹ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; words = ['a','friend','in','need','is','a','friend','indeed']
&gt;&gt;&gt; words.remove('friend')
&gt;&gt;&gt; words
['a', 'in', 'need', 'is', 'a', 'friend', 'indeed']
</code></pre>
<blockquote>
<p>removeæ˜¯ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„åŸä½ç½®æ”¹å˜æ–¹æ³•ã€‚å’Œpopæ°æ°ç›¸åã€‚</p>
</blockquote>
<h3 id="reverse">reverse</h3>
<p>æ­¤æ–¹æ³•å°†åˆ—è¡¨ä¸­çš„å…ƒç´ åå‘å­˜æ”¾ã€‚</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [1,2,3]
&gt;&gt;&gt; x.reverse()
&gt;&gt;&gt; x
[3, 2, 1]
</code></pre>
<p>æ­¤æ–¹æ³•ä¹Ÿæ˜¯ä¸è¿”å›å€¼ï¼Œå’Œremoveä¸€æ ·ã€‚</p>
<blockquote>
<p>å¦‚æœéœ€è¦å¯¹ä¸€ä¸ªåºåˆ—è¿›è¡Œåå‘è¿­ä»£ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>reversed</code>å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯è¿­ä»£å™¨å¯¹è±¡(iterator)ã€‚å½“ç„¶ï¼Œä½¿ç”¨<code>list</code>å‡½æ•°æŠŠè¿”å›çš„å¯¹è±¡è½¬æ¢æˆåˆ—è¡¨ä¹Ÿæ˜¯å¯è¡Œçš„ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [1,2,3]
&gt;&gt;&gt; list(reversed(x))
[3, 2, 1]
</code></pre>
</blockquote>
<h3 id="sort">sort</h3>
<p>æ­¤æ–¹æ³•ç”¨äºå¯¹åˆ—è¡¨è¿›è¡ŒåŸåœ°æ’åºã€‚æ‰€è°“åŸåœ°æ’åºï¼Œå°±æ˜¯æ›´æ”¹åŸæ¥çš„åˆ—è¡¨ï¼Œè€Œä¸æ˜¯è¿”å›ä¸€ä¸ªå·²æ’åºçš„å‰¯æœ¬ã€‚</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [4,5,3,6,2,5,1]
&gt;&gt;&gt; x.sort()
&gt;&gt;&gt; x
[1, 2, 3, 4, 5, 5, 6]
</code></pre>
<p>å¦‚æœä½ æƒ³å¾—åˆ°çš„æ°æ°æ˜¯ä¸€ä¸ªå‰¯æœ¬ï¼Œæƒ³ä¿ç•™åŸæ¥çš„åˆ—è¡¨ï¼Œåƒä¸‡ä¸è¦è¿™ä¹ˆåšï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [4,5,3,6,2,5,1]
&gt;&gt;&gt; y = x.sort() #é”™è¯¯çš„åšæ³•
&gt;&gt;&gt; print(y)
None
</code></pre>
<p>å› ä¸º<code>sort</code>å‡½æ•°æ˜¯ä¸è¿”å›å€¼çš„ï¼ˆå®é™…ä¸Šè¿”å›çš„æ˜¯ç©ºå€¼ï¼‰ã€‚å¦‚æœè¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œé‚£ä¹ˆåªèƒ½æŠŠåŸå…ˆxçš„å‰¯æœ¬èµ‹ç»™yï¼Œç„¶åå¯¹yè¿›è¡Œæ’åºï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [4,5,3,6,2,5,1]
&gt;&gt;&gt; y = x
&gt;&gt;&gt; y.sort()
&gt;&gt;&gt; y
[1, 2, 3, 4, 5, 5, 6]
&gt;&gt;&gt; x
[1, 2, 3, 4, 5, 5, 6]
</code></pre>
<p>ä½ ä¼šå‘ç°ï¼Œä¸ºä½•åŸæ¥çš„xä¹Ÿè¢«æ”¹å˜äº†å‘¢ï¼Ÿ</p>
<p>åŸæ¥ï¼Œç®€å•çš„ç­‰å·èµ‹å€¼ï¼Œä¼šè®©xå’ŒyæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ä½¿ç”¨åˆ†ç‰‡çš„æ–¹æ³•æ¥èµ‹å€¼ï¼Œå°±å¯ä»¥å·§å¦™åœ°èº²å¼€è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [4,5,3,6,2,5,1]
&gt;&gt;&gt; y = x[:]
&gt;&gt;&gt; y.sort()
&gt;&gt;&gt; y
[1, 2, 3, 4, 5, 5, 6]
&gt;&gt;&gt; x
[4, 5, 3, 6, 2, 5, 1]
</code></pre>
<p>å¦å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>sorted</code>å‡½æ•°æ¥è·å–å·²æ’åºå‰¯æœ¬ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [4,5,3,6,2,5,1]
&gt;&gt;&gt; y = sorted(x)
&gt;&gt;&gt; y
[1, 2, 3, 4, 5, 5, 6]
&gt;&gt;&gt; x
[4, 5, 3, 6, 2, 5, 1]
</code></pre>
<p><code>sorted</code>å‡½æ•°å¯ä»¥ç”¨äºä»»ä½•åºåˆ—ï¼Œä½†æ˜¯æ€»ä¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; sorted(&quot;TechZone&quot;)
['T', 'Z', 'c', 'e', 'e', 'h', 'n', 'o']
</code></pre>
<p>æ­¤å‡½æ•°é»˜è®¤æ˜¯å‡åºæ’åºï¼Œå¦‚æœæˆ‘æƒ³é™åºï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>å¯ä»¥å…ˆæ’å¥½åºä¹‹åå†åè½¬ï¼Œä¸è¿‡ï¼Œæœ‰ä¸ªæ›´ç®€ä¾¿çš„æ–¹æ³•ï¼šä½¿ç”¨reverseå‚æ•°ã€‚</p>
<pre><code class="language-python">&gt;&gt;&gt; x = [4,5,3,6,2,5,1]
&gt;&gt;&gt; x.sort(reverse = False) #é»˜è®¤æƒ…å†µï¼Œå°±æ˜¯ä¸å†™å‚æ•°çš„æƒ…å†µ
&gt;&gt;&gt; x
[1, 2, 3, 4, 5, 5, 6]
&gt;&gt;&gt; x.sort(reverse = True) #åº”ç”¨reverseå‚æ•°
&gt;&gt;&gt; x
[6, 5, 5, 4, 3, 2, 1]
</code></pre>
<p>å½“ç„¶ï¼Œæ­¤å‡½æ•°è¿˜å¯ä»¥è¿›è¡Œæ›´é«˜çº§çš„æ’åºï¼Œå°±æ˜¯ä½¿ç”¨<code>key</code>å‚æ•°ã€‚æ‰€è°“keyï¼Œç¬”è€…è®¤ä¸ºå°±æ˜¯<strong>æ’åºå‚è€ƒå…³é”®è¯</strong>ã€‚é»˜è®¤æ˜¯æŒ‰ç…§å€¼çš„å¤§å°ï¼ˆè‹¥æ˜¯å­—ç¬¦ä¸²åˆ™æ¯”è¾ƒå…¶å¯¹åº”ç¼–ç çš„å¤§å°ï¼‰ï¼Œä½¿ç”¨æ­¤å‚æ•°ï¼Œå°±å¯ä»¥å®ç°åˆ«çš„å‚è€ƒå€¼ã€‚</p>
<p>æ¯”å¦‚æˆ‘æƒ³æ ¹æ®å­—ç¬¦ä¸²é•¿åº¦æ¥æ’åºï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; string = ['TechZone','HarrisWIlde','Python','Programing']
&gt;&gt;&gt; string.sort(key=len)
&gt;&gt;&gt; string
['Python', 'TechZone', 'Programing', 'HarrisWIlde']
</code></pre>
<p>å½“ç„¶ï¼Œä¸¤ä¸ªå‚æ•°ä¹Ÿå¯ä»¥ä¸€èµ·ç”¨ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt; string = ['TechZone','HarrisWIlde','Python','Programing']
&gt;&gt;&gt; string.sort(key=len, reverse=True)
&gt;&gt;&gt; string
['HarrisWIlde', 'Programing', 'TechZone', 'Python']
</code></pre>
<p>è¿™ä¸¤ä¸ªå‚æ•°å¯¹äº<code>sorted()</code>éƒ½æœ‰æ•ˆã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Cè¯­è¨€ä¹‹å‡½æ•°ï¼ˆä¸‹ï¼‰]]></title>
        <id>https://harriswilde.github.io/post/PS9G6tbW5/</id>
        <link href="https://harriswilde.github.io/post/PS9G6tbW5/">
        </link>
        <updated>2020-02-09T12:46:54.000Z</updated>
        <content type="html"><![CDATA[<h1 id="åŠ¨æ€å†…å­˜ç®¡ç†">åŠ¨æ€å†…å­˜ç®¡ç†</h1>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„å˜é‡ã€æ•°ç»„ï¼Œéƒ½æ˜¯æˆ‘ä»¬äº‹å…ˆå®šä¹‰å¥½çš„ï¼Œå˜é‡ä¸€æ—¦è¢«åˆ›å»ºï¼Œå°±ä¸èƒ½å¤Ÿå†æ›´æ”¹äº†ã€‚åæ¥ï¼ŒC99æ ‡å‡†åˆå¢åŠ äº†å˜é•¿æ•°ç»„ï¼Œè¿™ä¸€ç‰¹æ€§æé«˜äº†æˆ‘ä»¬ç¨‹åºå¯¹å†…å­˜åˆ†é…çš„çµæ´»åº¦ï¼Œå¯æ˜¯è¿˜æ˜¯æ„Ÿè§‰ä¸å¤ªçµæ´»ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è®©å®ƒå˜å¾—æ›´çµæ´»å‘¢ï¼Ÿ</p>
<p>å½“ç„¶æœ‰ï¼Œè€Œä¸”åªéœ€è¦å‡ ä¸ªåº“çš„å‡½æ•°å°±èƒ½å¤Ÿæå®šã€‚è€Œè¿™äº›åº“å…¨éƒ¨éƒ½åŒ…å«åœ¨<code>stdlib.h</code>è¿™ä¸ªå¤´æ–‡ä»¶ä¸­ï¼š</p>
<ul>
<li>malloc â€”â€”ç”³è¯·åŠ¨æ€å†…å­˜ç©ºé—´</li>
<li>free â€”â€”é‡Šæ”¾åŠ¨æ€å†…å­˜ç©ºé—´</li>
<li>calloc â€”â€”ç”³è¯·å¹¶åˆå§‹åŒ–ä¸€ç³»åˆ—å†…å­˜ç©ºé—´</li>
<li>realloc â€”â€”é‡æ–°åˆ†é…å†…å­˜ç©ºé—´</li>
</ul>
<h2 id="malloc">malloc</h2>
<p><code>malloc</code>å‡½æ•°ç”¨äºç”³è¯·åŠ¨æ€å†…å­˜ç©ºé—´ï¼š</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
void* malloc(size_t size);
</code></pre>
<p><code>malloc</code>å‡½æ•°å‘ç³»ç»Ÿç”³è¯·åˆ†é…<code>size</code>ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¿™å—ç©ºé—´çš„æŒ‡é’ˆã€‚ä¸è¿‡ï¼Œç”³è¯·çš„è¿™å—ç©ºé—´å¹¶æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå› æ­¤ä¸Šé¢çš„æ•°æ®æ˜¯éšæœºçš„ï¼ˆå’Œå±€éƒ¨å˜é‡ä¸€æ ·ï¼‰ã€‚</p>
<p>å¦‚æœå‡½æ•°è°ƒç”¨æˆåŠŸï¼Œé‚£ä¹ˆä¼šè¿”å›ä¸€ä¸ªæŒ‡å‘è¢«ç”³è¯·çš„å†…å­˜ç©ºé—´çš„æŒ‡é’ˆï¼Œç”±äºè¿”å›çš„æ˜¯voidç±»å‹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«è½¬åŒ–æˆä»»ä½•ç±»å‹çš„æ•°æ®ã€‚å¦‚æœå‡½æ•°è°ƒç”¨å¤±è´¥ï¼Œè¿”å›å€¼å°±æ˜¯<code>NULL</code>ã€‚å¦å¤–ï¼Œå¦‚æœ<code>size</code>å‚æ•°è®¾ç½®æˆ0ï¼Œé‚£ä¹ˆè¿”å›å€¼ä¹Ÿæœ‰å¯èƒ½æ˜¯0ï¼Œä½†è¿™ç§æƒ…å†µä¸‹å¹¶ä¸ä¸€å®šä»£è¡¨è°ƒç”¨å¤±è´¥ã€‚</p>
<pre><code class="language-c">//Exmple 01
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main(void)
{
    int* ptr;
    ptr = (int*)malloc(sizeof(int));
    if (ptr == NULL)
    {
        printf(&quot;åˆ†é…å†…å­˜å¤±è´¥ï¼\n&quot;);
        exit(1);//ç¨‹åºå¼‚å¸¸é€€å‡º
    }
    printf(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š&quot;);
    scanf(&quot;%d&quot;, ptr);
    printf(&quot;ä½ è¾“å…¥çš„æ•°æ®æ˜¯ï¼š%d\n&quot;, *ptr);
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœä¸ºï¼š</p>
<pre><code>è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š12
ä½ è¾“å…¥çš„æ•°æ®æ˜¯ï¼š12
</code></pre>
<p>è¿™æ®µä»£ç çš„æ„æ€æ˜¯ï¼Œä½¿ç”¨<code>malloc</code>å‡½æ•°ç”³è¯·ä¸€å—intç±»å‹çš„ç©ºé—´ï¼Œç„¶åä½¿ç”¨<code>ptr</code>æŒ‡é’ˆæ¥æŒ‡å‘å®ƒï¼Œç„¶åå°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®å­˜å‚¨åœ¨è¿™å—ç©ºé—´é‡Œé¢ã€‚</p>
<p>ä¸è¿‡ï¼Œ<code>malloc</code>å‡½æ•°ç”³è¯·çš„ç©ºé—´æ˜¯åœ¨å †ä¸Šï¼Œé‚£ä¹ˆè¿™å°±æ„å‘³è¿™å®ƒä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œç›´åˆ°ç¨‹åºæ‰§è¡Œç»“æŸã€‚æ‰€ä»¥åœ¨ä½¿ç”¨å®Œå˜é‡ä¹‹ååŠ¡å¿…é‡Šæ”¾å†…å­˜ï¼Œå¦åˆ™å¾ˆæœ‰å¯èƒ½é€ æˆå†…å­˜æ³„æ¼ã€‚</p>
<h2 id="free">free</h2>
<p>é‡Šæ”¾åŠ¨æ€å†…å­˜ç©ºé—´éœ€è¦ç”¨<code>free</code>å‡½æ•°ï¼Œå‡½æ•°åŸå‹ï¼š</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
...
void free(void* ptr);
</code></pre>
<p>é‡Šæ”¾çš„ç©ºé—´å¿…é¡»è¦æ˜¯<code>malloc</code> <code>calloc</code> <code>realloc</code>å‡½æ•°ç”³è¯·çš„ï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚å¦‚æœ<code>ptr</code>çš„å‚æ•°æ˜¯<code>NULL</code>ï¼Œé‚£ä¹ˆå°±ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚</p>
<p>è¿™ä¸ªå‡½æ•°å®é™…ä¸Šå¹¶ä¸ä¼šä¿®æ”¹<code>ptr</code>å‚æ•°çš„å€¼ï¼Œæ‰€ä»¥è°ƒç”¨åå®ƒä»ç„¶èƒ½å¤ŸæŒ‡å‘åŸæ¥çš„åœ°æ–¹ï¼Œåªä¸è¿‡å˜ä¸ºéæ³•ç©ºé—´ç½¢äº†ã€‚</p>
<p>æœ‰äººä¼šè¯´äº†ï¼Œç°ä»£è®¡ç®—æœºå†…å­˜éƒ½ä¸å°ï¼ŒåŠ¨è¾„16GBç”šè‡³æ›´å¤šï¼Œé‚£ä¹ˆè¿™ä¸ªæ˜¯å¦å°±ç”¨ä¸ä¸Šäº†å‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆå½“ç„¶æ˜¯å¦å®šçš„ã€‚ä¸ä¿¡ä½ è¯•è¯•ä¸‹é¢çš„è¿™ä¸ªç¨‹åºï¼š</p>
<pre><code class="language-c">//Infinity malloc
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main(void)
{
    while (1)
    {
        malloc(1024);
    }
    return 0;
}
</code></pre>
<p>ä½ ä¼šå‘ç°å†…å­˜å ç”¨ä¼šé£™å‡ã€‚è¿™ç§æƒ…å†µå°±å«åš<strong>å†…å­˜æ³„æ¼</strong>ã€‚æˆ‘ä»¬ç”³è¯·çš„ç©ºé—´ï¼Œåœ¨ä½¿ç”¨å®Œååº”è¯¥è¦ç«‹å³é‡Šæ”¾ï¼Œä¸ç„¶å¾ˆæœ‰å¯èƒ½ä¼šé€ æˆä¸å ªè®¾æƒ³çš„åæœã€‚</p>
<pre><code class="language-c">//Exmple 01 - Edited
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main(void)
{
    int* ptr;
    ptr = (int*)malloc(sizeof(int));
    if (ptr == NULL)
    {
        printf(&quot;åˆ†é…å†…å­˜å¤±è´¥ï¼\n&quot;);
        exit(1);//ç¨‹åºå¼‚å¸¸é€€å‡º
    }
    printf(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š&quot;);
    scanf(&quot;%d&quot;, ptr);
    printf(&quot;ä½ è¾“å…¥çš„æ•°æ®æ˜¯ï¼š%d\n&quot;, *ptr);
    ////é‡Šæ”¾å†…å­˜////
    free(ptr);
    return 0;
}
</code></pre>
<p>å› æ­¤ï¼Œåœ¨ä½¿ç”¨å®Œç”³è¯·çš„å†…å­˜ä¹‹ååº”è¯¥è¦æ‰‹åŠ¨é‡Šæ”¾ã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="language-c">//Example 02
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main(void)
{
    int* ptr;
    int num = 123;
    ptr = (int*)malloc(sizeof(int));
    if (ptr == NULL)
    {
        printf(&quot;åˆ†é…å†…å­˜å¤±è´¥ï¼\n&quot;);
        exit(1);
    }
    printf(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š&quot;);
    scanf(&quot;%d&quot;, ptr);
    printf(&quot;ä½ è¾“å…¥çš„æ•´æ•°æ˜¯ï¼š%d\n&quot;, *ptr);
    ptr = &amp;num;
    printf(&quot;ä½ è¾“å…¥çš„æ•´æ•°æ˜¯ï¼š%d\n&quot;, *ptr);
    free(ptr);
    return 0;
}
</code></pre>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š10
ä½ è¾“å…¥çš„æ•´æ•°æ˜¯ï¼š10
ä½ è¾“å…¥çš„æ•´æ•°æ˜¯ï¼š123
HEAP[ConsoleApplication2.exe]: Invalid address specified to RtlValidateHeap( 00D20000, 0096F8E0 )
ConsoleApplication2.exe å·²è§¦å‘äº†ä¸€ä¸ªæ–­ç‚¹ã€‚
</code></pre>
<p>ç¨‹åºè¢«ä¸­æ–­äº†ã€‚</p>
<p>åˆšå¼€å§‹ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>malloc</code>å‡½æ•°ç”³è¯·äº†ä¸€æ®µå†…å­˜ï¼Œå¹¶ä¸”åªæœ‰<code>ptr</code>æ‰çŸ¥é“è¿™å—å†…å­˜çš„åœ°å€ã€‚æ‰€ä»¥åé¢æˆ‘ä»¬æ›´æ”¹äº†<code>ptr</code>åï¼Œè¿™å—å†…å­˜å°±æ³„éœ²äº†ã€‚åé¢æˆ‘ä»¬å°è¯•é‡Šæ”¾<code>ptr</code>ï¼Œå´å‘ç°ï¼Œç°åœ¨<code>ptr</code>æ‰€æŒ‡å‘çš„å˜é‡æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œä¸å…è®¸æ‰‹åŠ¨é‡Šæ”¾ã€‚è¿™ç§æƒ…å†µçš„æ³„éœ²ä¸€å®šè¦ç‰¹åˆ«æ³¨æ„ã€‚</p>
<h2 id="ç”³è¯·ä»»æ„å°ºå¯¸çš„å†…å­˜ç©ºé—´">ç”³è¯·ä»»æ„å°ºå¯¸çš„å†…å­˜ç©ºé—´</h2>
<p><code>malloc</code>è¿˜å¯ä»¥ç”¨äºç”³è¯·ä¸€å—ä»»æ„å°ºå¯¸çš„å†…å­˜ç©ºé—´ã€‚å¯¹äºåè€…ï¼Œç”±äºç”³è¯·çš„ç©ºé—´æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥ç»å¸¸ç”¨æ•°ç»„çš„æ–¹å¼æ¥è¿›è¡Œç´¢å¼•ã€‚</p>
<p>è¿˜è®°å¾—åœ¨<a href="http://www.techzone.ltd/post/CArray/">ã€ŠCè¯­è¨€ä¹‹æ•°ç»„ã€‹</a>é‡Œæˆ‘ä»¬è®²è¿‡ï¼ŒVisual Studioå’ŒC99ä¹‹å‰çš„ç¼–è¯‘å™¨æ˜¯ä¸æ”¯æŒå¯å˜é•¿æ•°ç»„çš„ã€‚å¦‚æœæ°å¥½ç¢°åˆ°è¿™ç§ç¯å¢ƒï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿåˆšå¥½å¯ä»¥ç”¨è¿™ç§æ–¹å¼æ¥æ›²çº¿æ•‘å›½ï¼š</p>
<pre><code class="language-c">//Example 03
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
 int main(void)
 {
     int* array;
     int n;
     printf(&quot;è¯·è¾“å…¥ä½ è¦åˆ›å»ºçš„æ•°ç»„å…ƒç´ ä¸ªæ•°ï¼š&quot;);
     scanf(&quot;%d&quot;, &amp;n);
     array = (int*)malloc(sizeof(int) * n);
     for (int i = 0; i &lt; n; i++)
     {
         array[i] = i;
         printf(&quot;%d\n&quot;, array[i]);
     }
     return 0;
 }
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 03
è¯·è¾“å…¥ä½ è¦åˆ›å»ºçš„æ•°ç»„å…ƒç´ ä¸ªæ•°ï¼š10
0
1
2
3
4
5
6
7
8
9
</code></pre>
<p>å¤šç»´æ•°ç»„ä¹Ÿä¸€æ ·å¯ä»¥ï¼ˆæœ¬è´¨ä¸Šä¹Ÿæ˜¯çº¿æ€§å­˜å‚¨ï¼‰ï¼š</p>
<pre><code class="language-c">//Example 04
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main(void)
{
    int** array;
    int n, m;
    scanf(&quot;%d %d&quot;, &amp;n, &amp;m);//nä¸ºå‡ ä¸ªå¤§çš„æ•°ç»„ï¼Œmæ˜¯ä¸€ä¸ªå°æ•°ç»„ä¸­æœ‰å‡ ä¸ªå…ƒç´ 
    array = (int**)malloc(sizeof(int*) * n);//åˆ†é…è¡Œæ•°
    for (int i = 0; i &lt; n; i++)
    {
        array[i] = (int*)malloc(sizeof(int) * m);//åˆ†é…å„ä¸ªå…ƒç´ 
    }
    for (int i = 0; i &lt; n; i++)
    {
        for (int j = 0; j &lt; m; j++)
        {
            array[i][j] = j;
            printf(&quot;%d &quot;, array[i][j]);
        }
        printf(&quot;\n&quot;);
    }
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 04
3 4
0 1 2 3
0 1 2 3
0 1 2 3
</code></pre>
<p>ç”±äº<code>malloc</code>ä¸ä¼šåˆå§‹åŒ–ç”³è¯·çš„å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥éœ€è¦å­—èŠ‚è¿›è¡Œåˆå§‹åŒ–ã€‚å½“ç„¶å¯ä»¥å†™ä¸€ä¸ªå¾ªç¯ï¼Œåƒæˆ‘ä»¬åˆšåˆšé‚£æ ·ï¼Œä¸è¿‡è¿˜æ˜¯ç•¥æ˜¾ç¹çã€‚</p>
<p>å¥½åœ¨ï¼Œæ ‡å‡†åº“æä¾›äº†æ›´åŠ é«˜æ•ˆçš„å‡½æ•°ï¼ŒåŒ…å«åœ¨<code>string.h</code>å¤´æ–‡ä»¶ä¸­ï¼š</p>
<ul>
<li>memset: ä½¿ç”¨ä¸€ä¸ªå¸¸é‡å­—èŠ‚å¡«å……å†…å­˜ç©ºé—´</li>
<li>memcpy: å¤åˆ¶å†…å­˜ç©ºé—´</li>
<li>memmove: ç§»åŠ¨å†…å­˜ç©ºé—´</li>
<li>memcmp: æ¯”è¾ƒå†…å­˜ç©ºé—´</li>
<li>memchr: åœ¨å†…å­˜ç©ºé—´ä¸­æœç´¢ä¸€ä¸ªå­—ç¬¦</li>
</ul>
<p>å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-c">#include &lt;string.h&gt;
void* memset(void* s, int c, size_t n);
void* memcpy(void* dest, const void* src, size_t n);
void* memmove(void* dest, const void* src, size_t n);
int memcmp(const void* s1, const void* s2, size_t n);
void* memchr(const void* s, int c, size_t n);
</code></pre>
<p>ä½¿ç”¨<code>memset</code>å‡½æ•°åˆå§‹åŒ–ç©ºé—´ï¼š</p>
<pre><code class="language-c">//Example 05
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#define N 10

int main(void)
{
    int* ptr = NULL;
    ptr = (int*)malloc(N * sizeof(int));
    if (ptr == NULL)
    {
        exit(1);
    }
    memset(ptr, 0, N * sizeof(int));
    for (int i = 0; i &lt; N; i++)
    {
        printf(&quot;%d &quot;, ptr[i]);
    }
    putchar('\n');
    free(ptr);
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 05
0 0 0 0 0 0 0 0 0 0
</code></pre>
<p>å¦‚æœè§‰å¾—è¿™æ ·å¤ªéº»çƒ¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>calloc</code>æ¥ä¸€æ­¥åˆ°ä½ã€‚</p>
<h2 id="calloc">calloc</h2>
<p><code>calloc</code>å‡½æ•°ç”¨äºç”³è¯·å¹¶åˆå§‹åŒ–ä¸€ç³»åˆ—å†…å­˜ç©ºé—´ï¼š</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
...
void* calloc(size_t nmemb, size_t size);
</code></pre>
<p><code>calloc</code>å‡½æ•°åœ¨å†…å­˜ä¸­åŠ¨æ€åœ°ç”³è¯·nmembä¸ªé•¿åº¦ä¸ºsizeçš„è¿ç»­å†…å­˜ç©ºé—´ï¼ˆå³ç”³è¯·çš„æ€»ç©ºé—´å°ºå¯¸ä¸º<code>nmemb*size</code>ï¼‰ï¼Œè¿™äº›å†…å­˜ç©ºé—´å…¨éƒ¨è¢«åˆå§‹åŒ–æˆ0ã€‚</p>
<p>å¦‚æœå‡½æ•°è°ƒç”¨æˆåŠŸï¼Œä¼šè¿”å›ä¸€ä¸ªæŒ‡å‘ç”³è¯·çš„å†…å­˜ç©ºé—´çš„æŒ‡é’ˆï¼Œç”±äºè¿”å›ç±»å‹æ˜¯voidæŒ‡é’ˆï¼Œå› æ­¤å¯ä»¥è¢«è½¬æ¢æˆä»»ä½•ç±»å‹çš„æ•°æ®ã€‚å¦‚æœå‡½æ•°è°ƒç”¨å¤±è´¥ï¼Œè¿”å›å€¼æ˜¯<code>NULL</code>ã€‚å¦‚æœ<code>nmemb</code>æˆ–<code>size</code>å‚æ•°è®¾ç½®ä¸º0ï¼Œè¿”å›å€¼ä¹Ÿå¯èƒ½æ˜¯<code>NULL</code>ï¼Œä½†è¿™ä¸ä¸€å®šæ„å‘³ç€å‡½æ•°è°ƒç”¨å¤±è´¥ã€‚</p>
<h2 id="realloc">realloc</h2>
<p>æœ‰æ—¶å€™å¯èƒ½éœ€è¦å¯¹åŸæ¥åˆ†é…çš„ç©ºé—´è¿›è¡Œæ‹“å±•ï¼Œä½†æ˜¯æ²¡åŠæ³•ç¡®ä¿ä¸¤æ¬¡ç”³è¯·çš„ç©ºé—´æ˜¯çº¿æ€§è¿ç»­çš„ã€‚æ‰€ä»¥éœ€è¦å…ˆç”³è¯·ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç©ºé—´ï¼Œå†æŠŠæ•°æ®æ¬è¿è¿‡å»ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™æ ·ç¡®å®å¯ä»¥ï¼Œä½†æ˜¯æ‰‹åŠ¨å†™ä»£ç çš„è¯æ„Ÿè§‰æœ‰äº›å¤ªç¹çäº†ã€‚ä½¿ç”¨<code>realloc</code>å‡½æ•°å°±å¯ä»¥å¸®æˆ‘ä»¬å®Œæˆè¿™ä¸€ç³»åˆ—çš„æ“ä½œï¼š</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
...
void* realloc(void* ptr, size_t size);
</code></pre>
<p>ä»¥ä¸‹å‡ ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„ï¼š</p>
<ul>
<li><code>realloc</code>å‡½æ•°å°†<code>ptr</code>æŒ‡å‘çš„å†…å­˜ç©ºé—´å¤§å°ä¿®æ”¹ä¸º<code>size</code>å­—èŠ‚</li>
<li>å¦‚æœé‡æ–°åˆ†é…çš„å†…å­˜æ¯”åŸæ¥çš„å¤§ï¼Œåˆ™æ—§æ•°æ®ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼›è‹¥æ¯”åŸæ¥å°ï¼Œæ•°æ®æœ‰å¯èƒ½ä¼šä¸¢å¤±ï¼Œæ…ç”¨ï¼</li>
<li>è¯¥å‡½æ•°ä¼šç§»åŠ¨å†…å­˜ç©ºé—´å¹¶è¿”å›æ–°çš„æŒ‡é’ˆ</li>
<li>å¦‚æœ<code>ptr</code>çš„å‚æ•°æ˜¯<code>NULL</code>ï¼Œé‚£ä¹ˆè°ƒç”¨è¯¥å‡½æ•°å°±ç›¸å½“äºè°ƒç”¨<code>malloc(size)</code></li>
<li>å¦‚æœ<code>size</code>çš„å‚æ•°ä¸º0ï¼Œå¹¶ä¸”<code>ptr</code>çš„å‚æ•°ä¸ä¸º<code>NULL</code>ï¼Œé‚£ä¹ˆè°ƒç”¨è¯¥å‡½æ•°å°±ç›¸å½“äºè°ƒç”¨<code>free(ptr)</code></li>
<li>é™¤é<code>ptr</code>çš„å‚æ•°ä¸º<code>NULL</code>ï¼Œå¦åˆ™<code>ptr</code>çš„å€¼å¿…é¡»ç”±å…ˆå‰è°ƒç”¨çš„<code>malloc</code> <code>calloc</code> <code>realloc</code>å‡½æ•°è¿”å›</li>
</ul>
<p>ä¸‹é¢è¿™ä¸ªç¨‹åºï¼Œä¸æ–­æ¥å—ç”¨æˆ·è¾“å…¥æ•´æ•°ï¼Œç›´åˆ°ç”¨æˆ·è¾“å…¥-1ç»“æŸï¼Œç„¶åå°†æ‰€æœ‰çš„æ•°æ®è¾“å‡ºï¼š</p>
<pre><code class="language-c">//Example 06
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main(void)
{
    int num;
    int count = 0;
    int* ptr = NULL;//è¿™é‡Œå¿…é¡»åˆå§‹åŒ–ä¸ºNULL
    do
    {
        printf(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰&quot;);
        scanf(&quot;%d&quot;, &amp;num);
        count++;
        ptr = (int*)realloc(ptr, count * sizeof(int));
        if (ptr == NULL)
        {
            exit(1);
        }
        ptr[count - 1] = num;
    } while (num != -1);
    printf(&quot;è¾“å…¥çš„æ•´æ•°åˆ†åˆ«æ˜¯ï¼š&quot;);
    for (int i = 0; i &lt; count - 1; i++)
    {
        printf(&quot;%d &quot;, ptr[i]);
    }
    printf(&quot;\n&quot;);
    free(ptr);
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 06
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰5
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰23
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰4
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰51
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰22
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰31
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰1
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰9
è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆè¾“å…¥-1è¡¨ç¤ºç»“æŸï¼šï¼‰-1
è¾“å…¥çš„æ•´æ•°åˆ†åˆ«æ˜¯ï¼š5 23 4 51 22 31 1 9
</code></pre>
<h1 id="cè¯­è¨€çš„å†…å­˜å¸ƒå±€">Cè¯­è¨€çš„å†…å­˜å¸ƒå±€</h1>
<img src="https://s2.ax1x.com/2020/02/09/1hG8D1.png" alt="Cè¯­è¨€çš„å†…å­˜å¸ƒå±€" style="zoom:33%;" />
<p>æ ¹æ®å†…å­˜ç”±ä½åˆ°é«˜åˆ†åˆ«åšå¦‚ä¸‹åˆ’åˆ†ï¼š</p>
<ul>
<li>ä»£ç æ®µ(text segment)</li>
<li>æ•°æ®æ®µ(initialized data segment)</li>
<li>BSSæ®µ(BSS segment / Uninitialized data segment)</li>
<li>æ ˆ(stack)</li>
<li>å †(heap)</li>
</ul>
<h2 id="ä»£ç æ®µ">ä»£ç æ®µ</h2>
<p>ä»£ç æ®µé€šå¸¸ç”¨æ¥å­˜æ”¾ç¨‹åºæ‰§è¡Œä»£ç çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚è¿™éƒ¨åˆ†åŒºåŸŸçš„å¤§å°å†ç¨‹åºè¿è¡Œå‰å°±å·²ç»ç¡®å®šï¼Œå¹¶ä¸”å†…å­˜åŒºåŸŸé€šå¸¸å€¼å±äºåªè¯»ã€‚åœ¨ä»£ç æ®µä¸­ï¼Œä¹Ÿæœ‰å¯èƒ½åŒ…å«ä¸€äº›åªè¯»çš„å¸¸æ•°å˜é‡ï¼Œå¦‚å­—ç¬¦ä¸²å¸¸é‡ç­‰ç­‰ã€‚</p>
<h2 id="æ•°æ®æ®µ">æ•°æ®æ®µ</h2>
<p>æ•°æ®æ®µé€šå¸¸ç”¨æ¥å­˜æ”¾å·²ç»åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡ã€‚</p>
<h2 id="bssæ®µ">BSSæ®µ</h2>
<p>BSSæ®µé€šå¸¸ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­ä¸ºåˆå§‹åŒ–çš„å…¨å±€å˜é‡çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚BSSæ˜¯è‹±æ–‡Black Started by Symbolçš„ç®€ç§°ã€‚è¿™ä¸ªåŒºæ®µä¸­çš„æ•°æ®åœ¨ç¨‹åºè¿è¡Œå‰å°†è¢«è‡ªåŠ¨åˆå§‹åŒ–ä¸º0ã€‚</p>
<h2 id="å †">å †</h2>
<p>å‰é¢å­¦ä¹ çš„åŠ¨æ€å†…å­˜ç®¡ç†ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨è¿™é‡Œé¢è¿›è¡Œçš„ã€‚å †é‡Œé¢ä¸»è¦æ”¾ä¸€äº›åŠ¨æ€çš„å†…å­˜æ®µï¼Œèƒ½å¤Ÿæ‰©å±•å’Œç¼©å°ã€‚</p>
<h2 id="æ ˆ">æ ˆ</h2>
<p>å¤§å®¶å¹³æ—¶æ‰€å¬åˆ°çš„<strong>å †æ ˆ</strong>è¿™ä¸ªè¯ï¼Œå®é™…ä¸Šå°±æ˜¯æŒ‡çš„æ ˆã€‚æ ˆæ˜¯å‡½æ•°æ‰§è¡Œçš„å†…å­˜åŒºåŸŸï¼Œé€šå¸¸å’Œå †å…±äº«åŒä¸€ç‰‡åŒºåŸŸã€‚å †å’Œæ ˆæ˜¯Cè¯­è¨€è¿è¡Œæ—¶çš„é‡è¦å…ƒç´ ä¹‹ä¸€ã€‚è€Œå®ƒä»¬ä¹‹é—´ä¹Ÿæœ‰å¾ˆå¤§çš„ä¸åŒï¼›<strong>å †</strong>ç”±ç¨‹åºå‘˜æ‰‹åŠ¨ç”³è¯·ï¼Œè€Œ<strong>æ ˆ</strong>ç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…ï¼›<strong>å †</strong>ç”±ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾ï¼Œè€Œ<strong>æ ˆ</strong>ç”±ç³»ç»Ÿè‡ªåŠ¨é‡Šæ”¾ï¼›<strong>å †</strong>çš„ç”Ÿå­˜å‘¨æœŸç”±ç¨‹åºå‘˜æ¥å†³å®šï¼Œå¹¶ä¸”ä¸åŒå‡½æ•°ä¹‹é—´<strong>å¯ä»¥</strong>è‡ªç”±è®¿é—®ï¼Œè€Œ<strong>æ ˆ</strong>çš„ç”Ÿå­˜å‘¨æœŸç”±å‡½æ•°è°ƒç”¨å¼€å§‹åˆ°å‡½æ•°è¿”å›æ—¶ç»“æŸï¼Œå‡½æ•°ä¹‹é—´çš„å±€éƒ¨å˜é‡<strong>ä¸å¯ä»¥</strong>äº’ç›¸è®¿é—®ã€‚</p>
<h1 id="é«˜çº§å®å®šä¹‰">é«˜çº§å®å®šä¹‰</h1>
<p>ä½œä¸ºCè¯­è¨€çš„ä¸‰å¤§é¢„å¤„ç†å‘½ä»¤ä¹‹ä¸€ï¼Œå®å®šä¹‰çš„ä½œç”¨æ—¶æ›¿æ¢ã€‚ä½†æ˜¯ï¼Œå®å®šä¹‰å°±ç®—å†å¤æ‚ï¼Œä¹Ÿåªæ˜¯æ›¿æ¢ä¸åšä»»ä½•çš„è®¡ç®—æˆ–è€…è¡¨è¾¾å¼æ±‚è§£ã€‚</p>
<h2 id="ä¸å¸¦å‚æ•°çš„å®å®šä¹‰">ä¸å¸¦å‚æ•°çš„å®å®šä¹‰</h2>
<p>è¿™ç§å°±æ˜¯æˆ‘ä»¬å¸¸è§çš„ç›´æ¥æ›¿æ¢ï¼š</p>
<pre><code class="language-c">#define PI 3.14
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>ä¸ºäº†å’Œæ™®é€šå˜é‡åŒºåˆ†ï¼Œå®çš„åå­—ä¸€èˆ¬çº¦å®šä¸ºå…¨å¤§å†™</li>
<li>å®å®šä¹‰åªæ˜¯ç®€å•çš„æ›¿æ¢ï¼Œä¸”æ˜¯åœ¨ç¼–è¯‘å‰å°±å¤„ç†å¥½äº†ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ä¸ä¼šå¯¹å®å®šä¹‰çš„è¯­æ³•è¿›è¡Œæ£€æŸ¥</li>
<li>å®å®šä¹‰çš„ä½œç”¨èŒƒå›´æ˜¯ä»å®šä¹‰å¼€å§‹åˆ°ç¨‹åºçš„ç»“æŸ</li>
<li>å¯ä»¥ä½¿ç”¨#undefå‘½ä»¤ä¸­æ­¢å®å®šä¹‰çš„ä½œç”¨åŸŸ</li>
<li>å®å®šä¹‰å…è®¸åµŒå¥—(åœ¨å®å®šä¹‰ä¸­ä½¿ç”¨å·²å®šä¹‰çš„å®)</li>
</ul>
</blockquote>
<h2 id="å¸¦å‚æ•°çš„å®å®šä¹‰">å¸¦å‚æ•°çš„å®å®šä¹‰</h2>
<p>Cè¯­è¨€çš„å®å®šä¹‰å¯ä»¥å¸¦å‚æ•°ã€‚å’Œå‡½æ•°ç±»ä¼¼ï¼Œåœ¨å®å®šä¹‰é‡Œå‡ºç°çš„å«åš<strong>å½¢å‚</strong>ï¼Œè€Œåœ¨è°ƒç”¨çš„æ—¶å€™å®é™…ä¼ é€’çš„å«åš <strong>å®å‚</strong>ã€‚</p>
<p>å¦‚ï¼š</p>
<pre><code class="language-c">#define MAX(x, y) (((x) &gt; (y)) ? (x) : (y))
</code></pre>
<p>è¿™ä¸ªå°±æ˜¯ç”¨æ¥æ¯”è¾ƒxå’Œyå“ªä¸ªæ›´å¤§ï¼š</p>
<pre><code class="language-c">//Example 07
#include &lt;stdio.h&gt;
#define MAX(x, y) (((x) &gt; (y)) ? (x) : (y))

int main(void)
{
    int x, y;
    printf(&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•´æ•°ï¼š&quot;)ï¼›
    scanf(&quot;%d %d&quot;, &amp;x, &amp;y);
    printf(&quot;%dæ›´å¤§ï¼&quot;, MAX(x, y));
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 08
è¯·è¾“å…¥ä¸¤ä¸ªæ•´æ•°ï¼š3 5
5æ›´å¤§ï¼
</code></pre>
<p>å¦å¤–ï¼Œå‚æ•°çš„æœ€å¤–å±‚å»ºè®®åŠ ä¸Šä¸€ä¸ªå°æ‹¬å·æ¥ç¡®ä¿ä¼˜å…ˆçº§ï¼Œä¸ç„¶å¾ˆå¯èƒ½ä¼šå‡ºç°éšå¼çš„bugã€‚</p>
<h1 id="å†…è”å‡½æ•°">å†…è”å‡½æ•°</h1>
<p>ç”±äºé¢„ç¼–è¯‘å‘½ä»¤åœ¨ç¼–è¯‘ä¹‹å‰å°±å·²ç»å¤„ç†å¥½äº†ã€‚è€Œå‡½æ•°æ¯æ¬¡çš„è°ƒç”¨å´è¿˜è¦ç”³è¯·æ ˆç©ºé—´ã€‚çš„ç¡®ï¼Œä½¿ç”¨å«å‚å®å®šä¹‰æ•ˆç‡ç¡®å®è¦æ›´é«˜ã€‚</p>
<p>ä¸è¿‡ï¼Œæœ‰çš„æ—¶å€™å´ä¼šå‡ºç°ä¸€äº›bugï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="language-c">//Example 09
#define SQUARE(x) ((x) * (x))
#include &lt;stdio.h&gt;

int main(void)
{
    int i = 1;
    while (i &lt;= 10)
    {
        printf(&quot;%dçš„å¹³æ–¹æ ¹æ˜¯%d\n&quot;, i-1, SQUARE(i++));
    }
    return 0;
}
</code></pre>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 09
2çš„å¹³æ–¹æ ¹æ˜¯1
4çš„å¹³æ–¹æ ¹æ˜¯9
6çš„å¹³æ–¹æ ¹æ˜¯25
8çš„å¹³æ–¹æ ¹æ˜¯49
10çš„å¹³æ–¹æ ¹æ˜¯81
</code></pre>
<p>è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬åˆšåˆšè¯´è¿‡ï¼Œå®å®šä¹‰åªæ˜¯ç®€å•çš„æ›¿æ¢ã€‚é‚£ä¹ˆ<code>SQUARE(i++)</code>æœ€ç»ˆä¼šè¢«æ›¿æ¢ä¸º<code>((i++) * (i++))</code>ï¼Œé‚£ä¹ˆæ²¡è°ƒç”¨ä¸€æ¬¡å®ï¼Œå°±è¦è‡ªå¢ä¸¤æ¬¡ã€‚</p>
<p>é‚£ä¹ˆæˆ‘åˆæƒ³ç”¨å®å®šä¹‰ï¼Œå´åˆå‘é¿å¼€è¿™ä¸ªbugï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>å°±æ˜¯è°ƒç”¨å†…è”å‡½æ•°ï¼š</p>
<pre><code class="language-c">inline int square(int);
</code></pre>
<p>å’Œæ™®é€šçš„å‡½æ•°å®šä¹‰ä¸€æ ·ï¼Œåªä¸è¿‡åœ¨å‰é¢åŠ ä¸Š<code>inline</code>å³å¯ã€‚æŒ‡å®šä¸€ä¸ªå‡½æ•°ä¸ºå†…è”å‡½æ•°ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šåƒå¤„ç†å®å®šä¹‰é‚£æ ·ï¼Œå°†æ•´ä¸ªå‡½æ•°ç›´æ¥åœ¨<code>main</code>å‡½æ•°ä¸­å±•å¼€ã€‚</p>
<p>ä¸è¿‡ï¼Œå†…è”å‡½æ•°ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ã€‚è™½ç„¶èŠ‚çœäº†è¿è¡Œçš„æ—¶é—´ï¼Œä½†æ˜¯æ¯ä¸ªåœ°æ–¹éƒ½è¦è¿›è¡Œæ›¿æ¢ï¼Œå®é™…ä¸Šä¹Ÿå¢åŠ äº†ç¼–è¯‘çš„æ—¶é—´ã€‚å†è€…ï¼Œå…¶å®ç°åœ¨çš„ç¼–è¯‘å™¨ä¹Ÿå¾ˆèªæ˜ï¼Œå¯¹å†…è”å‡½æ•°ä¹Ÿæœ‰ä¸€å¥—åƒå¯„å­˜å™¨å˜é‡é‚£æ ·çš„ä¼˜åŒ–æœºåˆ¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ä½ å£°æ˜çš„å†…è”å‡½æ•°éƒ½èƒ½å¤Ÿæˆä¸ºå†…è”å‡½æ•°ï¼Œè€Œæœ‰äº›æ™®é€šå‡½æ•°ä¹Ÿæœ‰å¯èƒ½ä¼šæˆä¸ºå†…è”å‡½æ•°ã€‚</p>
<h1 id="ä¸€äº›å°æŠ€å·§">ä¸€äº›å°æŠ€å·§</h1>
<h2 id="å’Œ">#å’Œ##</h2>
<p>åœ¨å«å‚å®å®šä¹‰ä¸­ï¼Œ#è¿ç®—ç¬¦åé¢åº”è¯¥è·Ÿä¸€ä¸ªå‚æ•°ï¼Œé¢„å¤„ç†å™¨ä¼šæŠŠè¿™ä¸ªå‚æ•°è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼š</p>
<pre><code class="language-c">//Example 10
#define STR(s) # s
#include &lt;stdio.h&gt;

int main(void)
{
    printf(&quot;%s\n&quot;, STR(TechZone));
    return 0;
}
</code></pre>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 10
TechZone
</code></pre>
<p>è™½ç„¶ç¬”è€…ä¼ å…¥çš„ä¸æ˜¯å­—ç¬¦ä¸²å½¢å¼ï¼Œä½†æ˜¯<code>#</code>å°†å…¶å˜ä¸ºäº†å­—ç¬¦ä¸²ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä»¥<code>%s</code>çš„å½¢å¼è¾“å‡ºã€‚</p>
<p>å¹¶ä¸”ä¼ å…¥å­—ç¬¦ä¸­ï¼Œæ‰€æœ‰çš„ä¿ç•™å­—ç¬¦éƒ½ä¼šåšè½¬ä¹‰å¤„ç†ï¼Œæ¯”å¦‚<code>\</code>ä¼šè¢«æ›¿æ¢ä¸º<code>\\</code>ã€‚å­˜åœ¨å¤šä¸ªç©ºç™½å­—ç¬¦çš„æ—¶å€™ï¼Œä¼šè¢«æ›¿æ¢ä¸ºä¸€ä¸ªç©ºæ ¼ã€‚</p>
<p>è€Œ##è¿ç®—ç¬¦è¢«æˆä¸ºè¿æ¥è¿ç®—ç¬¦ï¼Œå¦‚ï¼š</p>
<pre><code class="language-c">//Example 11
#define TOGETHER(x, y) x ## y
#include &lt;stdio.h&gt;
int main(void)
{
    printf(&quot;%d\n&quot;, TOGETHER(5, 20));
    return 0;
}
</code></pre>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 11
520
</code></pre>
<h2 id="å¯å˜å‚æ•°">å¯å˜å‚æ•°</h2>
<p>ä¹‹å‰å­¦ä¹ äº†å¦‚ä½•è®©å‡½æ•°æ”¯æŒå¯å˜å‚æ•°ï¼Œå¸¦å‚æ•°çš„å®å®šä¹‰ä¹Ÿæ”¯æŒä½¿ç”¨å¯å˜å‚æ•°ï¼š</p>
<pre><code class="language-c">#define SHOWLIST(...) printf(#__VA_AGES__)
</code></pre>
<p>å¦‚ï¼š</p>
<pre><code class="language-c">//Example 12
#define SHOWLIST(...) printf(#__VA_AGES__)
#include &lt;stdio.h&gt;

int main(void)
{
    SHOWLIST(TechZone, HarrisWilde, C);
    return 0;
}
</code></pre>
<p>ç”±äºåœ¨VS2019ä¸‹æ— æ³•æ”¯æŒç¼–è¯‘ï¼Œè¿™æ¬¡çš„ç»“æœä½¿ç”¨Linuxä¸‹çš„GCCæ¥æ‰§è¡Œï¼š</p>
<pre><code>//Consequence 12 in GCC
TechZone, HarrisWilde, C
</code></pre>
<p>å¯å˜å‚æ•°æ˜¯å…è®¸å­˜åœ¨ç©ºå‚æ•°çš„ï¼Œå¦‚æœæ˜¯ç©ºå‚æ•°ï¼Œåˆ™##å‰é¢çš„é€—å·ä¹Ÿä¼šä¸€èµ·è¢«å»æ‰ï¼Œé¿å…å¯¼è‡´å‚æ•°æ•°é‡ä¸ä¸€è‡´ï¼š</p>
<pre><code class="language-c">//Example 13
#define PRINT(format, ...) printf(#format, ##__VA_AGES__)

int main(void)
{
    PRINT(num = %d\n, 10);
    PRINT(Hello, world!\n);
    return 0;
}
</code></pre>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 13 in GCC
num = 10
Hello, world!
</code></pre>
<p>å‡½æ•°çš„åŸºç¡€çŸ¥è¯†åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Cè¯­è¨€ä¹‹å‡½æ•°ï¼ˆä¸­ï¼‰]]></title>
        <id>https://harriswilde.github.io/post/IKKYqSXMf/</id>
        <link href="https://harriswilde.github.io/post/IKKYqSXMf/">
        </link>
        <updated>2020-02-06T13:47:02.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡">å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡</h1>
<h2 id="å±€éƒ¨å˜é‡">å±€éƒ¨å˜é‡</h2>
<p>åœ¨æˆ‘ä»¬å­¦ä¹ å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬æ‰€ç†è§£çš„å˜é‡ï¼Œåªä¸è¿‡æ˜¯åœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€ä¸ªå­˜å‚¨æ•°æ®çš„ä½ç½®ï¼Œå¹¶å–äº†ä¸ªæˆ‘ä»¬å¥½æ‡‚çš„åå­—è€Œå·²ã€‚å› ä¸ºæˆ‘ä»¬ä¹‹å‰å†™çš„ç¨‹åºåªæœ‰ä¸€ä¸ªä¸»å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬è§‰å¾—ï¼Œå®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼Œå°±åº”è¯¥å¯ä»¥éšæ—¶è°ƒç”¨ã€‚ä½†æ˜¯å­¦ä¹ äº†å‡½æ•°ä¹‹åï¼Œæˆ‘ä»¬å‘ç°ï¼Œä¸åŒå‡½æ•°ä¹‹é—´çš„å˜é‡æ˜¯ä¸èƒ½å¤Ÿç›¸äº’è°ƒç”¨çš„ï¼Œè¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="language-c">//Example 01
#include &lt;stdio.h&gt;
int main(void)
{
    int i = 100;
    printf(&quot;Before i = %d\n&quot;, i);
    for (int i = 0; i &lt;= 10; i++)//å†å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡i
    {
        printf(&quot;i = %d\n&quot;, i);
    }
    printf(&quot;After i = %d\n&quot;, i);
    return 0;
}
</code></pre>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 01
Before i = 100
i = 0
i = 1
i = 2
i = 3
i = 4
i = 5
i = 6
i = 7
i = 8
i = 9
i = 10
After i = 100
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨<code>for</code>å‡½æ•°é‡Œå’Œ<code>main</code>å‡½æ•°é‡Œéƒ½æœ‰ä¸€ä¸ª<code>i</code>å˜é‡ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨<code>for</code>å‡½æ•°é‡Œé¢å®šä¹‰çš„<code>i</code>å´å¯¹å¤–å±‚å‡½æ•°ä¸æ„æˆå½±å“ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå˜é‡ååº”è¯¥æ˜¯ä¸èƒ½å¤Ÿé‡å¤çš„ã€‚ä½†æ˜¯ï¼Œç”±äºæˆ‘ä»¬å®šä¹‰çš„ä½ç½®ä¸ä¸€æ ·ï¼ˆåœ¨ä¸åŒçš„å‡½æ•°ä¸­ï¼‰ï¼Œæ‰€ä»¥å˜é‡åé‡å¤åˆå˜å¾—åˆæ³•èµ·æ¥ã€‚è¿™å°±æ˜¯å±€éƒ¨å˜é‡çš„ç‰¹æ€§ï¼š<strong>åªèƒ½åœ¨è‡ªå·±çš„é¢†åŸŸé‡Œé¢å‘æŒ¥ä½œç”¨</strong>ã€‚</p>
<p>åƒæˆ‘ä»¬åˆšåˆšå®šä¹‰çš„<code>for</code>ä¸€æ ·ï¼ŒCè¯­è¨€å…è®¸éšå¤„å®šä¹‰å˜é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå˜é‡åœ¨éœ€è¦ç”¨åˆ°çš„æ—¶å€™å†å®šä¹‰ã€‚è¿™æ ·ä¹Ÿç¬¦åˆæˆ‘ä»¬çš„æ€ç»´æ–¹å¼ã€‚å› ä¸ºå½“ç¨‹åºå¾ˆåºå¤§çš„æ—¶å€™ï¼Œæ²¡æœ‰äººæ„¿æ„ç¿»åˆ°é¡¶ä¸Šå»çœ‹ä¸€ä¸ªå˜é‡çš„æ³¨é‡Šã€‚</p>
<h2 id="å…¨å±€å˜é‡">å…¨å±€å˜é‡</h2>
<p>æ—¢ç„¶æœ‰å±€éƒ¨å˜é‡ï¼Œé‚£ä¹ˆå…¨å±€å˜é‡ä¹Ÿç…§æ ·ä¸å¯å°‘ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<pre><code class="language-c">//Example 02
#include &lt;stdio.h&gt;
void f1(void);
void f2(void);
void f3(void);
int a = 0;//å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡

void f1(void)
{
    a++;
}

void f2(void)
{
    a++;
}

void f3(void)
{
    a++;
}

int main(void)
{
    f1();
    f2();
    f3();
    printf(&quot;a = %d\n&quot;, ++a);
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 02
a = 4
</code></pre>
<p>æˆ‘ä»¬å‘ç°ï¼Œå…¨å±€å˜é‡åœ¨æ¯ä¸€ä¸ªå‡½æ•°é‡Œé¢çš„æ›´æ”¹éƒ½â€œæœ‰æ•ˆâ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…¨å±€å˜é‡æ˜¯è´¯ç©¿æ•´ä¸ªç¨‹åºå§‹ç»ˆçš„ã€‚</p>
<p>æœ‰çš„å°ä¼™ä¼´å¯èƒ½ä¼šå¥½å¥‡ï¼Œå¦‚æœå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡é‡åäº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>é‚£æˆ‘ä»¬å°±æ¥è¯•è¯•ï¼š</p>
<pre><code class="language-c">//Example 03
#include &lt;stdio.h&gt;
void f(void);
int a, b = 100;
void f(void)
{
    int b;
    a = 50; b = 101;
    printf(&quot;func, a = %d, b = %d\n&quot;, a, b);
}

int main(void)
{
    printf(&quot;Main, a = %d, b = %d\n&quot;, a, b);
    f();
    printf(&quot;Main, a = %d, b = %d\n&quot;, a, b);
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 03
Main, a = 0, b = 100
func, a = 50, b = 101
Main, a = 50, b = 100
</code></pre>
<p>æˆ‘ä»¬å‘ç°ï¼Œåå­—å«<code>a</code>çš„å˜é‡åªæœ‰å…¨å±€å˜é‡ï¼Œé‚£ä¹ˆè¢«èµ‹å€¼ä¹‹åå°±ç­‰äºåœ¨å‡½æ•°<code>f()</code>ä¸­èµ‹çš„å€¼ã€‚ä½†æ˜¯<code>b</code>å°±ä¸ä¸€æ ·äº†ã€‚åœ¨å‡½æ•°<code>f()</code>ä¸­ï¼Œä¹Ÿæœ‰ä¸€ä¸ªå˜é‡å«åš<code>b</code>ï¼Œé‚£ä¹ˆæ­¤æ—¶ç¼–è¯‘å™¨çš„åšæ³•æ˜¯ï¼Œåœ¨å‡½æ•°<code>f()</code>é‡Œå…ˆæš‚æ—¶å±è”½å…¨å±€å˜é‡<code>b</code>ï¼Œä½¿ç”¨è‡ªå·±çš„å±€éƒ¨å˜é‡ã€‚ç­‰èµ°å‡ºäº†å‡½æ•°<code>f()</code>ï¼Œå±€éƒ¨å˜é‡è¢«é‡Šæ”¾ã€‚</p>
<p>è€Œæˆ‘ä»¬è¿˜å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å‡ºæ²¡æœ‰è¢«åˆå§‹åŒ–çš„<code>a</code>ï¼è¿™ä¹Ÿæ˜¯å…¨å±€å˜é‡çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œä¸åŒäºå±€éƒ¨å˜é‡ï¼Œå…¨å±€å˜é‡åœ¨æ²¡æœ‰æ‰‹åŠ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨åˆå§‹åŒ–ä¸º<code>0</code>è€Œä¸æ˜¯åƒå±€éƒ¨å˜é‡é‚£æ ·çš„å¾ˆå°çš„ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„æ•°ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœæ²¡æœ‰éœ€è¦ï¼Œå°½é‡ä¸è¦å¤§é‡ä½¿ç”¨å…¨å±€å˜é‡ã€‚å› ä¸ºå…¨å±€å˜é‡çš„å†…å­˜å°†ä¼šä¼´éšç€è¿™ä¸ªç¨‹åºï¼Œç›´åˆ°ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚å¦‚æœå¤§é‡ä½¿ç”¨å…¨å±€å˜é‡çš„è¯ï¼Œå¯èƒ½ä¼šé€ æˆå†…å­˜å ç”¨è¿‡å¤šç­‰é—®é¢˜ã€‚è¿™åœ¨åµŒå…¥å¼å¼€å‘è¿™ç§é¢†åŸŸï¼Œå†…å­˜ç©ºé—´å¯¸åœŸå¯¸é‡‘ï¼Œä¸å½“ä½¿ç”¨å…¨å±€å˜é‡ä¼šå¯¼è‡´èµ„æºçš„æµªè´¹ã€‚å…¶æ¬¡ï¼Œå…¨å±€å˜é‡ä¼šé€ æˆç¨‹åºå¯è¯»æ€§å˜å·®ã€‚æœ€åï¼Œå…¨å±€å˜é‡ä¼šä½¿å¾—ç¨‹åºç‰µè¿æ€§å˜å¼ºï¼Œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«çš„æƒ…å†µå¯èƒ½ä¼šå†æ¬¡å‡ºç°ã€‚</p>
<p>å› æ­¤å…¨å±€å˜é‡è™½ç„¶æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œä½†ä¹Ÿè¦è°¨æ…ä½¿ç”¨ã€‚</p>
<h1 id="ä½œç”¨åŸŸå’Œé“¾æ¥å±æ€§">ä½œç”¨åŸŸå’Œé“¾æ¥å±æ€§</h1>
<p>åœ¨ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬ç®€å•åœ°äº†è§£äº†ä¸åŒçš„å˜é‡ï¼Œå®ƒèƒ½å¤Ÿæœ‰ä¸åŒçš„ä½œç”¨èŒƒå›´ï¼Œé‚£ä¹ˆè¿™ä¸ªèŒƒå›´ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„<strong>ä½œç”¨åŸŸ</strong>ã€‚Cè¯­è¨€çš„ç¼–è¯‘å™¨ä¸€å…±èƒ½å¤Ÿç¡®è®¤4ç§ä¸åŒçš„ä½œç”¨åŸŸï¼š<code>ä»£ç å—ä½œç”¨åŸŸ</code> <code>æ–‡ä»¶ä½œç”¨åŸŸ</code> <code>åŸå‹ä½œç”¨åŸŸ</code> <code>å‡½æ•°ä½œç”¨åŸŸ</code></p>
<h2 id="ä»£ç å—ä½œç”¨åŸŸ">ä»£ç å—ä½œç”¨åŸŸ</h2>
<pre><code class="language-c">//Example 04
#include &lt;stdio.h&gt;
int main(void)
{
    int i = 1;
    {
        int i = 2;
        printf(&quot;i = %d\n&quot;, i);
    }
    {
        printf(&quot;i = %d\n&quot;, i);
        int i = 3;
        printf(&quot;i = %d\n&quot;, i);
    }
    printf(&quot;i = %d\n&quot;, i);
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 04
i = 2
i = 1
i = 3
i = 1
</code></pre>
<p>æˆ‘ä»¬é€šå¸¸ç®¡ä¸€ä¸ªå¤§æ‹¬å·é‡Œé¢çš„è¯­å¥å«åšä»£ç å—ï¼Œé‚£ä¹ˆçœ‹è¿™ä¸ªç¨‹åºï¼Œä¸€ä¸ªä»£ç å—é‡Œé¢çš„å˜é‡åªèƒ½ä½œç”¨äºæ‰€åœ¨çš„ä»£ç å—é‡Œï¼Œè¶…å‡ºäº†çš„å°±æ— æ•ˆäº†ã€‚è‹¥å­˜åœ¨ä»£ç å—åµŒå¥—ï¼Œé‚£ä¹ˆä¼˜å…ˆå†…å±‚ä»£ç å—çš„å˜é‡ã€‚è¿™å°±æ˜¯<strong>ä»£ç å—ä½œç”¨åŸŸ</strong>ã€‚</p>
<p>å½“ç„¶ï¼Œæœ‰ä¸€ç‚¹éœ€è¦è¯´è¯´ï¼Œå°±æ˜¯å‡½æ•°çš„å½¢å‚ä¹Ÿæ˜¯ä»£ç å—ä½œç”¨åŸŸï¼Œåªèƒ½ä½œç”¨äºå‡½æ•°å®šä¹‰ä»£ç å—é‡Œé¢ï¼Œå³ä¾¿å®ƒæ²¡æœ‰å†™åœ¨ä»£ç å—é‡Œé¢ã€‚</p>
<h2 id="æ–‡ä»¶ä½œç”¨åŸŸ">æ–‡ä»¶ä½œç”¨åŸŸ</h2>
<p>åœ¨ä»»ä½•ä»£ç å—ä¹‹å¤–å®šä¹‰çš„å˜é‡ï¼Œéƒ½å…·æœ‰<strong>æ–‡ä»¶ä½œç”¨åŸŸ</strong>ã€‚å®ƒä»¬çš„ä½œç”¨åŸŸæ˜¯ä»å˜é‡å£°æ˜å¼€å§‹ï¼Œä¸€ç›´åˆ°æ–‡ä»¶å°¾ç»“æŸã€‚å¦å¤–ï¼Œå‡½æ•°åä¹Ÿæ˜¯æ–‡ä»¶ä½œç”¨åŸŸï¼Œå› ä¸ºå‡½æ•°åæœ¬èº«ä¹Ÿåœ¨ä»£ç å—ä¹‹å¤–ã€‚</p>
<h2 id="åŸå‹ä½œç”¨åŸŸ">åŸå‹ä½œç”¨åŸŸ</h2>
<p>åŸå‹ä½œç”¨åŸŸåªé€‚åˆé‚£äº›åœ¨å‡½æ•°åŸå‹ä¸­å£°æ˜çš„å‚æ•°åã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å£°æ˜ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå½¢å‚çš„åå­—æ˜¯å¯ä»¥ä¸ç”¨å†™çš„ï¼Œåªéœ€è¦æŠŠç±»å‹å†™å¥½å°±è¡Œäº†ã€‚ä½†æ˜¯ï¼Œå…¶å®ä¸å¦¨å¯ä»¥è¯•è¯•å†™ä¸Šåå­—ï¼Œå³ä¾¿è¿™ä¸ªåå­—å’Œæ­£å¼å®šä¹‰çš„æ—¶å€™å½¢å‚çš„åå­—ä¸ä¸€æ ·ï¼Œä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ï¼ˆå½“ç„¶è¿™æ ·åšæ¯«æ— æ„ä¹‰ï¼‰ï¼Œè¿™å…¶å®å°±æ˜¯åŸå‹ä½œç”¨åŸŸåœ¨èµ·ä½œç”¨ã€‚</p>
<h2 id="å‡½æ•°ä½œç”¨åŸŸ">å‡½æ•°ä½œç”¨åŸŸ</h2>
<p>å‡½æ•°ä½œç”¨åŸŸåªé€‚ç”¨äº<code>goto</code>è¯­å¥çš„æ ‡ç­¾ï¼Œä½œç”¨æ˜¯å°†<code>goto</code>è¯­å¥çš„æ ‡ç­¾é™å®šåœ¨ä¸€ä¸ªå‡½æ•°çš„å†…éƒ¨ï¼Œé¿å…å‡ºç°é‡åçš„æ ‡ç­¾ã€‚</p>
<h2 id="é“¾æ¥å±æ€§">é“¾æ¥å±æ€§</h2>
<p>ç®€å•æ¥è¯´ï¼Œç¼–è¯‘å™¨å°†æºä»£ç è½¬æ¢æˆæœºå™¨ç çš„æ—¶å€™éœ€è¦æœ‰ä¸¤ä¸ªæ­¥éª¤ï¼š<strong>ç¼–è¯‘</strong>å’Œ<strong>é“¾æ¥</strong>ã€‚</p>
<p>æ‰€è°“ç¼–è¯‘ï¼Œå°±æ˜¯å°†æˆ‘ä»¬å†™çš„æºä»£ç è½¬æ¢ä¸ºæœºå™¨ç ï¼Œè€Œé“¾æ¥ï¼Œå°±æ˜¯å°†ç›¸å…³çš„åº“æ–‡ä»¶æ·»åŠ è¿›æ¥ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨å†™ç¨‹åºçš„æ—¶å€™åŠ å…¥çš„å¤´æ–‡ä»¶ï¼Œåœ¨æœ€ç»ˆç”Ÿæˆçš„æ—¶å€™å°±æ˜¯è¦é“¾æ¥è¿›æ¥çš„ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¤§å‹ç¨‹åºæ˜¯ç”±å¾ˆå¤šæºæ–‡ä»¶æ„æˆçš„ï¼Œé‚£ä¹ˆåœ¨ä¸åŒçš„æ–‡ä»¶ä¸­çš„åŒåæ ‡è¯†ç¬¦ï¼Œç¼–è¯‘å™¨æ˜¯å…¥åœºå¤„ç†çš„å‘¢ï¼Ÿ</p>
<p>åœ¨Cè¯­è¨€ä¸­ï¼Œé“¾æ¥å±æ€§ä¸€å…±æœ‰ä»¥ä¸‹3ç§ï¼š</p>
<ul>
<li>external(å¤–éƒ¨çš„)ï¼šå¤šä¸ªæ–‡ä»¶ä¸­å£°æ˜çš„åŒåæ ‡è¯†ç¬¦è¡¨ç¤ºåŒä¸€ä¸ªå®ä½“</li>
<li>internal(å†…éƒ¨çš„)ï¼šå•ä¸ªæ–‡ä»¶ä¸­å£°æ˜çš„åŒåæ ‡è¯†ç¬¦è¡¨ç¤ºåŒä¸€ä¸ªå®ä½“</li>
<li>none(æ— )ï¼šå£°æ˜çš„åŒåæ ‡è¯†ç¬¦è¢«å½“ä½œç‹¬ç«‹ä¸åŒçš„å®ä½“ã€‚æ¯”å¦‚ï¼Œå‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚</li>
</ul>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå…·å¤‡æ–‡ä»¶ä½œç”¨åŸŸçš„æ ‡è¯†ç¬¦æ‹¥æœ‰<code>external</code>å±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æ ‡è¯†ç¬¦å…è®¸è·¨æ–‡ä»¶è®¿é—®ã€‚ä½¿ç”¨<code>static</code>å¯ä»¥ä½¿åŸå…ˆæ‹¥æœ‰<code>external</code>å±æ€§çš„æ ‡è¯†ç¬¦å˜ä¸º<code>internal</code>å±æ€§ã€‚ä½†æ˜¯<code>static</code>åªèƒ½ä¿®æ”¹å…·æœ‰æ–‡ä»¶ä½œç”¨åŸŸçš„æ ‡è¯†ç¬¦ï¼Œå¹¶ä¸”æ˜¯ä¸å¯é€†ä¿®æ”¹ã€‚</p>
<h1 id="ç”Ÿå­˜æœŸå’Œå­˜å‚¨ç±»å‹">ç”Ÿå­˜æœŸå’Œå­˜å‚¨ç±»å‹</h1>
<h2 id="ç”Ÿå­˜æœŸ">ç”Ÿå­˜æœŸ</h2>
<p>ä¸Šä¸€èŠ‚æˆ‘ä»¬ç”¨ç©ºé—´çš„è§’åº¦å»è§£é‡Šäº†ä¸åŒçš„å˜é‡ï¼Œä½†å…¶å®ï¼Œè¿˜å¯ä»¥ä»æ—¶é—´çš„è§’åº¦æ¥åˆ†æã€‚</p>
<p>Cè¯­è¨€çš„å˜é‡é€šå¸¸æœ‰ä¸¤ç§ç”Ÿå­˜æœŸï¼Œé™æ€å­˜å‚¨æœŸ(static storage duration)å’Œè‡ªåŠ¨å­˜å‚¨æœŸ(automatic storage duration)ã€‚</p>
<p>å…·æœ‰æ–‡ä»¶ä½œç”¨åŸŸçš„å˜é‡å…·æœ‰é™æ€å­˜å‚¨æœŸï¼ˆå¦‚å…¨å±€å˜é‡ï¼‰ï¼Œå‡½æ•°åä¹Ÿæœ‰é™æ€å­˜å‚¨æœŸã€‚é™æ€å­˜å‚¨æœŸçš„å˜é‡åœ¨ç¨‹åºæ‰§è¡Œçš„æœŸé—´å†…å°†ä¸€ç›´å æ®å­˜å‚¨ç©ºé—´ã€‚</p>
<p>å…·æœ‰ä»£ç å—ä½œç”¨åŸŸçš„å˜é‡é€šå¸¸å…·æœ‰è‡ªåŠ¨å­˜å‚¨æœŸï¼ˆå¦‚å±€éƒ¨å˜é‡å’Œå½¢å‚ï¼‰ï¼Œå…·æœ‰è‡ªåŠ¨å­˜å‚¨æœŸçš„å˜é‡å°†åœ¨ä»£ç å—æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™é‡Šæ”¾å†…å­˜ã€‚</p>
<h2 id="å­˜å‚¨ç±»å‹">å­˜å‚¨ç±»å‹</h2>
<p>å˜é‡çš„å­˜å‚¨ç±»å‹å®é™…ä¸Šæ˜¯æŒ‡å­˜å‚¨å˜é‡å€¼çš„å†…å­˜ç±»å‹ã€‚Cè¯­è¨€æä¾›äº†5ç§å­˜å‚¨ç±»å‹ï¼š<code>auto</code> <code>register</code> <code>static</code> <code>extern</code> <code>typedef</code></p>
<h3 id="1-è‡ªåŠ¨å˜é‡">1. è‡ªåŠ¨å˜é‡</h3>
<p>åœ¨ä»£ç å—ä¸­å£°æ˜çš„å˜é‡é»˜è®¤å°±æ˜¯è‡ªåŠ¨å˜é‡(auto)ã€‚</p>
<pre><code class="language-c">//Example 05
#include &lt;stdio.h&gt;
int main(void)
{
    auto int a, b, c;
    return 0;
}
</code></pre>
<p>ä½†æ˜¯ç”±äºæ˜¯é»˜è®¤å­˜å‚¨ç±»å‹ï¼Œæ‰€ä»¥<code>auto</code>ä¸€èˆ¬ä¸å†™ä¹Ÿå®Œå…¨æ²¡é—®é¢˜ã€‚å‡½æ•°ä¸­çš„å½¢å‚ã€å±€éƒ¨å˜é‡ä»¥åŠå¤åˆè¯­å¥ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡éƒ½å…·æœ‰è‡ªåŠ¨å˜é‡ã€‚è‡ªåŠ¨å˜é‡æ‹¥æœ‰ä»£ç å—ä½œç”¨åŸŸã€è‡ªåŠ¨å­˜å‚¨æœŸå’Œç©ºé“¾æ¥å±æ€§ã€‚</p>
<h3 id="2-å¯„å­˜å™¨å˜é‡">2. å¯„å­˜å™¨å˜é‡</h3>
<p>å¦‚æœä½ å­¦è¿‡æ±‡ç¼–è¯­è¨€ï¼Œæˆ–è€…å¯¹è®¡ç®—æœºçš„åŸç†æ¯”è¾ƒäº†è§£çš„è¯ï¼Œä¸€å®šæ²¡å°‘å¬è¯´<strong>å¯„å­˜å™¨</strong>è¿™ä¸ªè¯ã€‚å¯„å­˜åŠå°±é›†æˆåœ¨CPUå†…éƒ¨ï¼Œå› æ­¤å®ƒå’ŒCPUä¹‹é—´çš„äº¤æµå‡ ä¹å¯ä»¥è¯´æ²¡æœ‰å»¶è¿Ÿã€‚</p>
<p>å¦‚æœä½ ç”³è¯·äº†å¯„å­˜å™¨å˜é‡ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½è¢«å­˜å‚¨åˆ°å¯„å­˜å™¨é‡Œé¢å»ã€‚å½“ç„¶ï¼Œç¼–è¯‘å™¨ä¹Ÿæœ‰è‡ªå·±çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œå®ƒä¼šåœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™æƒè¡¡å“ªäº›å˜é‡æ›´åº”è¯¥è¢«æ”¾åˆ°å¯„å­˜å™¨çš„ä½ç½®ï¼Œå› æ­¤ï¼Œä½ çš„ç”³è¯·åªæ˜¯åšä¸€ä¸ªå‚è€ƒè€Œå·²ã€‚é‚£ä¹ˆé‚£äº›æ²¡æœ‰è¢«æ”¾å…¥å¯„å­˜å™¨çš„å˜é‡å°±ä¼šæˆä¸º<strong>è‡ªåŠ¨å˜é‡</strong>ï¼Œæ‰€ä»¥ï¼Œå¯„å­˜å™¨å˜é‡å’Œè‡ªåŠ¨å˜é‡åœ¨å¾ˆå¤šåœ°æ–¹æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ‹¥æœ‰ä»£ç å—ä½œç”¨åŸŸã€è‡ªåŠ¨å­˜å‚¨æœŸå’Œç©ºé“¾æ¥å±æ€§ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¯„å­˜å™¨å˜é‡çš„è¯ï¼Œé‚£ä¹ˆç†è®ºä¸Šå°±æ²¡æ³•é€šè¿‡**å–åœ°å€è¿ç®—ç¬¦&amp;**æ¥è·å–åœ°å€äº†ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ˜¯é’ˆå¯¹å†…å­˜çš„ã€‚</p>
<pre><code class="language-c">//Example 06
#include &lt;stdio.h&gt;
int main(void)
{
    register int i = 100;
    printf(&quot;addr of i is %p\n&quot;, &amp;i);
    return 0;
}
</code></pre>
<p>ä½†æ˜¯VSå¯èƒ½å¯¹è¿™ç§ä»£ç æœ‰ä¼˜åŒ–ï¼Œå°†å˜é‡è½¬æ¢æˆè‡ªåŠ¨å˜é‡äº†ï¼š</p>
<pre><code>//Consequence 06 of Visual Studio 2019
addr of i is 00CFFE90
</code></pre>
<h3 id="3-é™æ€å±€éƒ¨å˜é‡">3. é™æ€å±€éƒ¨å˜é‡</h3>
<p><code>static</code>ç”¨äºæè¿°å…·æœ‰æ–‡ä»¶ä½œç”¨åŸŸçš„å˜é‡æˆ–è€…å‡½æ•°æ—¶ï¼Œè¡¨ç¤ºå°†å…¶é“¾æ¥å±æ€§ä»<code>external</code>ä¿®æ”¹æˆ<code>internal</code>ï¼Œå®ƒçš„ä½œç”¨èŒƒå›´å°±å˜æˆäº†ä»…å½“å‰æ–‡ä»¶å¯è®¿é—®ã€‚å¦‚æœ<code>static</code>ç”¨äºæè¿°å±€éƒ¨å˜é‡ï¼Œé‚£å¯å°±ä¸å¤ªä¸€æ ·äº†ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå±€éƒ¨å˜é‡æ˜¯è‡ªåŠ¨å˜é‡ï¼Œå…·æœ‰è‡ªåŠ¨å­˜å‚¨æœŸã€‚å¦‚æœä½¿ç”¨äº†<code>static</code>æ¥å£°æ˜ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†å±€éƒ¨å˜é‡æŒ‡å®šä¸ºé™æ€å±€éƒ¨å˜é‡(static)ã€‚è¿™ä½¿å¾—å±€éƒ¨å˜é‡å…·æœ‰é™æ€å­˜å‚¨æœŸï¼Œæ‰€ä»¥å®ƒçš„ç”Ÿå­˜æœŸå’Œå…¨å±€å˜é‡ä¸€æ ·ã€‚ä½†æ˜¯ä½œç”¨åŸŸä¾æ—§æ˜¯å±€éƒ¨å˜é‡ï¼Œåœ¨åˆ«çš„å‡½æ•°ä¸­æ˜¯æ— æ³•è®¿é—®è¿™ä¸ªå±€éƒ¨å˜é‡çš„ã€‚</p>
<h3 id="4-extern">4.  extern</h3>
<p><code>extern</code>å…³é”®å­—å‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå˜é‡æˆ–å‡½æ•°åœ¨åˆ«çš„åœ°æ–¹å·²ç»å®šä¹‰è¿‡äº†ï¼Œå…ˆåœ¨åˆ«çš„åœ°æ–¹æ‰¾æ‰¾ï¼Œä¸è¦æ€¥ç€æŠ¥é”™ã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå…³é”®è¯å¯ä»¥ä¸å†™ï¼Œä½†æ˜¯ä¸ºäº†ç¨‹åºæ›´åŠ å®Œå–„ï¼Œæ›´åŠ æ˜“è¯»ã€‚åœ¨å¤šäººåä½œçš„æ—¶å€™ï¼Œå¯ä»¥é¿å…å¾ˆå¤šé‡åçš„é—®é¢˜ã€‚</p>
<h3 id="5-typedef">5.  typedef</h3>
<p><code>typedef</code>ä¸å…¶ä»–å››ä¸ªå­˜å‚¨ç±»å‹çš„è¯­ä¹‰ä¸åŒï¼Œ<code>typedef</code>ä¸å†…å­˜å­˜å‚¨æ— å…³ï¼Œç”¨äºä¸ºæ•°æ®ç±»å‹å®šä¹‰ä¸€ä¸ªæ–°åå­—ã€‚</p>
<h1 id="é€’å½’">é€’å½’</h1>
<p>è™½ç„¶é€’å½’éš¶å±äºç®—æ³•çš„èŒƒç•´ï¼Œä½†æ˜¯å‡ ä¹æ‰€æœ‰çš„ç¨‹åºè¯­è¨€æ•™ç¨‹ï¼Œéƒ½ä¼šè®²åˆ°è¿™ä¸ªçŸ¥è¯†ç‚¹ã€‚å› ä¸ºï¼Œé€’å½’æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ç¼–ç¨‹æ€è·¯ï¼Œæœ‰æ—¶å€™ä¸€ä¸ªå¾ˆéš¾è§£å†³çš„é—®é¢˜ï¼Œä½¿ç”¨é€’å½’å°±å¯ä»¥å·§å¦™åœ°æå®šã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯é€’å½’">ä»€ä¹ˆæ˜¯é€’å½’</h2>
<p>é€’å½’è¯´ç™½äº†ï¼Œå°±æ˜¯å‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œè°ƒç”¨è‡ªèº«çš„è¡Œä¸ºã€‚å…¶å®é€’å½’åœ¨ç”Ÿæ´»ä¸­æœ‰å¾ˆå¤šå®ä¾‹ï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li>
<p>æ±‰è¯ºå¡”æ¸¸æˆ</p>
<figure data-type="image" tabindex="1"><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2591095191,1547695417&amp;fm=26&amp;gp=0.jpg" alt="æ±‰è¯ºå¡”æ¸¸æˆ" loading="lazy"></figure>
<p>è¿™ä¸ªæ¸¸æˆè¦æ±‚å°†ä¸­é—´çš„æŸ±å­çš„åœ†ç›˜å…¨éƒ¨ç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªæŸ±å­ä¸Šï¼Œè¦æ±‚æ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä¸ªåœ†ç›˜ï¼Œå¹¶ä¸”è¾ƒå¤§çš„åœ†ç›˜å§‹ç»ˆåœ¨ä¸‹æ–¹ã€‚</p>
</li>
<li>
<p>è°¢å°”å®¾æ–¯åŸºä¸‰è§’å½¢</p>
<figure data-type="image" tabindex="2"><img src="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=3361120212,184359007&amp;fm=26&amp;gp=0.jpg" alt="è°¢å°”å®¾æ–¯åŸºä¸‰è§’å½¢" loading="lazy"></figure>
<p>ä¸‰è§’å½¢é‡Œè¾¹å¡«å……ä¸‰è§’å½¢ï¼Œåªè¦ç©ºé—´å¤Ÿå¤§ï¼Œå®ƒå¯ä»¥æ’‘æ»¡æ•´ä¸ªå®‡å®™ã€‚</p>
</li>
</ol>
<p>ç”šè‡³è¿˜è¯ç”Ÿäº†ä¸€é—¨æ•°å­¦åˆ†æ”¯ï¼šåˆ†å½¢å‡ ä½•ã€‚ä¸“é—¨ç ”ç©¶è¿™ç§é€’å½’ç°è±¡ã€‚</p>
<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£ä¹ˆé€’å½’åœ¨ç¨‹åºé‡Œé¢è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<pre><code class="language-c">//Example 07
#include &lt;stdio.h&gt;
void r(void);
void r(void)
{
    printf(&quot;Hi!&quot;);
    r();
}
int main(void)
{
    r();
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 08
...
Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Hi!Segmentation fault
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ»¡å±å¹•çš„Hiï¼è¿™å°±æ˜¯åˆå­¦è€…ç»å¸¸ä¼šçŠ¯çš„é”™è¯¯ï¼Œç¨‹åºæ— ä¼‘æ­¢åœ°æ‰§è¡Œä¸‹å»ï¼Œç›´åˆ°æ¶ˆè€—æ‰æ‰€æœ‰çš„å†…å­˜ã€‚è¿™å°±åƒæˆ‘ä»¬è®²è¿‡çš„â€œä»å‰æœ‰åº§å±±ï¼Œå±±é‡Œæœ‰åº§åº™â€¦â€¦â€è¿™ä¸ªæ•…äº‹ä¸€æ ·ï¼Œæ²¡æœ‰ä¸­æ­¢çš„æ¡ä»¶ï¼Œè®²å¤šä¹…éƒ½è®²ä¸å®Œã€‚</p>
<p>ä¿®æ”¹ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-c">//Example 07 V2
#include &lt;stdio.h&gt;
void r(void);
void r(void)
{
    static int count = 5;//è®¾ç½®è®¡æ•°å˜é‡
    printf(&quot;Hi!\n&quot;);
    if (--count)//è®¾ç½®è·³å‡ºæ¡ä»¶
    {
        r();
    }
}

int main(void)
{
    r();
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 07 V2
Hi!
Hi!
Hi!
Hi!
Hi!
</code></pre>
<p>è¿™æ ·ï¼Œé€’å½’è¿™å¤´å°çŒ›å…½ï¼Œå°±è¿™æ ·è¢«æˆ‘ä»¬æ§åˆ¶ä½äº†ã€‚</p>
<h2 id="é€’å½’æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—">é€’å½’æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—</h2>
<p>æ–æ³¢é‚£å¥‘æ•°åˆ—æ¯ä¸€é¡¹ç­‰äºå‰ä¸¤é¡¹ä¹‹å’Œï¼Œæ­£å¥½ç¬¦åˆé€’å½’çš„æ€è·¯ï¼š</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
int fibo(int n)
{
    if (n &lt;= 2)
    {
        return 1;
    }
    else
    {
        return fibo(n - 1) + fibo(n - 2);
    }
}
int main()
{
    int n;
    printf(&quot;è¯·è¾“å…¥æ–æ³¢é‚£å¥‘æ•°åˆ—é•¿åº¦ï¼š&quot;);
    scanf(&quot;%d&quot;, &amp;n);
    for (int i = 1; i &lt;= n; ++i)
    {
        printf(&quot;%d&quot;, fibo(i));
        if (i &lt; n)
        {
            printf(&quot;, &quot;);
        }
    }
    return 0;
}
</code></pre>
<p>ç¨‹åºæ‰§è¡Œå¦‚ä¸‹ï¼š</p>
<pre><code>è¯·è¾“å…¥æ–æ³¢é‚£å¥‘æ•°åˆ—é•¿åº¦ï¼š10
1, 1, 2, 3, 5, 8, 13, 21, 34, 55
</code></pre>
<h2 id="é€’å½’æ±‚æ±‰è¯ºå¡”">é€’å½’æ±‚æ±‰è¯ºå¡”</h2>
<p>å…¶å®ï¼Œä¸è®ºæœ‰å¤šå°‘å±‚æ±‰è¯ºå¡”ï¼Œéƒ½å¯ä»¥ä½¿ç”¨é€’å½’ä¸€å±‚ä¸€å±‚å¾€ä¸‹è§£åŒ…ã€‚</p>
<pre><code class="language-c">//Example 08
#include &lt;stdio.h&gt;
void hanoi(int, char, char, char);
void hanoi(int n, char x, char y, char z)
{
    if (n == 1)
    {
        printf(&quot;%c --&gt; %c\n&quot;, x, z);//å‰©ä¸‹åº•éƒ¨çš„åœ†ç›˜
    }
    else
    {
        hanoi(n - 1, x, z, y);//å°†n-1ä¸ªåœ†ç›˜ä»xç§»åŠ¨åˆ°y
        printf(&quot;x --&gt; z\n&quot;);
        hanoi(n - 1, y, x, z);//å°†n-1ä¸ªåœ†ç›˜ä»yç§»åŠ¨åˆ°z
    }
}
int main(void)
{
    int n;
    printf(&quot;è¯·è¾“å…¥æ±‰è¯ºå¡”çš„å±‚æ•°ï¼š&quot;);
    scanf(&quot;%d&quot;, &amp;n);
    hanoi(n, 'X', 'Y', 'Z');
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 08
è¯·è¾“å…¥æ±‰è¯ºå¡”çš„å±‚æ•°ï¼š4
X --&gt; Y
x --&gt; z
Y --&gt; Z
x --&gt; z
Z --&gt; X
x --&gt; z
X --&gt; Y
x --&gt; z
Y --&gt; Z
x --&gt; z
Z --&gt; X
x --&gt; z
X --&gt; Y
x --&gt; z
Y --&gt; Z
</code></pre>
<h2 id="åˆ†æ²»æ³•">åˆ†æ²»æ³•</h2>
<p>æ‰€è°“åˆ†æ²»æ³•ï¼Œå°±æ˜¯å¤§äº‹åŒ–å°çš„æ€ç»´ã€‚é€’å½’å®é™…ä¸Šå°±æ˜¯ä¸€ç§åˆ†æ²»ã€‚å±‚å±‚é€’å½’ï¼Œç„¶åä»æœ€ç®€å•çš„é—®é¢˜å¼€å§‹è§£å†³ã€‚</p>
<p>è¯´åˆ°è¿™é‡Œï¼Œå°±ä¸å¾—ä¸æåˆ°ä¸€ç§æ’åºç®—æ³•ï¼Œå°±æ˜¯ååˆ†ç»å…¸çš„â€”â€”å¿«é€Ÿæ’åºã€‚</p>
<p>ä½œä¸º20ä¸–çºªåå¤§ç®—æ³•ä¹‹ä¸€ï¼Œå¿«é€Ÿæ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€šè¿‡ä¸€é¡¹å°†å¾…æ’åºæ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†å…ƒç´ å‡æ¯”å¦ä¸€éƒ¨åˆ†å°ï¼Œç„¶ååˆ†åˆ«å¯¹è¿™ä¸¤éƒ¨åˆ†ç»§ç»­æ’åºï¼Œé‡å¤æ­¥éª¤ç›´åˆ°å®Œæˆã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://www.cxyxiaowu.com/wp-content/uploads/2019/10/1571057581-e7b9d65b41e66df.gif" alt="å¿«é€Ÿæ’åºåŠ¨ç”»æ¼”ç¤º" loading="lazy"></figure>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-c">//Example 09
#include &lt;stdio.h&gt;
void qs(int, int, int);
void qs(int array[], int left, int right)
{
    int i = left, j = right;
    int temp;
    int pivot;
    
    //åŸºå‡†ç‚¹è®¾ç½®ä¸ºä¸­é—´å…ƒç´ ï¼Œå½“ç„¶åˆ«çš„ä¹Ÿå¯ä»¥
    pivot = array[(left + right) / 2];
    
    while (i &lt;= j)
    {
        //æ‰¾åˆ°å·¦è¾¹å¤§äºç­‰äºåŸºå‡†ç‚¹çš„å…ƒç´ 
        while (array[i] &lt; pivot)
        {
            ++i;
        }
        //æ‰¾åˆ°å³è¾¹å°äºç­‰äºåŸºå‡†ç‚¹çš„å…ƒç´ 
        while (array[j] &gt; pivot)
        {
            --j;
        }
        //å¦‚æœå·¦è¾¹ä¸‹æ ‡å°äºå³è¾¹ï¼Œåˆ™äº¤æ¢å…ƒç´ 
        if (i &lt;= j)
        {
            temp = array[i];
            array[i] = array[j];
            array[j] = temp;
            ++i;
            --j;
        }
    }
    
    //é€’å½’éå†å·¦å­
    if (left &lt; j)
    {
        qs(array, left, j);
    }
    //é€’å½’éå†å³å­
    if (i &lt; right)
    {
        qs(array, i, right);
    }
}

int main(void)
{
    int array[] = {135, 156, 120, 102, 130, 62, 410, 158, 173, 113, 124, 184, 131, 214};
    int length;
    length = sizeof(array) / sizeof(array[0]);
    qs(array, 0, length - 1);
    
    printf(&quot;æ’åºåç»“æœä¸ºï¼š&quot;);
    for (int i = 0; i &lt; length; i++)
    {
        printf(&quot;%d&quot;, array[i]);
        if (i &lt; length - 1)
        {
            printf(&quot;, &quot;);
        }
    }
    putchar('\n');
    return 0;
}
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 09
æ’åºåç»“æœä¸ºï¼š62, 102, 113, 120, 124, 130, 131, 135, 156, 158, 173, 184, 214, 410
</code></pre>
<p>å­¦äº†è¿™ä¹ˆå¤šï¼Œä¹Ÿè¯¥å¥½å¥½ä¼‘æ¯ä¸‹äº†ï¼ä¸‹æœŸå†è§ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Cè¯­è¨€ä¹‹å‡½æ•°ï¼ˆä¸Šï¼‰]]></title>
        <id>https://harriswilde.github.io/post/cYwGcFKPK/</id>
        <link href="https://harriswilde.github.io/post/cYwGcFKPK/">
        </link>
        <updated>2020-02-03T06:49:54.000Z</updated>
        <content type="html"><![CDATA[<p>åœ¨å­¦ä¹ äº†æŒ‡é’ˆä»¥åï¼Œæˆ‘ä»¬çš„Cè¯­è¨€å­¦ä¹ å°±ç®—çœŸæ­£å…¥é—¨äº†ã€‚é‚£ä¹ˆï¼Œéšç€æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ç¨‹åºè§„æ¨¡è¶Šæ¥è¶Šå¤§ï¼Œæˆ‘ä»¬å†™çš„ä»£ç ä¹Ÿè¶Šæ¥è¶Šç¹æ‚ï¼Œç»å¸¸ä¼šç¢°åˆ°å¤§è„‘ä¸å¤Ÿç”¨ï¼Œæˆ–è€…åå­—ä¸ä¼šèµ·äº†è¿™ç±»çœ‹ä¼¼å¾ˆæç¬‘çš„é—®é¢˜ã€‚å†è€…ï¼Œå°±æ˜¯å¾€å¾€è¦æ›´æ”¹ä»£ç çš„æ—¶å€™ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œç¨å¾®å‡ºå·®é”™ï¼Œå°±åªèƒ½æ¨å€’é‡æ¥ã€‚</p>
<p>é‚£ä¹ˆï¼Œåœ¨åšå¼€å‘ï¼Œå°¤å…¶æ˜¯å¤šäººåä½œçš„å¤§å‹å¼€å‘çš„æ—¶å€™ï¼Œç¨‹åºæ¨¡å—åŒ–æ˜¯ååˆ†é‡è¦çš„ï¼Œä½ åªéœ€è¦é¢„ç•™ä¸€äº›ä¾›ä»–äººä½¿ç”¨çš„å¿…é¡»çš„æ¥å£ï¼Œç„¶åæŠŠä½ å®šä¹‰çš„æ–¹æ³•å†™ä¸ªæ–‡æ¡£æ–¹ä¾¿ä»–äººå¼€å‘å°±è¡Œäº†ã€‚é‚£ä¹ˆè¿™ç§æ€ç»´ï¼Œå°±æ˜¯<strong>ç»“æ„åŒ–ç¼–ç¨‹</strong>ã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„<code>printf</code>å‡½æ•°ï¼Œå°±æ˜¯Cè¯­è¨€å¼€å‘è€…å†™å¥½åœ¨<code>stdio.h</code>é‡Œé¢çš„ã€‚æœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆç®€å•åœ°è¾“å‡ºæ–‡æœ¬ï¼Œè€Œä¸éœ€è¦å»å…³æ³¨åº•å±‚åˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„ã€‚ä½ ä¼šå‘ç°ï¼Œæœ‰å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ›´å¤šçš„æ³¨æ„åŠ›æ”¾åœ¨é€»è¾‘çš„å®ç°ä¸Šï¼Œè€Œä¸éœ€è¦å»å…³æ³¨å¤ªå¤šçš„ç»†ææœ«èŠ‚ã€‚</p>
<h1 id="å‡½æ•°çš„å®šä¹‰å’Œå£°æ˜">å‡½æ•°çš„å®šä¹‰å’Œå£°æ˜</h1>
<h2 id="ç»ªè®º">ç»ªè®º</h2>
<p>è™½ç„¶Cè¯­è¨€çš„å†…ç½®å‡½æ•°å·²ç»ååˆ†ä¸°å¯Œï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°å¤§éƒ¨åˆ†çš„é—®é¢˜ã€‚ä»€ä¹ˆå­—ç¬¦ä¸²çš„å¤„ç†å•Šï¼Œæ•°å­¦æ–¹é¢çš„è®¡ç®—å•Šï¼Œç­‰ç­‰â€¦â€¦ä½†æ˜¯ï¼Œä½œä¸ºä¸€é—¨é«˜çº§è¯­è¨€ï¼ŒCè¯­è¨€è¿˜å¯ä»¥è®©æˆ‘ä»¬è‡ªå·±æ¥å®šä¹‰å‡½æ•°ï¼ŒæŠŠæˆ‘ä»¬çš„ä¸€äº›æ–¹æ³•æŠ½è±¡å°è£…å‡ºæ¥ï¼Œç”¨äºå…¶ä»–çš„å¯¹è±¡ä¸Šã€‚</p>
<p>æˆ‘ä»¬ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå°è£…ä¸€ä¸ªè¾“å‡ºå­—ç¬¦å›¾çš„å‡½æ•°ï¼š</p>
<pre><code class="language-c">//Example 01
#include &lt;stdio.h&gt;
//------å®šä¹‰å¼€å§‹------//
void print_house(void)
{
    printf(&quot;Â¤â•­âŒ’â•®â€‚â•­âŒ’â•®:âˆ´â˜…âˆµ**â˜†ï¼\n&quot;);
    printf(&quot;â•±â—¥â–ˆâ–ˆâ—£â€‚:âˆ´â˜†âˆµ**â˜…ï¼\n&quot;);
    printf(&quot;|ç”°ï¸±ç”°ç”°|:âˆ´â˜…âˆµ**â˜†ï¼\n&quot;);
    printf(&quot;â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â€‚\n&quot;);
}
//------å®šä¹‰ç»“æŸ------//
int main(void)
{
    print_house();//è°ƒç”¨å‡½æ•°
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 01
Â¤â•­âŒ’â•®â€‚â•­âŒ’â•®:âˆ´â˜…âˆµ**â˜†ï¼
â•±â—¥â–ˆâ–ˆâ—£â€‚:âˆ´â˜†âˆµ**â˜…ï¼
|ç”°ï¸±ç”°ç”°|:âˆ´â˜…âˆµ**â˜†ï¼
â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â€‚
</code></pre>
<h2 id="å‡½æ•°çš„å®šä¹‰">å‡½æ•°çš„å®šä¹‰</h2>
<p>å®šä¹‰å‡½æ•°çš„æ–¹æ³•ï¼Œå’Œæˆ‘ä»¬ä½¿ç”¨<code>main</code>å‡½æ•°çš„æ–¹æ³•å·®ä¸å¤šï¼š</p>
<pre><code class="language-c">ç±»å‹å å‡½æ•°å(å‚æ•°åˆ—è¡¨)
{
    å‡½æ•°ä½“
}
</code></pre>
<ul>
<li>ç±»å‹åå°±æ˜¯å‡½æ•°è¿”å›å€¼çš„ç±»å‹ï¼Œå¦‚æœä¸å¸Œæœ›å‡½æ•°è¿”å›ä»»ä½•ç±»å‹ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨<code>void</code>ï¼ˆæ— ç±»å‹ï¼Œè¡¨ç¤ºæ²¡æœ‰è¿”å›å€¼ï¼‰ã€‚</li>
<li><strong>å‡½æ•°å</strong>å°±æ˜¯å‡½æ•°çš„åå­—ï¼Œè‡ªå·±æƒ³æ€ä¹ˆå‘½åéƒ½å¯ä»¥ï¼Œä½†æ˜¯ä¸è¦å’Œä¿ç•™å­—é‡å¤ã€‚</li>
<li><strong>å‚æ•°åˆ—è¡¨</strong>æŒ‡å®šäº†å‚æ•°çš„<strong>ç±»å‹</strong>å’Œ<strong>åå­—</strong>ï¼Œå¦‚æœä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œåˆ™å†™ä¸Š<code>void</code>å³å¯ã€‚</li>
<li><strong>å‡½æ•°ä½“</strong>æ˜¯æŒ‡å‡½æ•°çš„å…·ä½“ç®—æ³•ï¼Œæ˜¯å‡½æ•°ä¸­å…³é”®éƒ¨åˆ†</li>
</ul>
<h2 id="å‡½æ•°çš„å£°æ˜">å‡½æ•°çš„å£°æ˜</h2>
<p>æ‰€è°“çš„å£°æ˜ï¼Œå°±æ˜¯å°†å‡½æ•°å…ˆå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œä½†æ˜¯å…·ä½“ç®—æ³•ï¼Œåˆ™åœ¨<code>main</code>å‡½æ•°ä¹‹åå¼€å‘ã€‚</p>
<p>å¦‚æœä¸åšå£°æ˜ï¼ŒæŠŠä¸Šé¢çš„ç¨‹åºæ”¹æˆè¿™æ ·åˆ™ä¼šå‡ºé”™ï¼š</p>
<pre><code class="language-c">//Example 01
#include &lt;stdio.h&gt;
int main(void)
{
    print_house();//è°ƒç”¨å‡½æ•°
    return 0;
}
//------å®šä¹‰å¼€å§‹------//
void print_house(void)
{
    printf(&quot;Â¤â•­âŒ’â•®â€‚â•­âŒ’â•®:âˆ´â˜…âˆµ**â˜†ï¼\n&quot;);
    printf(&quot;â•±â—¥â–ˆâ–ˆâ—£â€‚:âˆ´â˜†âˆµ**â˜…ï¼\n&quot;);
    printf(&quot;|ç”°ï¸±ç”°ç”°|:âˆ´â˜…âˆµ**â˜†ï¼\n&quot;);
    printf(&quot;â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â€‚\n&quot;);
}
//------å®šä¹‰ç»“æŸ------//
</code></pre>
<p>å› ä¸ºé“ç†ä¸Šï¼Œç¨‹åºæ˜¯<strong>ä»ä¸Šå¾€ä¸‹</strong>ç¼–è¯‘çš„ï¼Œå¦‚æœä¸æå‰å‘ŠçŸ¥ï¼Œé‚£ä¹ˆ<code>main</code>å‡½æ•°é‡Œé¢çš„<code>print_house</code>ï¼Œç¼–è¯‘å™¨ä¾¿ä¸çŸ¥é“è¿™æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ã€‚</p>
<p>å¦‚æœä½ åšäº†å‡½æ•°çš„å£°æ˜ï¼Œé‚£ä¹ˆè¿™ä¸ªç¨‹åºå°±å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼š</p>
<pre><code class="language-c">//Example 01
#include &lt;stdio.h&gt;
void print_house(void);//å£°æ˜å‡½æ•°
int main(void)
{
    print_house();//è°ƒç”¨å‡½æ•°
    return 0;
}
//------å®šä¹‰å¼€å§‹------//
void print_house(void)
{
    printf(&quot;Â¤â•­âŒ’â•®â€‚â•­âŒ’â•®:âˆ´â˜…âˆµ**â˜†ï¼\n&quot;);
    printf(&quot;â•±â—¥â–ˆâ–ˆâ—£â€‚:âˆ´â˜†âˆµ**â˜…ï¼\n&quot;);
    printf(&quot;|ç”°ï¸±ç”°ç”°|:âˆ´â˜…âˆµ**â˜†ï¼\n&quot;);
    printf(&quot;â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â•¬â€‚\n&quot;);
}
//------å®šä¹‰ç»“æŸ------//
</code></pre>
<p>åŸåˆ™ä¸Šæ¥è¯´ï¼Œå‡½æ•°å¿…é¡»å…ˆå®šä¹‰ï¼Œå†ä½¿ç”¨ã€‚å†µä¸”åœ¨ä»¥åçš„å¼€å‘å°¤å…¶æ˜¯å›¢é˜Ÿåä½œçš„æƒ…å†µä¸‹ï¼Œå…ˆä½¿ç”¨å‡½æ•°ï¼Œåå¼€å‘å‡½æ•°çš„æƒ…å†µæ¯”è¾ƒå¤šï¼Œå› æ­¤å…»æˆ<strong>å…ˆå®šä¹‰ï¼Œåä½¿ç”¨</strong>çš„è‰¯å¥½ä¹ æƒ¯æ˜¯æœ€å¥½çš„ã€‚</p>
<h1 id="å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼">å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼</h1>
<p>å‘å‡½æ•°ä¼ å…¥å‚æ•°ï¼Œå¯ä»¥ä½¿å‡½æ•°çš„åŠŸèƒ½æ›´åŠ ä¸°å¯Œã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åˆšåˆšå®šä¹‰äº†ä¸€ä¸ªè¾“å‡ºå­—ç¬¦ç”»çš„å‡½æ•°ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°æ— è®ºåœ¨ä»€ä¹ˆæ—¶å€™ï¼Œå®ƒæ‰§è¡Œå‡ºæ¥çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚æ— æ³•å®ç°æ›´åŠ ä¸ªæ€§åŒ–çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="language-c">//Example 02
#include &lt;stdio.h&gt;
void print(int);

int main(void)
{
	int a;
	scanf(&quot;%d&quot;, &amp;a);
	print(a);
	return 0;
}

void print(int a)
{
	for (int i = a; i &gt; 0; i--)
	{
		printf(&quot;-&quot;);
	}
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 02 - 01
5
-----
</code></pre>
<pre><code>//Consequence 02 - 02
7
-------
</code></pre>
<p>ä½ çœ‹ï¼Œè¾“å‡ºçš„å†…å®¹ä¼šéšç€ç”¨æˆ·è¾“å…¥çš„æ•°å­—è€Œæ”¹å˜ï¼Œå°±åƒ<strong>å®šåˆ¶</strong>ä¸€æ ·ã€‚</p>
<p>é‚£ä¹ˆå‡½æ•°çš„<strong>è¿”å›å€¼</strong>åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬åˆšåˆšå†™çš„å‡½æ•°ï¼Œéƒ½æ²¡æœ‰è¿”å›å€¼ï¼Œå› ä¸ºåœ¨å‡½æ•°ä½“çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¦å¾—åˆ°çš„ç»“æœå·²ç»æ‰§è¡Œå®Œæ¯•äº†ï¼Œå¹¶ä¸éœ€è¦è¿”å›ä»€ä¹ˆä¸œè¥¿ã€‚ä½†æ˜¯ï¼Œæœ‰äº›å‡½æ•°å°±ä¸ä¸€æ ·äº†ã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬ç°åœ¨è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œèƒ½å¤Ÿå®ç°é˜¶ä¹˜ï¼Œè¿™æ—¶å€™ï¼Œå°±éœ€è¦è¿”å›å€¼äº†ã€‚</p>
<pre><code class="language-c">//Example 03 - è¿­ä»£æ³•
#include &lt;stdio.h&gt;
int factorial(int);

int main(void)
{
    int a;
    scanf(&quot;%d&quot;,&amp;a);
    printf(&quot;%d&quot;, factorial(a));
    return 0;
}

int factorial(int a)
{
    int sum = 1;
    for (int i = a; i &gt; 0; i--)
    {
        sum *= i;
    }
    return sum;
}
</code></pre>
<pre><code class="language-c">//Example 03 - é€’å½’æ³•
#include &lt;stdio.h&gt;
int factorial(int);

int main(void)
{
    int a;
    scanf(&quot;%d&quot;, &amp;a);
    printf(&quot;%d&quot;, factorial(a));
    return 0;
}

int factorial(int a)
{
    int sum;
    if (a == 1)
    {
        return 1;
    }
    else
    {
        return a * factorial(a - 1);
    }
}
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 03
5
120
</code></pre>
<h2 id="å½¢å‚å’Œå®å‚">å½¢å‚å’Œå®å‚</h2>
<p>æ‰€è°“<strong>å½¢å‚</strong>ï¼Œå°±æ˜¯å½¢å¼å‚æ•°ï¼Œå¦‚ï¼š</p>
<pre><code class="language-c">...
int f(int a, int b);
...
</code></pre>
<p>è¿™å…¶ä¸­çš„<code>a</code>å’Œ<code>b</code>å°±æ˜¯å½¢å¼å‚æ•°ï¼Œæ­¤æ—¶åªæ˜¯ä½œå ä½ç¬¦è€Œå·²ï¼Œè€Œåœ¨å‡½æ•°çœŸæ­£ä½¿ç”¨çš„æ—¶å€™ï¼š</p>
<pre><code class="language-c">...
int main(void)
{
    f(x, y);
    ...
}
...
</code></pre>
<p>æ­¤æ—¶çš„<code>x</code>å’Œ<code>y</code>å°±æ˜¯<strong>å®å‚</strong>ã€‚å› ä¸ºæ­¤æ—¶ä¼ é€’è¿›å»çš„å€¼æ˜¯çœŸæ­£ç¨‹åºé‡Œé¢æ‹¥æœ‰çš„å€¼ï¼Œæ˜¯å®å®åœ¨åœ¨çš„ã€‚</p>
<p>å…¶å®å½¢å‚å’Œå®å‚çš„ä½œç”¨å°±æ˜¯ç”¨æ¥ä¼ é€’æ•°æ®çš„ï¼Œå½“æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå®å‚ä¼šå°†å€¼ä¼ é€’ç»™å½¢å‚ï¼ˆå•å‘ä¼ é€’ï¼‰ã€‚å½¢å‚å˜é‡åªæœ‰åœ¨å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™æ‰ä¼šåˆ†é…å†…å­˜ï¼Œè°ƒç”¨ç»“æŸåï¼Œç«‹å³é‡Šæ”¾å†…å­˜ï¼Œå› æ­¤å½¢å‚å˜é‡åªæœ‰åœ¨å‡½æ•°å†…éƒ¨æœ‰æ•ˆï¼Œ<strong>å¯¹å‡½æ•°å¤–çš„å˜é‡ä¸å½±å“</strong>ã€‚</p>
<h2 id="ä¼ å€¼å’Œä¼ å€">ä¼ å€¼å’Œä¼ å€</h2>
<pre><code class="language-c">//Example 04 - 01
#include &lt;stdio.h&gt;
void swap(int, int);
void swap(int a, int b)
{
    int temp;
    printf(&quot;swapä¸­ï¼Œäº¤æ¢å‰ï¼ša = %d, b = %d\n&quot;, a, b);
    temp = a;
    a = b;
    b = temp;
    printf(&quot;swapä¸­ï¼Œäº¤æ¢å‰ï¼ša = %d, b = %d\n&quot;, a, b);
}

int main(void)
{
    int a = 1, b = 2;
    printf(&quot;mainä¸­ï¼Œäº¤æ¢å‰ï¼ša = %d, b = %d\n&quot;, a, b);
    swap(a, b);
    printf(&quot;mainä¸­ï¼Œäº¤æ¢å‰ï¼ša = %d, b = %d\n&quot;, a, b);
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 04 - 01
mainä¸­ï¼Œäº¤æ¢å‰ï¼ša = 1, b = 2
swapä¸­ï¼Œäº¤æ¢å‰ï¼ša = 1, b = 2
swapä¸­ï¼Œäº¤æ¢å‰ï¼ša = 2, b = 1
mainä¸­ï¼Œäº¤æ¢å‰ï¼ša = 1, b = 2
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨<code>swap</code>å‡½æ•°å†…ï¼Œä¼ å…¥çš„å€¼è¢«äº’æ¢ï¼Œä½†æ˜¯åœ¨ä¸»å‡½æ•°å†…ï¼Œå€¼ä¾æ—§æ²¡æœ‰è¢«æ”¹å˜ã€‚å› æ­¤å¯ä»¥å¾—å‡ºç»“è®ºï¼š<strong>å‡½æ•°å†…éƒ¨æ— æ³•æ”¹å˜å®å‚çš„å€¼</strong></p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ¢æˆæŒ‡é’ˆä¼šæ€æ ·å‘¢ï¼Ÿ</p>
<pre><code class="language-c">//Example 04 - 02
#include &lt;stdio.h&gt;
void swap(int*, int*);
void swap(int* a, int* b)
{
    int temp;
    printf(&quot;swapä¸­ï¼Œäº¤æ¢å‰ï¼ša = %d, b = %d\n&quot;, *a, *b);
    temp = *a;
    *a = *b;
    *b = temp;
    printf(&quot;swapä¸­ï¼Œäº¤æ¢å‰ï¼ša = %d, b = %d\n&quot;, *a, *b);
}

int main(void)
{
    int a = 1, b = 2;
    printf(&quot;mainä¸­ï¼Œäº¤æ¢å‰ï¼ša = %d, b = %d\n&quot;, a, b);
    swap(&amp;a, &amp;b);
    printf(&quot;mainä¸­ï¼Œäº¤æ¢å‰ï¼ša = %d, b = %d\n&quot;, a, b);
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœä¸ºï¼š</p>
<pre><code class="language-c">//Consequence 04 - 02
mainä¸­ï¼Œäº¤æ¢å‰ï¼ša = 1, b = 2
swapä¸­ï¼Œäº¤æ¢å‰ï¼ša = 1, b = 2
swapä¸­ï¼Œäº¤æ¢å‰ï¼ša = 2, b = 1
mainä¸­ï¼Œäº¤æ¢å‰ï¼ša = 2, b = 1
</code></pre>
<p>æ¬¸ï¼Ÿæ€ä¹ˆè¿™ä¼šå„¿å°±èƒ½å˜äº†å‘¢ï¼Ÿæœ‰äººå¯èƒ½ä¼šè¯´ï¼ŒHarrisä½ æ˜¯ä¸æ˜¯åˆšåˆšéª—æˆ‘ï¼Ÿ</p>
<p>å…¶å®å¹¶ä¸æ˜¯ï¼Œæˆ‘ä»¬çœ‹è¿™å¥ï¼š<code>swap(&amp;a, &amp;b);</code>ï¼Œæˆ‘ä»¬å…¶å®ä¼ å…¥çš„å®å‚æ˜¯ä¸¤ä¸ªå˜é‡çš„åœ°å€ã€‚</p>
<p>æ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœå˜é‡<code>a</code>çš„åœ¨å†…å­˜é‡Œé¢ä½çš„æ˜¯1å·æˆ¿é—´ï¼Œå˜é‡<code>b</code>åœ¨å†…å­˜ä¸­ä½çš„æ˜¯2å·æˆ¿é—´ã€‚é‚£ä¹ˆå‡½æ•°å¤„ç†äº†ä¹‹åï¼Œä»–ä¿©ä½çš„åœ°æ–¹å¹¶æ²¡æœ‰æ”¹å˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ªå˜é‡çš„å†…å­˜åœ°å€å¹¶æ²¡æœ‰æ”¹å˜ï¼Œåªæ˜¯å‡½æ•°æŠŠè¿™ä¸ªåœ°å€å¯¹åº”çš„å€¼æ”¹å˜äº†è€Œå·²ã€‚å‡½æ•°å†…å¯¹æŒ‡é’ˆè¿›è¡Œè§£å¼•ç”¨ï¼Œå®é™…ä¸Šå°±æ˜¯é—´æ¥åœ°è®¿é—®äº†å˜é‡çš„å€¼ã€‚</p>
<h2 id="ä¼ æ•°ç»„">ä¼ æ•°ç»„</h2>
<p>æ—¢ç„¶æ˜¯å¯ä»¥ä¼ é€’æŒ‡é’ˆï¼Œé‚£ä¹ˆæ•°ç»„æŒ‰ç†æ¥è¯´ï¼Œåº”è¯¥ä¹Ÿæ˜¯å¯ä»¥ä¼ çš„ã€‚</p>
<pre><code class="language-c">//Example 05
#include &lt;stdio.h&gt;
void get_array(int);
void get_array(int a[10])
{
	for (int i = 0; i &lt; 10; i++)
	{
		printf(&quot;a[%d] = %d\n&quot;, i, a[i]);
	}
}

int main(void)
{
	int a[10] = { 1,2,3,4,5,6,7,8,9,10 };
	get_array(a);
	return 0;
}
</code></pre>
<pre><code class="language-c">//Consequence 05
a[0] = 1
a[1] = 2
a[2] = 3
a[3] = 4
a[4] = 5
a[5] = 6
a[6] = 7
a[7] = 8
a[8] = 9
a[9] = 10
</code></pre>
<p>å¦‚æœæˆ‘ä»¬å°è¯•ç€åœ¨å‡½æ•°å†…æ”¹å˜æ•°ç»„çš„å€¼å‘¢ï¼Ÿ</p>
<pre><code class="language-c">//Example 06
#include &lt;stdio.h&gt;
void get_array(int);
void get_array(int a[10])
{
	a[4] = 1;//æ›´æ”¹ä¸€ä¸ªå€¼
	for (int i = 0; i &lt; 10; i++)
	{
		printf(&quot;a[%d] = %d\n&quot;, i, a[i]);
	}
}

int main(void)
{
	int a[10] = { 1,2,3,4,5,6,7,8,9,10 };
	get_array(a);
	return 0;
}
</code></pre>
<pre><code>//Consequence 06
a[0] = 1
a[1] = 2
a[2] = 3
a[3] = 4
a[4] = 1
a[5] = 6
a[6] = 7
a[7] = 8
a[8] = 9
a[9] = 10
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸»å‡½æ•°é‡Œé¢è¾“å‡ºæ•°ç»„ï¼Œä¹Ÿæ˜¯è¢«æ”¹å˜äº†çš„ã€‚äºæ˜¯å¯ä»¥æ–­å®šï¼Œå…¶å®ä¼ å…¥çš„å¹¶ä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯è¿™ä¸ªæ•°ç»„çš„<strong>é¦–åœ°å€</strong>è€Œå·²ã€‚</p>
<h2 id="å¯å˜å‚æ•°">å¯å˜å‚æ•°</h2>
<p>å¯èƒ½æœ‰çš„åŒå­¦ä¼šçº³é—·ï¼Œæˆ‘ä»¬å®šä¹‰çš„å‡½æ•°ï¼Œéƒ½æ˜¯ç»™å‚æ•°é¢„ç•™äº†ä½ç½®çš„ï¼Œé‚£å¦‚æœåƒ<code>printf()</code>è¿™ç§å‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯å–å†³äºå ä½ç¬¦çš„æ•°é‡ï¼Œè¿™ç§å‡½æ•°æ˜¯æ€ä¹ˆå®šä¹‰çš„å‘¢ï¼Ÿ</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬å°±è¦å°†ä¸€ä¸ªä»¥å‰æ²¡æœ‰ç”¨è¿‡çš„å¤´æ–‡ä»¶<code>&lt;stdarg.h&gt;</code>ã€‚è¿™ä¸ªå¤´æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªç±»å‹å’Œä¸‰ä¸ªå®æ˜¯éœ€è¦ç”¨åˆ°çš„ï¼š</p>
<p>ä¸€ä¸ªç±»å‹æ˜¯<code>va_list</code>ï¼Œä¸‰ä¸ªå®æ˜¯<code>va_start</code> <code>va_arg</code> <code>va_end</code>ï¼Œå…¶ä¸­ï¼Œ<code>va</code>å°±æ˜¯æŒ‡<strong>variable-argumentï¼ˆå¯å˜å‚æ•°ï¼‰</strong>ã€‚</p>
<pre><code class="language-c">//Example 07
#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
int sum(int n, ...);
int sum(int n, ...)//ç¬¬ä¸€ä¸ªå‚æ•°nä»£è¡¨åé¢å¯å˜å‚æ•°çš„æ•°é‡ï¼Œä¸‰ä¸ªç‚¹ä»£è¡¨ä¸ç¡®å®šå‚æ•°ä¸ªæ•°
{
	int sum = 0;
	va_list arg;//å®šä¹‰å‚æ•°åˆ—è¡¨
	va_start(arg, n);//åˆå§‹åŒ–å‚æ•°åˆ—è¡¨ï¼Œnä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„åç§°
	for (int i = 0; i &lt; n; i++)
	{
		sum += va_arg(arg, int);//ä¾æ¬¡è·å–å‚æ•°å€¼
	}
	va_end(arg);//ç»“æŸå‚æ•°åˆ—è¡¨
	return sum;
}

int main(void)
{
	int result;
	result = sum(5, 1, 2, 3, 4, 5);
	printf(&quot;result = %d\n&quot;, result);
	return 0;
}
</code></pre>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 07
result = 15
</code></pre>
<h1 id="æŒ‡é’ˆå‡½æ•°å’Œå‡½æ•°æŒ‡é’ˆ">æŒ‡é’ˆå‡½æ•°å’Œå‡½æ•°æŒ‡é’ˆ</h1>
<h2 id="æŒ‡é’ˆå‡½æ•°">æŒ‡é’ˆå‡½æ•°</h2>
<p>å‡½æ•°çš„ç±»å‹ï¼Œå®é™…ä¸Šå°±æ˜¯å‡½æ•°è¿”å›å€¼çš„ç±»å‹ï¼Œé‚£ä¹ˆé¡¾åæ€ä¹‰ï¼ŒæŒ‡é’ˆå‡½æ•°å°±æ˜¯è¿”å›æŒ‡é’ˆçš„å‡½æ•°ã€‚</p>
<pre><code class="language-c">//Example 08
#include &lt;stdio.h&gt;
char* getWord(char);
char* getWord(char c)
{
    switch (c)
    {
    case 'A':return &quot;Apple&quot;;
    case 'B':return &quot;Boy&quot;;
    case 'C':return &quot;Cat&quot;;
    case 'D':return &quot;Dog&quot;;
    default:return &quot;None&quot;;
    }
}
int main(void)
{
    char input;
    scanf(&quot;%c&quot;, &amp;input);
    printf(&quot;%s&quot;, getWord(input));
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code>//Consequence 08
A
Apple
</code></pre>
<p>æœ‰çš„å°ä¼™ä¼´å¯èƒ½ä¼šè¯´ï¼Œä¸ºå•¥è¿™ä¸ª<code>switch</code>è¯­å¥ä¸­ä¸ç”¨åŠ <code>break</code>å‘¢ï¼Ÿ</p>
<p>å› ä¸º<code>return</code>å®é™…ä¸Šå°±ä»£è¡¨å‡½æ•°æ‰§è¡Œçš„ç»“æŸï¼Œå› æ­¤ä¸ä¼šæ‰§è¡Œåˆ°ä¸‹é¢çš„<code>case</code>ã€‚</p>
<p>è¿™ä¸ªä¾‹å­å°±æ˜¯è®©å‡½æ•°è¿”å›å­—ç¬¦ä¸²(æŒ‡é’ˆ)ã€‚</p>
<p>å¦å¤–ï¼Œä¸è¦å°†å‡½æ•°ä¸­å±€éƒ¨å˜é‡çš„å€¼ä½œä¸ºè¿”å›å€¼ï¼Œå› ä¸ºå±€éƒ¨å˜é‡çš„å€¼çš„ä½œç”¨åŸŸï¼ˆæœ‰æ•ˆèŒƒå›´ï¼‰åªæœ‰<strong>å‡½æ•°å†…éƒ¨</strong>ï¼Œå› æ­¤è¿”å›å±€éƒ¨å˜é‡æ˜¯ä¸åˆæ³•çš„ï¼ˆè¯¦ç»†å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è®²åˆ°ï¼‰ã€‚</p>
<h2 id="å‡½æ•°æŒ‡é’ˆ">å‡½æ•°æŒ‡é’ˆ</h2>
<pre><code class="language-c">æŒ‡é’ˆå‡½æ•° -&gt; int* f();
å‡½æ•°æŒ‡é’ˆ -&gt; int (*p)();
</code></pre>
<p>æœ¬è´¨ä¸Šï¼Œå‡½æ•°è¡¨ç¤ºæ³•å°±æ˜¯æŒ‡é’ˆè¡¨ç¤ºæ³•ã€‚å› ä¸ºå‡½æ•°çš„åå­—ç»è¿‡å–å€¼ä¼šå˜æˆå‡½æ•°çš„åœ°å€ï¼Œæ‰€ä»¥åœ¨å®šä¹‰äº†å‡½æ•°æŒ‡é’ˆä»¥åï¼Œç»™å®ƒä¼ é€’ä¸€ä¸ªå·²ç»è¢«å®šä¹‰çš„å‡½æ•°åï¼Œå³å¯é€šè¿‡è¯¥æŒ‡é’ˆè¿›è¡Œè°ƒç”¨ã€‚</p>
<pre><code class="language-c">//Example 09
#include &lt;stdio.h&gt;
int square(int);
int square(int a)
{
    return a * a;
}
int main(void)
{
    int num;
    int (*fp)(int);
    scanf(&quot;%d&quot;, &amp;num);
    fp = square;
    printf(&quot;%d * %d = %d\n&quot;, num, num, (*fp)(num));
    return 0;
}
</code></pre>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 10
5
5 * 5 = 25
</code></pre>
<p>è¿™é‡Œ<code>fp = square</code>å¯ä»¥å†™æˆ<code>fp = &amp;square</code>ï¼Œ<code>(*fp)(num)</code>å¯ä»¥å†™æˆ<code>fp(num)</code>ï¼Œå¯èƒ½æ›´åŠ ç¬¦åˆæˆ‘ä»¬ä¹‹å‰çš„ä¹ æƒ¯ã€‚</p>
<h2 id="å‡½æ•°æŒ‡é’ˆä½œä¸ºå‚æ•°">å‡½æ•°æŒ‡é’ˆä½œä¸ºå‚æ•°</h2>
<p>å‡½æ•°æŒ‡é’ˆä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œè¿™æ ·å‡½æ•°å°±å¯ä»¥å®ç°æ›´åŠ ä¸°å¯Œçš„åŠŸèƒ½ã€‚</p>
<pre><code class="language-c">//Example 11
#include &lt;stdio.h&gt;

int add(int, int);
int sub(int, int);
int calc(int (*fp)(int, int), int, int);

int add(int a, int b)
{
    return a + b;
}
int sub(int a, int b)
{
    return a - b;
}
int calc(int (*fp)(int, int), int a, int b)
{
    return (*fp)(a, b);
}

int main(void)
{
    printf(&quot;1 + 2 = %d\n&quot;, calc(add, 1, 2));
    printf(&quot;1 - 2 = %d\n&quot;, calc(sub, 1, 2));
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœä¸ºï¼š</p>
<pre><code>//Consequence 11
1 + 2 = 3
1 - 2 = -1
</code></pre>
<h2 id="å‡½æ•°æŒ‡é’ˆä½œä¸ºè¿”å›å€¼">å‡½æ•°æŒ‡é’ˆä½œä¸ºè¿”å›å€¼</h2>
<p>å‡è®¾ç°åœ¨æœ‰ä¸ªé—®é¢˜ï¼Œè®©ç”¨æˆ·è¾“å…¥ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œç„¶åæ ¹æ®ç”¨æˆ·è¾“å…¥çš„è¿ç®—ç¬¦æ¥ç¡®å®šåº”è¯¥è°ƒç”¨å“ªä¸€ä¸ªå‡½æ•°è¿›è¡Œè¿ç®—ã€‚</p>
<pre><code class="language-c">//Example 12
#include &lt;stdio.h&gt;

int add(int, int);
int sub(int, int);
int calc(int (*fp)(int, int), int, int);
int (*select(char op))(int, int);

int add(int a, int b)
{
    return a+b;
}
int sub(int a, int b)
{
    return a-b;
}
int calc(int (*fp)(int, int), int a, int b)
{
    return (*fp)(a, b);
}
int (*select(char op))(int, int)
{
    switch(op)
    {
        case '+':return add;
        case '-':return sub;
    }
}
int main(void)
{
    int a, b;
    char op;
    int (*fp)(int, int);
    printf(&quot;è¯·è¾“å…¥ä¸€ä¸ªå¼å­ï¼Œå¦‚1+2ï¼š&quot;);
    scanf(&quot;%d%c%d&quot;, &amp;a, &amp;op, &amp;b);
    fp =  select(op);
    printf(&quot;%d %c %d = %d\n&quot;, a, op, b, calc(fp, a, b));
    return 0;
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>//Consequence 12
è¯·è¾“å…¥ä¸€ä¸ªå¼å­ï¼Œå¦‚1+2ï¼š3+4
3 + 4 = 7
</code></pre>
<p>å‡½æ•°çš„çŸ¥è¯†å¤ªå¤šå¤ªç¹æ‚ï¼Œæ‰€ä»¥Harrisè¿™æ¬¡é‡‡ç”¨åˆ†èŠ‚å¼æ¥å†™åšå®¢ã€‚æœ¬æœŸçš„å°±åˆ°è¿™é‡Œå•¦ï¼å¦‚æœæ²¡æœ‰ç†è§£çš„ï¼Œå¥½å¥½å»æ¶ˆåŒ–ä¸‹ï¼Œç†è§£äº†çš„å°±ç­‰æˆ‘ä¸‹ä¸€ç¯‡å§ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æµ…è°ˆæ‹¼æ‰‹æ°”çº¢åŒ…çš„ç®—æ³•]]></title>
        <id>https://harriswilde.github.io/post/BGqcimUfF/</id>
        <link href="https://harriswilde.github.io/post/BGqcimUfF/">
        </link>
        <updated>2020-01-27T08:22:30.000Z</updated>
        <content type="html"><![CDATA[<hr>
<p>é¦–å…ˆï¼Œåœ¨è¿™é‡Œç¥å„ä½å°ä¼™ä¼´ä»¬é¼ å¹´å¤§å‰ï¼ï¼</p>
<p>ä»Šå¤©æ˜¯å¤§å¹´åˆä¸‰ï¼ŒHarrisåœ¨è¿™é‡Œç”¨ä¸€ä¸ªç®€å•çš„è¯é¢˜ï¼Œå¼€å¯é¼ å¹´çš„åšå®¢ä¹‹æ—…ã€‚</p>
<p>å¤§å®¶æ¯é€¢ä½³èŠ‚ï¼Œæœ€å°‘ä¸äº†çš„æ´»åŠ¨ï¼Œå°±æ˜¯â€œæŠ¢çº¢åŒ…â€ã€‚è‡ªæ‰“å¾®ä¿¡æ¨å‡ºäº†ç”µå­çº¢åŒ…ä¹‹åï¼Œä¸­å›½äººçš„èŠ‚æ—¥ï¼Œåˆå¤šäº†ä¸€ç§åº†ç¥æ–¹å¼ï¼Œé‚£å°±æ˜¯<strong>çº¢åŒ…é›¨</strong>ã€‚è¿™ç§å°†ä¼ ç»Ÿæ´»åŠ¨ç”¨ç§‘æŠ€çš„æ–¹å¼å°è£…çš„åšæ³•ï¼Œæ˜¯Harrisæ¯”è¾ƒèµæˆçš„ã€‚æŠŠä¼ ç»Ÿæº¶äºæ–°æ—¶ä»£ï¼Œä¸ºæˆ‘ä»¬çš„ä¼ ç»Ÿæ˜¥èŠ‚å¸¦æ¥äº†æ–°é²œçš„ç©ºæ°”ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨ç¾¤é‡Œå‘çº¢åŒ…çš„æ—¶å€™ï¼Œå¯èƒ½æœ‰çš„å°ä¼™ä¼´ä¼šçº³é—·å„¿ï¼Œè¿™ä¸ªæ‰€è°“çš„éšæœºé‡‘é¢ï¼Œåˆ°åº•æ˜¯æ€ä¹ˆç®—çš„å‘¢ï¼Ÿå®ƒåˆ°åº•æ˜¯ä¸æ˜¯å…¬å¹³çš„å‘¢ï¼Ÿ</p>
<p>æœ‰çš„å°ä¼™ä¼´å’Œæˆ‘è¯´ï¼Œè¿™è¿˜ä¸ç®€å•ä¹ˆï¼Œæ¯ä¸€ä¸ªäººæ‰“å¼€çº¢åŒ…çš„æ—¶å€™ï¼Œéƒ½æŒ‰ç…§å½“å‰å‰©ä½™çš„ä½™é¢ä¸ºèŒƒå›´ï¼Œéšæœºç”Ÿæˆä¸€ä¸ªæ•°å­—å°±å¥½äº†ã€‚</p>
<p>ä½†æ˜¯å‘¢ï¼Œè¿™æ ·çš„è¯ï¼Œéšç€çº¢åŒ…è¢«æ‰“å¼€çš„è¶Šæ¥è¶Šå¤šï¼Œé‡‘é¢çš„æ€»æ•°ä¹Ÿä¼šè¶Šæ¥è¶Šå°‘ã€‚é‚£ä¹ˆï¼Œå¯ä»¥æŠ¢åˆ°çš„çº¢åŒ…ä¹Ÿå°±è¶Šæ¥è¶Šå°ï¼Œè¿™è™½ç„¶éµå¾ªæˆ‘ä»¬å¸¸è§„æ‰€è®¤ä¸ºçš„â€œå…ˆæ¥ååˆ°â€ï¼Œä½†æ˜¯å¹¶ä¸å…¬å¹³ã€‚</p>
<p>é‚£ä¹ˆè¦å®ç°ç»å¯¹çš„å…¬å¹³ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<h1 id="1-éšæœºåˆ†å‰²">1. éšæœºåˆ†å‰²</h1>
<p>å…¶å®ï¼Œè¿™ç§æ–¹æ³•å¾ˆç›´è§‚å°±èƒ½æƒ³åˆ°ã€‚æˆ‘ä»¬æŠŠä¸€ä¸ªçº¢åŒ…æƒ³è±¡æˆä¸€ä¸ªé¦™è‚ ï¼Œå‡è®¾æœ‰<code>N</code>ä¸ªäººæ¥åˆ†è¿™ä¸ªé¦™è‚ ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦éšæœºåˆ‡<code>N-1</code>åˆ€ï¼ŒæŠŠæ¯ä¸€å—åˆ†åˆ«åˆ†ç»™æ¯ä¸€ä¸ªäººå³å¯ã€‚</p>
<p>çº¢åŒ…ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çº¢åŒ…å‘å‡ºå»çš„åŒæ—¶ï¼Œå°±éšæœºåˆ†é…å¥½é‡‘é¢ã€‚ç­‰å¤§å®¶æ¥åˆ†çš„æ—¶å€™ï¼Œå†ä¾æ¬¡åˆ†ç»™æ¯ä¸€ä¸ªäººå°±å¥½äº†ã€‚</p>
<p>è¿™ç§ç®—æ³•æ€è·¯å¹¶ä¸éš¾ï¼Œè€Œä¸”ä¹Ÿèƒ½å¤Ÿè¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ï¼Œä½†æ˜¯ç”±äºä»¥ä¸‹çš„ä¸¤ç‚¹ï¼Œå¯¼è‡´å¾®ä¿¡æ²¡æœ‰é‡‡ç”¨è¿™ç§ç®—æ³•ï¼š</p>
<ol>
<li>ç®—æ³•å¤æ‚åº¦é«˜</li>
<li>å¯¹æœåŠ¡å™¨ç«¯çš„è¦æ±‚é«˜</li>
</ol>
<p>é¦–å…ˆç¬¬ä¸€ç‚¹ï¼Œè¿™ä¸ªç®—æ³•çš„å¤æ‚åº¦ï¼Œè‚¯å®šæ˜¯è¦æ¯”ç°è¡Œçš„å¾®ä¿¡éšæœºçº¢åŒ…ç®—æ³•çš„å¤æ‚åº¦é«˜å¾ˆå¤šã€‚å¦å¤–ï¼Œç”±äºåœ¨çº¢åŒ…å‘å‡ºå»çš„ç¬é—´ï¼ŒæœåŠ¡å™¨ä¸Šå°±éœ€è¦å­˜å‚¨å…³äºè¿™ä¸ªçº¢åŒ…çš„åˆ†é…ä¿¡æ¯ï¼Œåœ¨æ˜¥èŠ‚è¿™ç§çº¢åŒ…é«˜å³°æœŸçš„æ—¶å€™ï¼ŒåŠ¿å¿…ä¼šç»™æœåŠ¡å™¨å¸¦æ¥å·¨å¤§çš„å‹åŠ›ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿæ²¡æœ‰æ™®åŠä¹‹å‰ï¼Œç¬¬äºŒç‚¹éƒ½å°†æ˜¯ä¸€ä¸ªéš¾ä»¥è§£å†³çš„é—®é¢˜ã€‚</p>
<p>å› æ­¤ï¼Œå¾®ä¿¡å°±é€€è€Œæ±‚å…¶æ¬¡ï¼Œé‡‡ç”¨ç¬¬äºŒç§åŠæ³•ã€‚</p>
<h1 id="2-äºŒå€å‡å€¼æ³•">2. äºŒå€å‡å€¼æ³•</h1>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬æ¯ä¸ªäººæŠ¢åˆ°çš„çº¢åŒ…ï¼Œéƒ½æ˜¯åœ¨ä¸‹é¢è¿™ä¸ªåŒºé—´é‡Œé¢å»éšæœºä¸€ä¸ªæ•°å€¼ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mover accent="true"><mi>M</mi><mo stretchy="true">â€¾</mo></mover><mo fence="true">]</mo></mrow><mspace width="1em"/><mo separator="true">;</mo><mover accent="true"><mi>M</mi><mo stretchy="true">â€¾</mo></mover><mo>=</mo><mfrac><mrow><mi mathvariant="normal">å‰©</mi><mi mathvariant="normal">ä½™</mi><mi mathvariant="normal">é‡‘</mi><mi mathvariant="normal">é¢</mi></mrow><mrow><mi mathvariant="normal">å‰©</mi><mi mathvariant="normal">ä½™</mi><mi mathvariant="normal">çº¢</mi><mi mathvariant="normal">åŒ…</mi><mi mathvariant="normal">æ•°</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\left(0,2\overline {M}\right]\quad;\overline M=\frac{å‰©ä½™é‡‘é¢}{å‰©ä½™çº¢åŒ…æ•°}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.23334em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.363em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.677em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">å‰©</span><span class="mord cjk_fallback">ä½™</span><span class="mord cjk_fallback">çº¢</span><span class="mord cjk_fallback">åŒ…</span><span class="mord cjk_fallback">æ•°</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">å‰©</span><span class="mord cjk_fallback">ä½™</span><span class="mord cjk_fallback">é‡‘</span><span class="mord cjk_fallback">é¢</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>å¾®ä¿¡ï¼Œæ­£æ˜¯é‡‡ç”¨çš„è¿™ç§æ–¹æ³•ã€‚</p>
<p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªæ˜¯å…¬å¹³çš„å‘¢ï¼Ÿ</p>
<p>å‡è®¾ï¼Œå‘ä¸€ä¸ª100å…ƒçš„çº¢åŒ…ï¼Œ10ä»½ã€‚é‚£ä¹ˆç¬¬ä¸€ä¸ªäººçš„é‡‘é¢ï¼Œå°±ä¼šåœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>20</mn><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left(0,20\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>å…ƒé‡Œé¢éšæœºã€‚å‡è®¾ç¬¬ä¸€ä¸ªäººæŠ¢åˆ°äº†å¹³å‡å€¼10å—é’±ï¼Œé‚£ä¹ˆè¿˜å‰©90.</p>
<p>ç¬¬äºŒä¸ªäººçš„æŠ¢åˆ°çš„ï¼Œåº”è¯¥æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo>â‹…</mo><mfrac><mn>90</mn><mn>9</mn></mfrac><mo fence="true">]</mo></mrow><mo>â‡’</mo><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>20</mn><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left(0,2\cdot \frac{90}{9}\right]\Rightarrow \left(0,20\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‡’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>ï¼Œå’Œä¹‹å‰çš„ä¸€æ ·ï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¿™ä¸ªç®—æ³•æ˜¯å…¬å¹³çš„ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¹¶ä¸æ˜¯æ¯ä¸€æ¬¡éƒ½èƒ½å¤Ÿç†æƒ³åŒ–åœ°æŠ¢åˆ°å¹³å‡å€¼ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ˜¯è¦åœ¨è¿™ä¸ªèŒƒå›´å†…å–éšæœºå€¼ã€‚å‡è®¾ç¬¬ä¸€ä¸ªäººåªæŠ¢åˆ°äº†1å—é’±ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªäººèƒ½å¤ŸæŠ¢åˆ°çš„èŒƒå›´æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>22</mn><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left(0,22\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">2</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>ï¼ŒèŒƒå›´å°±æ›´å¤§äº†ç‚¹ï¼Œå‡è®¾ç¬¬äºŒä¸ªäººä¹ŸåªæŠ¢åˆ°1å—é’±ï¼Œé‚£ä¹ˆç¬¬ä¸‰ä¸ªäººçš„èŒƒå›´å°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>24.5</mn><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left(0,24.5\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">4</span><span class="mord">.</span><span class="mord">5</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå‡è®¾å‰é¢çš„9ä¸ªäººéƒ½åªæŠ¢åˆ°1å—é’±ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªäººçš„èŒƒå›´ï¼Œå°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>91</mn><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left(0,91\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mord">1</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>ï¼Œå®é™…ä¸Šå°±æ˜¯91å—ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæ¯ä¸ªäººéƒ½æŠ¢åˆ°èŒƒå›´å†…å¹³å‡å€¼ä»¥ä¸‹ï¼Œé‚£ä¹ˆåé¢çš„äººçš„éšæœºèŒƒå›´åˆ™ä¼šè¶Šæ¥è¶Šå¤§ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦å¤–ä¸€ä¸ªæç«¯ï¼Œå¦‚æœç¬¬ä¸€ä¸ªäººæŠ¢åˆ°20å—é’±ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªäººçš„èŒƒå›´å°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>17.76</mn><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left(0,17.76\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">7</span><span class="mord">.</span><span class="mord">7</span><span class="mord">6</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>ï¼Œå‡è®¾ç¬¬äºŒä¸ªäººæŠ¢åˆ°17å…ƒï¼Œç¬¬ä¸‰ä¸ªäººçš„èŒƒå›´å°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>15.75</mn><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left(0,15.75\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">5</span><span class="mord">.</span><span class="mord">7</span><span class="mord">5</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>â€¦â€¦</p>
<p>èŒƒå›´ä¼šè¶Šæ¥è¶Šå°ï¼Œä½†æ˜¯æ¯ä¸ªäººçš„çº¢åŒ…éƒ½ä¸å¤§ï¼Œéƒ½æ²¡æœ‰è¶…è¿‡ç¬¬ä¸€ä¸ªäººï¼Œå› æ­¤ç¬¬ä¸€ä¸ªäººæ˜¯æœ¬æ¬¡çš„è¿æ°”ç‹ã€‚</p>
<p>æ‰€ä»¥ï¼Œå…¶å®è¿™ä¸ªç®—æ³•è¿™ä¹ˆçœ‹ï¼Œè²Œä¼¼çš„ç¡®ä¸é‚£ä¹ˆå…¬å¹³ï¼Œç¬¬ä¸€ä¸ªäººæ°¸è¿œåªèƒ½æŠ¢åˆ°äºŒå€å‡å€¼ä»¥ä¸‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬ä¸€ä¸ªäººå°±æ˜¯æŠ¢ä¸åˆ°å¤§çº¢åŒ…ï¼Œè€Œè¶Šå¾€åè¶Š<strong>æœ‰å¯èƒ½</strong>æŠ¢åˆ°å¤§çº¢åŒ…ã€‚</p>
<p>å½“ç„¶ï¼Œè¿æ°”ç‹æ˜¯æœ‰å¯èƒ½å‡ºç°åœ¨ä»»æ„çš„ä½ç½®ï¼Œè¿æ°”ç‹çš„ä½ç½®é å‰ï¼Œåˆ™æ•´ä½“ä¸ä¼šæœ‰å¾ˆå¤§çš„çº¢åŒ…ï¼Œè¿æ°”ç‹é åçš„è¯ï¼Œåé¢å°±æœ‰å¯èƒ½å‡ºç°æ¯”å‰é¢å¤§å¾ˆå¤šçš„çº¢åŒ…ã€‚</p>
<p>é‚£ä¹ˆè¿™æ ·çš„ç®—æ³•ç”¨ä»£ç å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<p>Harriséƒ½ç»™å¤§å®¶åˆ—å‡ºæ¥äº†ï¼Œå¦‚æœæ„Ÿå…´è¶£å¯ä»¥ç ”ç©¶ç ”ç©¶ï¼š</p>
<p>Java:</p>
<pre><code class="language-java">//ä»£ç æ¥æºäºç½‘ç»œ
//å‘çº¢åŒ…ç®—æ³•ï¼Œé‡‘é¢å‚æ•°ä»¥åˆ†ä¸ºå•ä½
public static List&lt;Integer&gt; divideRedPackage(Integer totalAmount, Integer totalPeopleNum){
    List&lt;Integer&gt; amountList = new ArrayList&lt;Integer&gt;();
    Integer restAmount = totalAmount;
    Integer restPeopleNum = totalPeopleNum;
    Random random = new Random();
    for(int i=0; i&lt;totalPeopleNum-1; i++){
        //éšæœºèŒƒå›´ï¼š[1ï¼Œå‰©ä½™äººå‡é‡‘é¢çš„ä¸¤å€)ï¼Œå·¦é—­å³å¼€
        int amount = random.nextInt(restAmount / restPeopleNum * 2 - 1) + 1;
        restAmount -= amount;
        restPeopleNum --;
        amountList.add(amount);
    }
    amountList.add(restAmount);
    return amountList;
}
public static void main(String[] args){
    List&lt;Integer&gt; amountList = divideRedPackage(5000, 30);
    for(Integer amount : amountList){
        System.out.println(&quot;æŠ¢åˆ°é‡‘é¢ï¼š&quot; + new BigDecimal(amount).divide(new BigDecimal(100)));
    }
}
</code></pre>
<p>C/C++ï¼š</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

void money();
void money(double TotalAmount, int TotalPeople)
{
	double restAmount = TotalAmount;
	int restPeople = TotalPeople;
	for (int i = 0; i &lt; TotalPeople - 1; ++i)
	{
		int amount = rand() % ((int)((restAmount / restPeople) * 2) * 100);
		restAmount -= amount / 100;
		--restPeople;
		printf(&quot;æŠ¢åˆ°é‡‘é¢ï¼š%.2f\n&quot;, (double)amount / 100);
	}
	printf(&quot;æŠ¢åˆ°é‡‘é¢ï¼š%.2f\n&quot;, (double)restAmount / 100);
}

int main(void)
{
	money(50, 30);
	return 0;
}
</code></pre>
<p>Pythonï¼š</p>
<pre><code class="language-python">import random
def money(TotalMoney,TotalPeople):
    restMoney = TotalMoney
    restPeople = TotalPeople
    for i in range(TotalPeople - 1):
        mount = round(random.uniform(0.01,(restMoney / restPeople) * 2 - 0.01),2)
        restMoney -= mount
        restPeople -= 1
        print(&quot;æŠ¢åˆ°é‡‘é¢ï¼š&quot;+str(mount))
    print(&quot;æŠ¢åˆ°é‡‘é¢ï¼š&quot;+str(round(restMoney,2)))

money(50,30)
</code></pre>
<p>æœ¬ç¯‡åšå®¢å°±åˆ°æ­¤ç»“æŸäº†ï¼Œå…¶å®ç”Ÿæ´»ä¸­å¤„å¤„å……æ»¡ç€çŸ¥è¯†ï¼Œå°±çœ‹ä½ æœ‰æ²¡æœ‰ä¸€é¢—çˆ±é’»ç ”çš„å¿ƒï¼</p>
]]></content>
    </entry>
</feed>